<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Template</title>

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/AMI/AMIWebApp.min.js"></script>

    <script type="text/javascript" src="subapps/DBModeler/js/AMIDBModelerApp.js"></script>
    <script type="text/javascript" src="subapps/Document/js/AMIDocumentApp.js"></script>
    <script type="text/javascript" src="subapps/Configuration/js/AMIConfigurationApp.js"></script>
    <script type="text/javascript" src="subapps/Command/js/AMICommandApp.js"></script>
    <script type="text/javascript" src="subapps/Monitoring/js/AMIMonitoringApp.js"></script>
    <script type="text/javascript" src="subapps/SearchModeler/js/AMISearchModelerApp.js"></script>
    <script type="text/javascript" src="subapps/SearchEngine/js/AMISearchEngineApp.js"></script>
    <script type="text/javascript" src="subapps/SimpleSearchEngine/js/AMISimpleSearchEngineApp.js"></script>

    <script type="text/javascript">

	amiWebApp.onStart = function() {

		if(amiWebApp.isLocal()) {
			amiCommand.endpoint = 'https://localhost:8443/AMI/FrontEnd';
		} else {
			amiCommand.endpoint = '/AMI/servlet/net.hep.atlas.Database.Bookkeeping.AMI.Servlet.FrontEnd';
		}

		//amiWebApp.runSubApp(amiDBModelerApp);
		amiWebApp.runSubApp(amiDocumentApp, amiWebApp.args['userdata']);
		//amiWebApp.runSubApp(amiConfigurationApp);
		//amiWebApp.runSubApp(amiCommandApp);
		//amiWebApp.runSubApp(amiMonitoringApp);
		//amiWebApp.runSubApp(amiSearchModelerApp);
		//amiWebApp.runSubApp(amiSearchEngineApp);
	};

	amiWebApp.onToolbarUpdateNeeded = function() {

		var menu =
			'<li class="dropdown">' +
			'  <a href="#" class="dropdown-toggle" data-toggle="dropdown">' +
			'    Search <span class="caret"></span>' +
			'  </a>' +
			'  <ul class="dropdown-menu">' +
			'    <li><a href="javascript:amiWebApp.runSubApp(amiSearchEngineApp);">Search Engine</a></li>' +
			'    <li><a href="javascript:amiWebApp.runSubApp(amiSimpleSearchEngineApp);">Simple Search Engine</a></li>' +
			'  </ul>' +
			'</li>' +
			'<li class="dropdown">' +
			'  <a href="#" class="dropdown-toggle" data-toggle="dropdown">' +
			'    Tools <span class="caret"></span>' +
			'  </a>' +
			'  <ul class="dropdown-menu">' +
			'    <li><a href="javascript:amiWebApp.runSubApp(amiCommandApp);">Command Line</a></li>' +
			'  </ul>' +
			'</li>'
		;

		if(true||amiLogin.hasRole('AMI_administrator_role')) {

			menu +=
				'</li>' +
				'<li class="dropdown">' +
				'  <a href="#" class="dropdown-toggle" data-toggle="dropdown">' +
				'    <i class="fa fa-key"></i> Admin <span class="caret"></span>' +
				'  </a>' +
				'  <ul class="dropdown-menu">' +
				'    <li><a href="javascript:amiWebApp.runSubApp(amiConfigurationApp);">Configuration</a></li>' +
				'    <li><a href="javascript:amiWebApp.runSubApp(amiMonitoringApp);">Monitoring</a></li>' +
				'    <li class="divider"></li>' +
				'    <li><a href="javascript:amiWebApp.runSubApp(amiDBModelerApp);">Catalog Modeler</a></li>' +
				'    <li><a href="javascript:amiWebApp.runSubApp(amiSearchModelerApp);">Search Modeler</a></li>' +
				'  </ul>' +
				'</li>'
			;
		}

		$('#ami_menu_content').html(menu);
	};
	
    </script>

    <!--[if lt IE 9]>
      <script type="text/javascript" src="js/html5shiv.min.js"></script>
      <script type="text/javascript" src="js/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    <script type="text/javascript">
	amiWebApp.start({
		home_url: 'http://localhost/template2.html',
		template_filename: 'html/AMI/AMIWebApp_blue.html'
	});
    </script>

  </body>
</html>