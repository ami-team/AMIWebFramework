<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

		<title>AMI</title>

		<script type="text/javascript" src="js/jquery.min.js"></script>

		<script type="text/javascript" src="js/ami.es6.js?embedded"></script>

		<script type="text/javascript">

			var myAccordion;
			var myTable1;
			var myTable2;

			amiWebApp.onRefresh = function(isAuth) {

				if(isAuth)
				{
					myAccordion.render('#myAccordion', {card: true, toolbar: true});

					myAccordion.appendItem('item0', {show: true}).done(function(sel) {
						$(sel).text('hello0');
						myTable1.render(sel, 'SearchQuery -catalog="mc16_001:production" -entity="dataset" -sql="SELECT logicalDatasetName FROM dataset WHERE logicalDatasetName=\'mc16_13TeV.364226.Sherpa_221_NNPDF30NNLO_Wenu_PTV500_1000.deriv.log.e5626_e5984_s3126_r10201_r10210_p3384\'"', {showDetails: true, canEdit: true, catalog: 'mc16_001:production', entity: 'dataset'});
					});

					myAccordion.appendItem('item1').done(function(sel) {
						$(sel).text('hello1');
						//myTable2.render(sel, 'SearchQuery -catalog="mc16_001:production"  -entity="dataset" -sql="SELECT logicalDatasetName FROM dataset WHERE logicalDatasetName=\'mc16_13TeV.364226.Sherpa_221_NNPDF30NNLO_Wenu_PTV500_1000.deriv.NTUP_PILEUP.e5626_e5984_s3126_r10201_r10210_p3384\'"', {showDetails: true, canEdit: true, catalog: 'mc16_001:production', entity: 'dataset'});
					});

					/*----*/

				}
				else
				{
					$('#myAccordion').empty();
				}
			};

			amiWebApp.onReady = function() {

				return amiWebApp.loadResources(['ctrl:accordion','ctrl:table']).done(function(controls) 
{
					myAccordion = new controls[0];
					myTable1 = new controls[1](myAccordion);
					myTable2 = new controls[1](myAccordion);
				});
			};

			amiWebApp.start({
				endpoint_url: 'https://ami.in2p3.fr/AMI/servlet/net.hep.atlas.Database.Bookkeeping.AMI.Servlet.FrontEnd'
			});

		</script>
	</head>
	<body>

		<nav class="navbar navbar-expand-lg navbar-light bg-light">

			<ul class="navbar-nav ml-auto" id="ami_login_content"></ul>

		</nav>

		<div id="ami_alert_content"></div>

		<br />

		<div id="myAccordion" style="width: 90%; margin-left: auto; margin-right: auto;"></div>

		<br />
		<br />
		<br />
		<br />

	</body>
</html>
