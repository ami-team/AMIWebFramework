<script type="text/javascript" src="{{ORIGIN_URL}}/js/ami.min.js?embedded"></script>

<script type="text/javascript">

	var myElementInfo;

	amiWebApp.onRefresh = function(isAuth) {

		if(isAuth)
		{
			myElementInfo.render('#myElementInfo', '{{catalog|e('js')}}', '{{entity|e('js')}}', '{{primaryFieldName|e('js')}}', '{{primaryFieldValue|e('js')}}', {
				elementInfoCommandFunc: {{ elementInfoCommandFunc.toString() }},
				appendCommandFunc: {{ appendCommandFunc.toString() }},
				updateCommandFunc: {{ updateCommandFunc.toString() }},
				removeCommandFunc: {{ removeCommandFunc.toString() }},
				/**/
				customLabelsFragment: '{{ customLabelsFragment|e('js') }}',
				customInputsFragment: '{{ customInputsFragment|e('js') }}',
				customHTMLsFragment: '{{ customHTMLsFragment|e('js') }}',
				/**/
				expandedLinkedElements: [{{ expandedLinkedElements|join(', ')|e('js') }}],
				/**/
				enableCache: {{ enableCache }},
				enableCount: {{ enableCount }},
				enableEditMode: {{ enableEditMode }},
				/**/
				hideBigContent: {{ hideBigContent }},
				/**/
				showPrimaryField: {{ showPrimaryField }},
				showToolBar: {{ showToolBar }},
				showDetails: {{ showDetails }},
				showTools: {{ showTools }},
				canEdit: {{ canEdit }},
				/**/
				start: {{ start }},
				stop: {{ stop }},
				orderBy: '{{ orderBy|e('js') }}',
				orderWay: '{{ orderWay|e('js') }}',
				/**/
				maxCellLength: {{ maxCellLength }},
				/**/
				card: {{ card }},
			});
		}
		else
		{
			$('#myElementInfo').empty();
		}
	};

	amiWebApp.onReady = function() {

		return amiWebApp.loadResources(['ctrl:elementInfo']).done(function(ctrls) {

			myElementInfo = new ctrls[0];
		});
	};

	amiWebApp.start({
		endpoint_url: '{{endpoint}}'
	});

</script>

<div id="myElementInfo"></div>