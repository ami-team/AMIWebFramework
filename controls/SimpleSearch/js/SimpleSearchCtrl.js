/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 */$AMIClass("SimpleSearchCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){return amiWebApp.loadResources([amiWebApp.originURL+"/controls/SimpleSearch/twig/SimpleSearchCtrl.twig","ctrl:tab"],{context:this}).done(function(data){this.fragmentSimpleSearch=data[0];this.tabCtrl=data[1]})},render:function render(selector,settings){var result=$.Deferred();var fn=function fn(catalog,entity,fields,value){var select=fields.length===0?["0 = 1"]:value.indexOf("%")<0?fields.map(function(field){return field+" = '"+amiWebApp.textToSQL(value)+"'"}):fields.map(function(field){return field+" LIKE '"+amiWebApp.textToSQL(value)+"'"});return"BrowseQuery"+" -catalog=\""+amiWebApp.textToString(catalog)+"\" -entity=\""+amiWebApp.textToString(entity)+"\" -mql=\"SELECT * WHERE "+select.join(" OR ")+"\""};var _amiWebApp$setup=amiWebApp.setup(["context","placeholder","catalog","defaultCatalog","entity","defaultEntity","fields","criteria","searchCommandFunc","card"],[result,"% for wildcarding","","","","",[],[],fn,false],settings),context=_amiWebApp$setup[0],placeholder=_amiWebApp$setup[1],catalog=_amiWebApp$setup[2],defaultCatalog=_amiWebApp$setup[3],entity=_amiWebApp$setup[4],defaultEntity=_amiWebApp$setup[5],fields=_amiWebApp$setup[6],criteria=_amiWebApp$setup[7],searchCommandFunc=_amiWebApp$setup[8],card=_amiWebApp$setup[9];this.ctx={};for(var key in settings){this.ctx[key]=settings[key]}this.ctx.isEmbedded=amiWebApp.isEmbedded();this.ctx.endpoint=amiCommand.endpoint;this.ctx.context=context;this.ctx.placeholder=placeholder;this.ctx.catalog=defaultCatalog?defaultCatalog:catalog;this.ctx.entity=defaultEntity?defaultEntity:entity;this.ctx.fields=criteria.length>0?criteria.filter(function(criterion){return criterion.more.simple_search}).map(function(criterion){return"`"+criterion.catalog+"`.`"+criterion.entity+"`.`"+criterion.field+"`"}):fields;this.ctx.searchCommandFunc=searchCommandFunc;this.ctx.card=card;this._render(result,selector);return result},_render:function _render(result,selector){var _this=this;if(this.getParent().$name!=="TabCtrl"){var tab=new this.tabCtrl(null,this);tab.render(selector,this.ctx).done(function(){tab.appendItem("<i class=\"fa fa-search\"></i> "+_this.ctx.entity,{closable:false,firstVisible:false}).done(function(selector){_this.setParent(tab);_this.__render(result,selector)})})}else{this.__render(result,selector)}},__render:function __render(result,selector){var _this2=this;this.replaceHTML(selector,this.fragmentSimpleSearch,{dict:this.ctx}).done(function(){$(_this2.patchId("#E8F152B0_66C6_132C_0155_955D36654C13")).submit(function(e){e.preventDefault();var value=$(_this2.patchId("#F8D8C2FB_81D9_F7A0_121B_6FB2949F8DB6")).val().trim();if(value){_this2.search(value)}});result.resolveWith(_this2.ctx.context)})},search:function search(value){return amiWebApp.createControlInContainer(this.getParent(),this,"table",[this.ctx.searchCommandFunc(this.ctx.catalog,this.ctx.entity,this.ctx.fields,value)],{},this.ctx,"table",this.ctx.entity)}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNpbXBsZVNlYXJjaEN0cmwuZXM2LmpzIl0sIm5hbWVzIjpbIiRBTUlDbGFzcyIsIiRleHRlbmRzIiwiYW1pIiwiQ29udHJvbCIsIiRpbml0IiwicGFyZW50Iiwib3duZXIiLCIkc3VwZXIiLCJvblJlYWR5IiwiYW1pV2ViQXBwIiwibG9hZFJlc291cmNlcyIsIm9yaWdpblVSTCIsImNvbnRleHQiLCJkb25lIiwiZGF0YSIsImZyYWdtZW50U2ltcGxlU2VhcmNoIiwidGFiQ3RybCIsInJlbmRlciIsInNlbGVjdG9yIiwic2V0dGluZ3MiLCJyZXN1bHQiLCIkIiwiRGVmZXJyZWQiLCJmbiIsImNhdGFsb2ciLCJlbnRpdHkiLCJmaWVsZHMiLCJ2YWx1ZSIsInNlbGVjdCIsImxlbmd0aCIsImluZGV4T2YiLCJtYXAiLCJmaWVsZCIsInRleHRUb1NRTCIsInRleHRUb1N0cmluZyIsImpvaW4iLCJzZXR1cCIsInBsYWNlaG9sZGVyIiwiZGVmYXVsdENhdGFsb2ciLCJkZWZhdWx0RW50aXR5IiwiY3JpdGVyaWEiLCJzZWFyY2hDb21tYW5kRnVuYyIsImNhcmQiLCJjdHgiLCJrZXkiLCJpc0VtYmVkZGVkIiwiZW5kcG9pbnQiLCJhbWlDb21tYW5kIiwiZmlsdGVyIiwiY3JpdGVyaW9uIiwibW9yZSIsInNpbXBsZV9zZWFyY2giLCJfcmVuZGVyIiwiZ2V0UGFyZW50IiwiJG5hbWUiLCJ0YWIiLCJhcHBlbmRJdGVtIiwiY2xvc2FibGUiLCJmaXJzdFZpc2libGUiLCJzZXRQYXJlbnQiLCJfX3JlbmRlciIsInJlcGxhY2VIVE1MIiwiZGljdCIsInBhdGNoSWQiLCJzdWJtaXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJ2YWwiLCJ0cmltIiwic2VhcmNoIiwicmVzb2x2ZVdpdGgiLCJjcmVhdGVDb250cm9sSW5Db250YWluZXIiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7R0FhQUEsU0FBUyxDQUFDLGtCQUFELENBQXFCLENBSTdCQyxRQUFRLENBQUVDLEdBQUcsQ0FB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Q0FBbUIsTUFBSSxDQUFDM0IsR0FBTCxDQUFTL0IsT0FBNUIsQ0FHQSxDQXJCRCxDQXNCQSxDQXZLNEIsQ0EySzdCeUQsTUFBTSxDQUFFLGdCQUFTMUMsS0FBVCxDQUNSLENBQ0MsTUFBT2xCLENBQUFBLFNBQVMsQ0FBQzhELHdCQUFWLENBQW1DLEtBQUtsQixTQUFMLEVBQW5DLENBQXFELElBQXJELENBQTJELE9BQTNELENBQW9FLENBQUMsS0FBS1YsR0FBTCxDQUFTRixpQkFBVCxDQUEyQixLQUFLRSxHQUFMLENBQVNuQixPQUFwQyxDQUE2QyxLQUFLbUIsR0FBTCxDQUFTbEIsTUFBdEQsQ0FBOEQsS0FBS2tCLEdBQUwsQ0FBU2pCLE1BQXZFLENBQStFQyxLQUEvRSxDQUFELENBQXBFLENBQTZKLEVBQTdKLENBQWlLLEtBQUtnQixHQUF0SyxDQUEySyxPQUEzSyxDQUFvTCxLQUFLQSxHQUFMLENBQVNsQixNQUE3TCxDQUNQLENBOUs0QixDQUFyQixDQUFUIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBTUkgV2ViIEZyYW1ld29ya1xuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNC1YWFhYIFRoZSBBTUkgVGVhbSAvIExQU0MgLyBJTjJQM1xuICpcbiAqIFRoaXMgZmlsZSBtdXN0IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBDZUNJTEwtQzpcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1lbi5odG1sXG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZnIuaHRtbFxuICpcbiAqL1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdTaW1wbGVTZWFyY2hDdHJsJywge1xuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGV4dGVuZHM6IGFtaS5Db250cm9sLFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGluaXQ6IGZ1bmN0aW9uKHBhcmVudCwgb3duZXIpXG5cdHtcblx0XHR0aGlzLiRzdXBlci4kaW5pdChwYXJlbnQsIG93bmVyKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKClcblx0e1xuXHRcdHJldHVybiBhbWlXZWJBcHAubG9hZFJlc291cmNlcyhbXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jb250cm9scy9TaW1wbGVTZWFyY2gvdHdpZy9TaW1wbGVTZWFyY2hDdHJsLnR3aWcnLFxuXHRcdFx0J2N0cmw6dGFiJyxcblx0XHRdLCB7Y29udGV4dDogdGhpc30pLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuXG5cdFx0XHR0aGlzLmZyYWdtZW50U2ltcGxlU2VhcmNoID0gZGF0YVswXTtcblxuXHRcdFx0dGhpcy50YWJDdHJsID0gZGF0YVsxXTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHJlbmRlcjogZnVuY3Rpb24oc2VsZWN0b3IsIHNldHRpbmdzKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgZm4gPSAoY2F0YWxvZywgZW50aXR5LCBmaWVsZHMsIHZhbHVlKSA9PiB7XG5cblx0XHRcdGNvbnN0IHNlbGVjdCA9IGZpZWxkcy5sZW5ndGggPT09IDAgPyBbJzAgPSAxJ11cblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAodmFsdWUuaW5kZXhPZignJScpIDwgMCkgPyBmaWVsZHMubWFwKGZpZWxkID0+IGZpZWxkICsgJyA9IFxcJycgKyBhbWlXZWJBcHAudGV4dFRvU1FMKHZhbHVlKSArICdcXCcnKVxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGZpZWxkcy5tYXAoZmllbGQgPT4gZmllbGQgKyAnIExJS0UgXFwnJyArIGFtaVdlYkFwcC50ZXh0VG9TUUwodmFsdWUpICsgJ1xcJycpXG5cdFx0XHQ7XG5cblx0XHRcdHJldHVybiAnQnJvd3NlUXVlcnknICsgJyAtY2F0YWxvZz1cIicgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKGNhdGFsb2cpICsgJ1wiIC1lbnRpdHk9XCInICsgYW1pV2ViQXBwLnRleHRUb1N0cmluZyhlbnRpdHkpICsgJ1wiIC1tcWw9XCJTRUxFQ1QgKiBXSEVSRSAnICsgc2VsZWN0LmpvaW4oJyBPUiAnKSArICdcIic7XG5cdFx0fTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IFtcblx0XHRcdGNvbnRleHQsXG5cdFx0XHRwbGFjZWhvbGRlcixcblx0XHRcdGNhdGFsb2csIGRlZmF1bHRDYXRhbG9nLFxuXHRcdFx0ZW50aXR5LCBkZWZhdWx0RW50aXR5LFxuXHRcdFx0ZmllbGRzLCBjcml0ZXJpYSxcblx0XHRcdHNlYXJjaENvbW1hbmRGdW5jLFxuXHRcdFx0Y2FyZFxuXHRcdF0gPSBhbWlXZWJBcHAuc2V0dXAoXG5cdFx0XHRbXG5cdFx0XHRcdCdjb250ZXh0Jyxcblx0XHRcdFx0J3BsYWNlaG9sZGVyJyxcblx0XHRcdFx0J2NhdGFsb2cnLCAnZGVmYXVsdENhdGFsb2cnLFxuXHRcdFx0XHQnZW50aXR5JywgJ2RlZmF1bHRFbnRpdHknLFxuXHRcdFx0XHQnZmllbGRzJywgJ2NyaXRlcmlhJyxcblx0XHRcdFx0J3NlYXJjaENvbW1hbmRGdW5jJyxcblx0XHRcdFx0J2NhcmQnLFxuXHRcdFx0XSxcblx0XHRcdFtcblx0XHRcdFx0cmVzdWx0LFxuXHRcdFx0XHQnJSBmb3Igd2lsZGNhcmRpbmcnLFxuXHRcdFx0XHQnJywgJycsXG5cdFx0XHRcdCcnLCAnJyxcblx0XHRcdFx0W10sIFtdLFxuXHRcdFx0XHRmbixcblx0XHRcdFx0ZmFsc2UsXG5cdFx0XHRdLFxuXHRcdFx0c2V0dGluZ3Ncblx0XHQpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0dGhpcy5jdHggPSB7fTtcblxuXHRcdGZvcihsZXQga2V5IGluIHNldHRpbmdzKVxuXHRcdHtcblx0XHQgICAgdGhpcy5jdHhba2V5XSA9IHNldHRpbmdzW2tleV07XG5cdFx0fVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0dGhpcy5jdHguaXNFbWJlZGRlZCA9IGFtaVdlYkFwcC5pc0VtYmVkZGVkKCk7XG5cblx0XHR0aGlzLmN0eC5lbmRwb2ludCA9IGFtaUNvbW1hbmQuZW5kcG9pbnQ7XG5cblx0XHR0aGlzLmN0eC5jb250ZXh0ID0gY29udGV4dDtcblxuXHRcdHRoaXMuY3R4LnBsYWNlaG9sZGVyID0gcGxhY2Vob2xkZXI7XG5cblx0XHR0aGlzLmN0eC5jYXRhbG9nID0gZGVmYXVsdENhdGFsb2cgPyBkZWZhdWx0Q2F0YWxvZyA6IGNhdGFsb2c7XG5cdFx0dGhpcy5jdHguZW50aXR5ID0gZGVmYXVsdEVudGl0eSA/IGRlZmF1bHRFbnRpdHkgOiBlbnRpdHk7XG5cblx0XHR0aGlzLmN0eC5maWVsZHMgPSBjcml0ZXJpYS5sZW5ndGggPiAwID8gY3JpdGVyaWEuZmlsdGVyKGNyaXRlcmlvbiA9PiBjcml0ZXJpb24ubW9yZS5zaW1wbGVfc2VhcmNoKS5tYXAoY3JpdGVyaW9uID0+ICdgJyArIGNyaXRlcmlvbi5jYXRhbG9nICsgJ2AuYCcgKyBjcml0ZXJpb24uZW50aXR5ICsgJ2AuYCcgKyBjcml0ZXJpb24uZmllbGQgKyAnYCcpXG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGZpZWxkc1xuXHRcdDtcblxuXHRcdHRoaXMuY3R4LnNlYXJjaENvbW1hbmRGdW5jID0gc2VhcmNoQ29tbWFuZEZ1bmM7XG5cblx0XHR0aGlzLmN0eC5jYXJkID0gY2FyZDtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdHRoaXMuX3JlbmRlcihyZXN1bHQsIHNlbGVjdG9yKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRfcmVuZGVyOiBmdW5jdGlvbihyZXN1bHQsIHNlbGVjdG9yKVxuXHR7XG5cdFx0aWYodGhpcy5nZXRQYXJlbnQoKS4kbmFtZSAhPT0gJ1RhYkN0cmwnKVxuXHRcdHtcblx0XHRcdGNvbnN0IHRhYiA9IG5ldyB0aGlzLnRhYkN0cmwobnVsbCwgdGhpcyk7XG5cblx0XHRcdHRhYi5yZW5kZXIoc2VsZWN0b3IsIHRoaXMuY3R4KS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHR0YWIuYXBwZW5kSXRlbSgnPGkgY2xhc3M9XCJmYSBmYS1zZWFyY2hcIj48L2k+ICcgKyB0aGlzLmN0eC5lbnRpdHksIHtjbG9zYWJsZTogZmFsc2UsIGZpcnN0VmlzaWJsZTogZmFsc2V9KS5kb25lKChzZWxlY3RvcikgPT4ge1xuXG5cdFx0XHRcdFx0dGhpcy5zZXRQYXJlbnQodGFiKTtcblxuXHRcdFx0XHRcdHRoaXMuX19yZW5kZXIocmVzdWx0LCBzZWxlY3Rvcik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGlzLl9fcmVuZGVyKHJlc3VsdCwgc2VsZWN0b3IpO1xuXHRcdH1cblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdF9fcmVuZGVyOiBmdW5jdGlvbihyZXN1bHQsIHNlbGVjdG9yKVxuXHR7XG5cdFx0dGhpcy5yZXBsYWNlSFRNTChzZWxlY3RvciwgdGhpcy5mcmFnbWVudFNpbXBsZVNlYXJjaCwge2RpY3Q6IHRoaXMuY3R4fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHQkKHRoaXMucGF0Y2hJZCgnI0U4RjE1MkIwXzY2QzZfMTMyQ18wMTU1Xzk1NUQzNjY1NEMxMycpKS5zdWJtaXQoKGUpID0+IHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0Y29uc3QgdmFsdWUgPSAkKHRoaXMucGF0Y2hJZCgnI0Y4RDhDMkZCXzgxRDlfRjdBMF8xMjFCXzZGQjI5NDlGOERCNicpKS52YWwoKS50cmltKCk7XG5cblx0XHRcdFx0aWYodmFsdWUpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGlzLnNlYXJjaCh2YWx1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0cmVzdWx0LnJlc29sdmVXaXRoKHRoaXMuY3R4LmNvbnRleHQpO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHNlYXJjaDogZnVuY3Rpb24odmFsdWUpXG5cdHtcblx0XHRyZXR1cm4gYW1pV2ViQXBwLmNyZWF0ZUNvbnRyb2xJbkNvbnRhaW5lcih0aGlzLmdldFBhcmVudCgpLCB0aGlzLCAndGFibGUnLCBbdGhpcy5jdHguc2VhcmNoQ29tbWFuZEZ1bmModGhpcy5jdHguY2F0YWxvZywgdGhpcy5jdHguZW50aXR5LCB0aGlzLmN0eC5maWVsZHMsIHZhbHVlKV0sIHt9LCB0aGlzLmN0eCwgJ3RhYmxlJywgdGhpcy5jdHguZW50aXR5KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xufSk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuIl19
