/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 * @global diff_match_patch
 *
 */

/*-------------------------------------------------------------------------*/
$AMIClass('DiffBoxCtrl', {
  /*---------------------------------------------------------------------*/
  $extends: ami.Control,

  /*---------------------------------------------------------------------*/
  $init: function $init(parent, owner) {
    this.$super.$init(parent, owner);
  },

  /*---------------------------------------------------------------------*/
  onReady: function onReady() {
    var _this = this;

    return amiWebApp.loadResources([amiWebApp.originURL + '/controls/DiffBox/twig/DiffBoxCtrl.twig', amiWebApp.originURL + '/js/3rd-party/diff_match_patch.min.js']).done(function (data) {
      amiWebApp.appendHTML('body', data[0]).done(function () {
        var _class = _this.$class;
        /*---------------------------------------------------------*/

        $('#B8D42DF0_0D25_C818_1438_5BAD52BB9E0B').on('hidden.bs.modal', function () {
          _class.deferred.resolveWith(_class.context || _class.deferred);
        });
        /*---------------------------------------------------------*/

        _this.dmp = new diff_match_patch();
        /*---------------------------------------------------------*/
      });
    });
  },

  /*---------------------------------------------------------------------*/
  render: function render(text1, text3, settings) {
    var deferred = $.Deferred();
    /*-----------------------------------------------------------------*/

    var _amiWebApp$setup = amiWebApp.setup(['context', 'title'], [deferred, 'Edit box'], settings),
        context = _amiWebApp$setup[0],
        title = _amiWebApp$setup[1];
    /*-----------------------------------------------------------------*/


    var d = this.dmp.diff_main(text1, text3);
    this.dmp.diff_cleanupEfficiency(d);
    /*-----------------------------------------------------------------*/

    var html1 = '<i class="line-number"></i>' + amiWebApp.textToHtml(text1).replace(/\n/g, '\n<i class="line-number"></i>');
    $('#E94A7FE7_FEBC_AE12_0C13_E625FC2ADFE6').html(html1);
    /*-----------------------------------------------------------------*/

    var html2 = '<i class="line-number"></i>' + this.dmp.diff_prettyHtml(d).replace(/\n/g, '\n<i class="line-number"></i>');
    $('#AF0BD692_6F09_4527_2684_AAF623658767').html(html2);
    /*-----------------------------------------------------------------*/

    var html3 = '<i class="line-number"></i>' + amiWebApp.textToHtml(text3).replace(/\n/g, '\n<i class="line-number"></i>');
    $('#C604C636_346F_64A8_3EBE_ADCDE2AEB343').html(html3);
    /*-----------------------------------------------------------------*/

    amiWebApp.unlock();
    $('#B8D42DF0_0D25_C818_1438_5BAD52BB9E0B').modal('show');
    this.$class.deferred = deferred;
    this.$class.context = context;
    /*-----------------------------------------------------------------*/

    return deferred.promise();
    /*-----------------------------------------------------------------*/
  },

  /*---------------------------------------------------------------------*/
  show: function show(text1, text3, settings) {
    return this.render(text1, text3, settings);
  }
  /*---------------------------------------------------------------------*/

});
/*-------------------------------------------------------------------------*/
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRpZmZCb3hDdHJsLmVzNi5qcyJdLCJuYW1lcyI6WyIkQU1JQ2xhc3MiLCIkZXh0ZW5kcyIsImFtaSIsIkNvbnRyb2wiLCIkaW5pdCIsInBhcmVudCIsIm93bmVyIiwiJHN1cGVyIiwib25SZWFkeSIsImFtaVdlYkFwcCIsImxvYWRSZXNvdXJjZXMiLCJvcmlnaW5VUkwiLCJkb25lIiwiZGF0YSIsImFwcGVuZEhUTUwiLCJfY2xhc3MiLCIkY2xhc3MiLCIkIiwib24iLCJkZWZlcnJlZCIsInJlc29sdmVXaXRoIiwiY29udGV4dCIsImRtcCIsImRpZmZfbWF0Y2hfcGF0Y2giLCJyZW5kZXIiLCJ0ZXh0MSIsInRleHQzIiwic2V0dGluZ3MiLCJEZWZlcnJlZCIsInNldHVwIiwidGl0bGUiLCJkIiwiZGlmZl9tYWluIiwiZGlmZl9jbGVhbnVwRWZmaWNpZW5jeSIsImh0bWwxIiwidGV4dFRvSHRtbCIsInJlcGxhY2UiLCJodG1sIiwiaHRtbDIiLCJkaWZmX3ByZXR0eUh0bWwiLCJodG1sMyIsInVubG9jayIsIm1vZGFsIiwicHJvbWlzZSIsInNob3ciXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7O0FBYUE7QUFFQUEsU0FBUyxDQUFDLGFBQUQsRUFBZ0I7QUFDeEI7QUFFQUMsRUFBQUEsUUFBUSxFQUFFQyxHQUFHLENBQUNDLE9BSFU7O0FBS3hCO0FBRUFDLEVBQUFBLEtBQUssRUFBRSxlQUFTQyxNQUFULEVBQWlCQyxLQUFqQixFQUNQO0FBQ0MsU0FBS0MsTUFBTCxDQUFZSCxLQUFaLENBQWtCQyxNQUFsQixFQUEwQkMsS0FBMUI7QUFDQSxHQVZ1Qjs7QUFZeEI7QUFFQUUsRUFBQUEsT0FBTyxFQUFFLG1CQUNUO0FBQUE7O0FBQ0MsV0FBT0MsU0FBUyxDQUFDQyxhQUFWLENBQXdCLENBQzlCRCxTQUFTLENBQUNFLFNBQVYsR0FBc0IseUNBRFEsRUFFOUJGLFNBQVMsQ0FBQ0UsU0FBVixHQUFzQix1Q0FGUSxDQUF4QixFQUdKQyxJQUhJLENBR0MsVUFBQ0MsSUFBRCxFQUFVO0FBRWpCSixNQUFBQSxTQUFTLENBQUNLLFVBQVYsQ0FBcUIsTUFBckIsRUFBNkJELElBQUksQ0FBQyxDQUFELENBQWpDLEVBQXNDRCxJQUF0QyxDQUEyQyxZQUFNO0FBRWhELFlBQU1HLE1BQU0sR0FBRyxLQUFJLENBQUNDLE1BQXBCO0FBRUE7O0FBRUFDLFFBQUFBLENBQUMsQ0FBQyx1Q0FBRCxDQUFELENBQTJDQyxFQUEzQyxDQUE4QyxpQkFBOUMsRUFBaUUsWUFBTTtBQUV0RUgsVUFBQUEsTUFBTSxDQUFDSSxRQUFQLENBQWdCQyxXQUFoQixDQUE0QkwsTUFBTSxDQUFDTSxPQUFQLElBQWtCTixNQUFNLENBQUNJLFFBQXJEO0FBQ0EsU0FIRDtBQUtBOztBQUVBLFFBQUEsS0FBSSxDQUFDRyxHQUFMLEdBQVcsSUFBSUMsZ0JBQUosRUFBWDtBQUVBO0FBQ0EsT0FoQkQ7QUFpQkEsS0F0Qk0sQ0FBUDtBQXVCQSxHQXZDdUI7O0FBeUN4QjtBQUVBQyxFQUFBQSxNQUFNLEVBQUUsZ0JBQVNDLEtBQVQsRUFBZ0JDLEtBQWhCLEVBQXVCQyxRQUF2QixFQUNSO0FBQ0MsUUFBTVIsUUFBUSxHQUFHRixDQUFDLENBQUNXLFFBQUYsRUFBakI7QUFFQTs7QUFIRCwyQkFPS25CLFNBQVMsQ0FBQ29CLEtBQVYsQ0FDSCxDQUFDLFNBQUQsRUFBWSxPQUFaLENBREcsRUFFSCxDQUFDVixRQUFELEVBQVcsVUFBWCxDQUZHLEVBR0hRLFFBSEcsQ0FQTDtBQUFBLFFBTUVOLE9BTkY7QUFBQSxRQU1XUyxLQU5YO0FBYUM7OztBQUVBLFFBQU1DLENBQUMsR0FBRyxLQUFLVCxHQUFMLENBQVNVLFNBQVQsQ0FBbUJQLEtBQW5CLEVBQTBCQyxLQUExQixDQUFWO0FBRUEsU0FBS0osR0FBTCxDQUFTVyxzQkFBVCxDQUFnQ0YsQ0FBaEM7QUFFQTs7QUFFQSxRQUFNRyxLQUFLLEdBQUcsZ0NBQWdDekIsU0FBUyxDQUFDMEIsVUFBVixDQUFxQlYsS0FBckIsRUFBNEJXLE9BQTVCLENBQW9DLEtBQXBDLEVBQTJDLCtCQUEzQyxDQUE5QztBQUVBbkIsSUFBQUEsQ0FBQyxDQUFDLHVDQUFELENBQUQsQ0FBMkNvQixJQUEzQyxDQUFnREgsS0FBaEQ7QUFFQTs7QUFFQSxRQUFNSSxLQUFLLEdBQUcsZ0NBQWdDLEtBQUtoQixHQUFMLENBQVNpQixlQUFULENBQXlCUixDQUF6QixFQUE0QkssT0FBNUIsQ0FBb0MsS0FBcEMsRUFBMkMsK0JBQTNDLENBQTlDO0FBRUFuQixJQUFBQSxDQUFDLENBQUMsdUNBQUQsQ0FBRCxDQUEyQ29CLElBQTNDLENBQWdEQyxLQUFoRDtBQUVBOztBQUVBLFFBQU1FLEtBQUssR0FBRyxnQ0FBZ0MvQixTQUFTLENBQUMwQixVQUFWLENBQXFCVCxLQUFyQixFQUE0QlUsT0FBNUIsQ0FBb0MsS0FBcEMsRUFBMkMsK0JBQTNDLENBQTlDO0FBRUFuQixJQUFBQSxDQUFDLENBQUMsdUNBQUQsQ0FBRCxDQUEyQ29CLElBQTNDLENBQWdERyxLQUFoRDtBQUVBOztBQUVBL0IsSUFBQUEsU0FBUyxDQUFDZ0MsTUFBVjtBQUVBeEIsSUFBQUEsQ0FBQyxDQUFDLHVDQUFELENBQUQsQ0FBMkN5QixLQUEzQyxDQUFpRCxNQUFqRDtBQUVBLFNBQUsxQixNQUFMLENBQVlHLFFBQVosR0FBdUJBLFFBQXZCO0FBQ0EsU0FBS0gsTUFBTCxDQUFZSyxPQUFaLEdBQXNCQSxPQUF0QjtBQUVBOztBQUVBLFdBQU9GLFFBQVEsQ0FBQ3dCLE9BQVQsRUFBUDtBQUVBO0FBQ0EsR0EvRnVCOztBQWlHeEI7QUFFQUMsRUFBQUEsSUFBSSxFQUFFLGNBQVNuQixLQUFULEVBQWdCQyxLQUFoQixFQUF1QkMsUUFBdkIsRUFDTjtBQUNDLFdBQU8sS0FBS0gsTUFBTCxDQUFZQyxLQUFaLEVBQW1CQyxLQUFuQixFQUEwQkMsUUFBMUIsQ0FBUDtBQUNBO0FBRUQ7O0FBeEd3QixDQUFoQixDQUFUO0FBMkdBIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBTUkgV2ViIEZyYW1ld29ya1xuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNC1YWFhYIFRoZSBBTUkgVGVhbSAvIExQU0MgLyBJTjJQM1xuICpcbiAqIFRoaXMgZmlsZSBtdXN0IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBDZUNJTEwtQzpcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1lbi5odG1sXG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZnIuaHRtbFxuICpcbiAqIEBnbG9iYWwgZGlmZl9tYXRjaF9wYXRjaFxuICpcbiAqL1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4kQU1JQ2xhc3MoJ0RpZmZCb3hDdHJsJywge1xuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGV4dGVuZHM6IGFtaS5Db250cm9sLFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkaW5pdDogZnVuY3Rpb24ocGFyZW50LCBvd25lcilcblx0e1xuXHRcdHRoaXMuJHN1cGVyLiRpbml0KHBhcmVudCwgb3duZXIpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRvblJlYWR5OiBmdW5jdGlvbigpXG5cdHtcblx0XHRyZXR1cm4gYW1pV2ViQXBwLmxvYWRSZXNvdXJjZXMoW1xuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvY29udHJvbHMvRGlmZkJveC90d2lnL0RpZmZCb3hDdHJsLnR3aWcnLFxuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvanMvM3JkLXBhcnR5L2RpZmZfbWF0Y2hfcGF0Y2gubWluLmpzJyxcblx0XHRdKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC5hcHBlbmRIVE1MKCdib2R5JywgZGF0YVswXSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdFx0Y29uc3QgX2NsYXNzID0gdGhpcy4kY2xhc3M7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdCQoJyNCOEQ0MkRGMF8wRDI1X0M4MThfMTQzOF81QkFENTJCQjlFMEInKS5vbignaGlkZGVuLmJzLm1vZGFsJywgKCkgPT4ge1xuXG5cdFx0XHRcdFx0X2NsYXNzLmRlZmVycmVkLnJlc29sdmVXaXRoKF9jbGFzcy5jb250ZXh0IHx8IF9jbGFzcy5kZWZlcnJlZCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHR0aGlzLmRtcCA9IG5ldyBkaWZmX21hdGNoX3BhdGNoKCk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHJlbmRlcjogZnVuY3Rpb24odGV4dDEsIHRleHQzLCBzZXR0aW5ncylcblx0e1xuXHRcdGNvbnN0IGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCBbXG5cdFx0XHRjb250ZXh0LCB0aXRsZVxuXHRcdF0gPSBhbWlXZWJBcHAuc2V0dXAoXG5cdFx0XHRbJ2NvbnRleHQnLCAndGl0bGUnXSxcblx0XHRcdFtkZWZlcnJlZCwgJ0VkaXQgYm94J10sXG5cdFx0XHRzZXR0aW5nc1xuXHRcdCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGQgPSB0aGlzLmRtcC5kaWZmX21haW4odGV4dDEsIHRleHQzKTtcblxuXHRcdHRoaXMuZG1wLmRpZmZfY2xlYW51cEVmZmljaWVuY3koZCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGh0bWwxID0gJzxpIGNsYXNzPVwibGluZS1udW1iZXJcIj48L2k+JyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKHRleHQxKS5yZXBsYWNlKC9cXG4vZywgJ1xcbjxpIGNsYXNzPVwibGluZS1udW1iZXJcIj48L2k+Jyk7XG5cblx0XHQkKCcjRTk0QTdGRTdfRkVCQ19BRTEyXzBDMTNfRTYyNUZDMkFERkU2JykuaHRtbChodG1sMSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGh0bWwyID0gJzxpIGNsYXNzPVwibGluZS1udW1iZXJcIj48L2k+JyArIHRoaXMuZG1wLmRpZmZfcHJldHR5SHRtbChkKS5yZXBsYWNlKC9cXG4vZywgJ1xcbjxpIGNsYXNzPVwibGluZS1udW1iZXJcIj48L2k+Jyk7XG5cblx0XHQkKCcjQUYwQkQ2OTJfNkYwOV80NTI3XzI2ODRfQUFGNjIzNjU4NzY3JykuaHRtbChodG1sMik7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGh0bWwzID0gJzxpIGNsYXNzPVwibGluZS1udW1iZXJcIj48L2k+JyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKHRleHQzKS5yZXBsYWNlKC9cXG4vZywgJ1xcbjxpIGNsYXNzPVwibGluZS1udW1iZXJcIj48L2k+Jyk7XG5cblx0XHQkKCcjQzYwNEM2MzZfMzQ2Rl82NEE4XzNFQkVfQURDREUyQUVCMzQzJykuaHRtbChodG1sMyk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGFtaVdlYkFwcC51bmxvY2soKTtcblxuXHRcdCQoJyNCOEQ0MkRGMF8wRDI1X0M4MThfMTQzOF81QkFENTJCQjlFMEInKS5tb2RhbCgnc2hvdycpO1xuXG5cdFx0dGhpcy4kY2xhc3MuZGVmZXJyZWQgPSBkZWZlcnJlZDtcblx0XHR0aGlzLiRjbGFzcy5jb250ZXh0ID0gY29udGV4dDtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRzaG93OiBmdW5jdGlvbih0ZXh0MSwgdGV4dDMsIHNldHRpbmdzKVxuXHR7XG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyKHRleHQxLCB0ZXh0Mywgc2V0dGluZ3MpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuIl19
