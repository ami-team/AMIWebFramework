/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 *
 * @global Viz
 *
 */$AMIClass("GraphCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/Graph/twig/GraphCtrl.twig",amiWebApp.originURL+"/js/3rd-party/viz.min.js",amiWebApp.originURL+"/css/ami.min.css",amiWebApp.originURL+"/css/font-awesome.min.css"],{context:this}).done(function(data){_this.fragmentGraphCtrl=data[0]})},render_old:function render_old(selector,command,settings){var _this2=this;var result=$.Deferred();var _amiWebApp$setup=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup[0];amiCommand.execute(command).done(function(data){var dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";var dict={graph:typeof Viz!=="undefined"?Viz(dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;_this2.replaceHTML(selector,_this2.fragmentGraphCtrl,{dict:dict}).done(function(){$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this2.createControlFromWebLink(_this2.getParent(),e.currentTarget,_this2.ctx)});result.resolveWith(context,[data])})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},render:function render(selector,command,settings){var _this3=this;var result=$.Deferred();var _amiWebApp$setup2=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup2[0];amiCommand.execute(command).done(function(data){_this3.dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";_this3.display(selector).done(function(){result.resolveWith(context,[data])})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},display:function display(selector){var _this4=this;var result=$.Deferred();var dict={graph:typeof Viz!=="undefined"?Viz(this.dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;this.replaceHTML(selector,this.fragmentGraphCtrl,{dict:dict}).done(function(){$(_this4.patchId("#A8E7C88D_7B78_B221_0BCB_6EF1F9CC3C15")).change(function(e){e.preventDefault();_this4.switchOrientation(selector)});$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this4.createControlFromWebLink(_this4.getParent(),e.currentTarget,_this4.ctx)});result.resolveWith(_this4,[result])});return result.promise()},switchOrientation:function switchOrientation(selector){var _this5=this;var result=$.Deferred();var regex=new RegExp("(.*s*rankdirs*=s*\")([L][R]|[T][B])(\"s*.*)");var orientation=this.dotString.match()[2];if(orientation==="LR"){this.dotString=this.dotString.replace(regex,"$1TB$3")}else{this.dotString=this.dotString.replace(regex,"$1LR$3")}console.log(this.dotString);this.display(selector).done(function(){result.resolveWith(_this5,[result])})}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdyYXBoQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiY29udGV4dCIsImRvbmUiLCJkYXRhIiwiZnJhZ21lbnRHcmFwaEN0cmwiLCJyZW5kZXJfb2xkIiwic2VsZWN0b3IiLCJjb21tYW5kIiwic2V0dGluZ3MiLCJyZXN1bHQiLCIkIiwiRGVmZXJyZWQiLCJzZXR1cCIsImFtaUNvbW1hbmQiLCJleGVjdXRlIiwiZG90U3RyaW5nIiwianNwYXRoIiwiZGljdCIsImdyYXBoIiwiVml6IiwicmVwbGFjZSIsIngiLCJqc29uIiwianNvbmJPYmoiLCJKU09OIiwicGFyc2UiLCJodG1sVG9UZXh0IiwiYXR0cnMiLCJ0ZXh0VG9IdG1sIiwic3RyaW5naWZ5Iiwiam9pbiIsImRvYyIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsInN2ZyIsImRvY3VtZW50RWxlbWVudCIsImZpbmQiLCJlYWNoIiwiaSIsImVsIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiYXR0ciIsInByZXBlbmRUbyIsIm91dGVySFRNTCIsInJlcGxhY2VIVE1MIiwiY2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCJjcmVhdGVDb250cm9sRnJvbVdlYkxpbmsiLCJnZXRQYXJlbnQiLCJjdXJyZW50VGFyZ2V0IiwiY3R4IiwicmVzb2x2ZVdpdGgiLCJmYWlsIiwicmVqZWN0V2l0aCIsInByb21pc2UiLCJyZW5kZXIiLCJkaXNwbGF5IiwicGF0Y2hJZCIsImNoYW5nZSIsInN3aXRjaE9yaWVudGF0aW9uIiwicmVnZXgiLCJSZWdFeHAiLCJvcmllbnRhdGlvbiIsIm1hdGNoIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7OztHQWdCQUEsU0FB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QUFMLENBQWFwRCxRQUFiLEVBQXVCSixJQUF2QixDQUE0QixVQUFNLENBQ2pDTyxNQUFNLENBQUM0QyxXQUFQLENBQW1CLE1BQW5CLENBQXlCLENBQUM1QyxNQUFELENBQXpCLENBQ0EsQ0FGRCxDQUdHLENBM09rQixDQUFkLENBQVQiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFNSSBXZWIgRnJhbWV3b3JrXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LVhYWFggVGhlIEFNSSBUZWFtIC8gTFBTQyAvIElOMlAzXG4gKlxuICogVGhpcyBmaWxlIG11c3QgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIENlQ0lMTC1DOlxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWVuLmh0bWxcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1mci5odG1sXG4gKlxuICpcbiAqIEBnbG9iYWwgVml6XG4gKlxuICovXG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4kQU1JQ2xhc3MoJ0dyYXBoQ3RybCcsIHtcblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkZXh0ZW5kczogYW1pLkNvbnRyb2wsXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkaW5pdDogZnVuY3Rpb24ocGFyZW50LCBvd25lcilcblx0e1xuXHRcdHRoaXMuJHN1cGVyLiRpbml0KHBhcmVudCwgb3duZXIpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0b25SZWFkeTogZnVuY3Rpb24oKVxuXHR7XG5cdFx0cmV0dXJuIGFtaVdlYkFwcC5sb2FkUmVzb3VyY2VzKFtcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2NvbnRyb2xzL0dyYXBoL3R3aWcvR3JhcGhDdHJsLnR3aWcnLFxuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvanMvM3JkLXBhcnR5L3Zpei5taW4uanMnLFxuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvY3NzL2FtaS5taW4uY3NzJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcycsXG5cdFx0XSwge2NvbnRleHQ6IHRoaXN9KS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdHRoaXMuZnJhZ21lbnRHcmFwaEN0cmwgPSBkYXRhWzBdO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0cmVuZGVyX29sZDogZnVuY3Rpb24oc2VsZWN0b3IsIGNvbW1hbmQsIHNldHRpbmdzKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgW2NvbnRleHRdID0gYW1pV2ViQXBwLnNldHVwKFsnY29udGV4dCddLCBbcmVzdWx0XSwgc2V0dGluZ3MpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0YW1pQ29tbWFuZC5leGVjdXRlKGNvbW1hbmQpLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0Y29uc3QgZG90U3RyaW5nID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5yb3dzZXR7LkB0eXBlPT09XCJncmFwaFwifS5yb3cuZmllbGR7LkBuYW1lPT09XCJkb3RcIn0uJCcsIGRhdGEpWzBdIHx8ICcnO1xuXG5cdFx0XHRjb25zdCBkaWN0ID0ge1xuXHRcdFx0XHRncmFwaCA6IHR5cGVvZiBWaXogIT09ICd1bmRlZmluZWQnID8gVml6KGRvdFN0cmluZywgJ3N2ZycpIDogJycsXG5cdFx0XHR9O1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0XHRcdC8qIEdSQVBIIFBPU1QgVFJFQVRNRU5UICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGRpY3QuZ3JhcGggPSBkaWN0LmdyYXBoLnJlcGxhY2UoL3hsaW5rOmhyZWY9XCIoW15cIl0qKVwiL2csICh4LCBqc29uKSA9PiB7XG5cblx0XHRcdFx0Y29uc3QganNvbmJPYmogPSBKU09OLnBhcnNlKGFtaVdlYkFwcC5odG1sVG9UZXh0KGpzb24pKTtcblxuXHRcdFx0XHRjb25zdCBhdHRycyA9IFtcblx0XHRcdFx0XHQnZGF0YS1jdHJsPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWN0cmwnXSkgKyAnXCInLFxuXHRcdFx0XHRcdCdkYXRhLWN0cmwtbG9jYXRpb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtY3RybC1sb2NhdGlvbiddKSArICdcIicsXG5cdFx0XHRcdFx0J2RhdGEtcGFyYW1zPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKEpTT04uc3RyaW5naWZ5KGpzb25iT2JqWydkYXRhLXBhcmFtcyddKSkgKyAnXCInLFxuXHRcdFx0XHRcdCdkYXRhLXNldHRpbmdzPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKEpTT04uc3RyaW5naWZ5KGpzb25iT2JqWydkYXRhLXNldHRpbmdzJ10pKSArICdcIicsXG5cdFx0XHRcdFx0J2RhdGEtaWNvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1pY29uJ10pICsgJ1wiJyxcblx0XHRcdFx0XHQnZGF0YS10aXRsZT1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS10aXRsZSddKSArICdcIicsXG5cdFx0XHRcdFx0J2RhdGEtdGl0bGUtaWNvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS10aXRsZS1pY29uJ10pICsgJ1wiJyxcblx0XHRcdFx0XTtcblxuXHRcdFx0XHRyZXR1cm4gJ3hsaW5rOmhyZWY9XCIjXCIgJyArIGF0dHJzLmpvaW4oJyAnKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0Y29uc3QgZG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhkaWN0LmdyYXBoLCAnaW1hZ2Uvc3ZnK3htbCcpO1xuXG5cdFx0XHRjb25zdCBzdmcgPSAkKGRvYy5kb2N1bWVudEVsZW1lbnQpO1xuXG5cdFx0XHRzdmcuZmluZCgnYVtkYXRhLXRpdGxlLWljb25dJykuZWFjaCgoaSwgZWwpID0+IHtcblxuXHRcdFx0XHQkKCc8dHNwYW4gZm9udC1mYW1pbHk9XCJGb250QXdlc29tZVwiPicgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKCcweCcgKyAkKGVsKS5hdHRyKCdkYXRhLXRpdGxlLWljb24nKSkgKyAnPC90c3Bhbj48dHNwYW4+IDwvdHNwYW4+JykucHJlcGVuZFRvKCQoZWwpLmZpbmQoJ3RleHQnKSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0ZGljdC5ncmFwaCA9IGRvYy5kb2N1bWVudEVsZW1lbnQub3V0ZXJIVE1MO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0dGhpcy5yZXBsYWNlSFRNTChzZWxlY3RvciwgdGhpcy5mcmFnbWVudEdyYXBoQ3RybCwge2RpY3Q6IGRpY3R9KS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHQkKHNlbGVjdG9yICsgJyBhW2RhdGEtY3RybF0nKS5jbGljaygoZSkgPT4ge1xuXG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0dGhpcy5jcmVhdGVDb250cm9sRnJvbVdlYkxpbmsodGhpcy5nZXRQYXJlbnQoKSwgZS5jdXJyZW50VGFyZ2V0LCB0aGlzLmN0eCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJlc3VsdC5yZXNvbHZlV2l0aChjb250ZXh0LCBbZGF0YV0pO1xuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cdFx0fSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0LnByb21pc2UoKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgcmVuZGVyOiBmdW5jdGlvbihzZWxlY3RvciwgY29tbWFuZCwgc2V0dGluZ3MpXG4gICAge1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IFtjb250ZXh0XSA9IGFtaVdlYkFwcC5zZXR1cChbJ2NvbnRleHQnXSwgW3Jlc3VsdF0sIHNldHRpbmdzKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGFtaUNvbW1hbmQuZXhlY3V0ZShjb21tYW5kKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdHRoaXMuZG90U3RyaW5nID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5yb3dzZXR7LkB0eXBlPT09XCJncmFwaFwifS5yb3cuZmllbGR7LkBuYW1lPT09XCJkb3RcIn0uJCcsIGRhdGEpWzBdIHx8ICcnO1xuXG5cdFx0XHR0aGlzLmRpc3BsYXkoc2VsZWN0b3IpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdHJlc3VsdC5yZXNvbHZlV2l0aChjb250ZXh0LCBbZGF0YV0pO1xuXG5cdFx0XHR9KTtcblxuXHRcdH0pLmZhaWwoKGRhdGEpID0+IHtcblxuXHRcdFx0cmVzdWx0LnJlamVjdFdpdGgoY29udGV4dCwgW2RhdGFdKTtcblx0XHR9KTtcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0LnByb21pc2UoKTtcblxuICAgIH0sXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICBkaXNwbGF5OiBmdW5jdGlvbihzZWxlY3RvcilcbiAgICB7XG4gICAgXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG4gICAgICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGRpY3QgPSB7XG5cdFx0XHRncmFwaCA6IHR5cGVvZiBWaXogIT09ICd1bmRlZmluZWQnID8gVml6KHRoaXMuZG90U3RyaW5nLCAnc3ZnJykgOiAnJyxcblx0XHR9O1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdC8qIEdSQVBIIFBPU1QgVFJFQVRNRU5UICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRkaWN0LmdyYXBoID0gZGljdC5ncmFwaC5yZXBsYWNlKC94bGluazpocmVmPVwiKFteXCJdKilcIi9nLCAoeCwganNvbikgPT4ge1xuXG5cdFx0XHRjb25zdCBqc29uYk9iaiA9IEpTT04ucGFyc2UoYW1pV2ViQXBwLmh0bWxUb1RleHQoanNvbikpO1xuXG5cdFx0XHRjb25zdCBhdHRycyA9IFtcblx0XHRcdFx0J2RhdGEtY3RybD1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1jdHJsJ10pICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtY3RybC1sb2NhdGlvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1jdHJsLWxvY2F0aW9uJ10pICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtcGFyYW1zPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKEpTT04uc3RyaW5naWZ5KGpzb25iT2JqWydkYXRhLXBhcmFtcyddKSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS1zZXR0aW5ncz1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChKU09OLnN0cmluZ2lmeShqc29uYk9ialsnZGF0YS1zZXR0aW5ncyddKSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS1pY29uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWljb24nXSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS10aXRsZT1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS10aXRsZSddKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLXRpdGxlLWljb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtdGl0bGUtaWNvbiddKSArICdcIicsXG5cdFx0XHRdO1xuXG5cdFx0XHRyZXR1cm4gJ3hsaW5rOmhyZWY9XCIjXCIgJyArIGF0dHJzLmpvaW4oJyAnKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgZG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhkaWN0LmdyYXBoLCAnaW1hZ2Uvc3ZnK3htbCcpO1xuXG5cdFx0Y29uc3Qgc3ZnID0gJChkb2MuZG9jdW1lbnRFbGVtZW50KTtcblxuXHRcdHN2Zy5maW5kKCdhW2RhdGEtdGl0bGUtaWNvbl0nKS5lYWNoKChpLCBlbCkgPT4ge1xuXG5cdFx0XHQkKCc8dHNwYW4gZm9udC1mYW1pbHk9XCJGb250QXdlc29tZVwiPicgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKCcweCcgKyAkKGVsKS5hdHRyKCdkYXRhLXRpdGxlLWljb24nKSkgKyAnPC90c3Bhbj48dHNwYW4+IDwvdHNwYW4+JykucHJlcGVuZFRvKCQoZWwpLmZpbmQoJ3RleHQnKSk7XG5cdFx0fSk7XG5cblx0XHRkaWN0LmdyYXBoID0gZG9jLmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUw7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdHRoaXMucmVwbGFjZUhUTUwoc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRHcmFwaEN0cmwsIHtkaWN0OiBkaWN0fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdCQodGhpcy5wYXRjaElkKCcjQThFN0M4OERfN0I3OF9CMjIxXzBCQ0JfNkVGMUY5Q0MzQzE1JykpLmNoYW5nZSgoZSkgPT4ge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHR0aGlzLnN3aXRjaE9yaWVudGF0aW9uKHNlbGVjdG9yKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQkKHNlbGVjdG9yICsgJyBhW2RhdGEtY3RybF0nKS5jbGljaygoZSkgPT4ge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHR0aGlzLmNyZWF0ZUNvbnRyb2xGcm9tV2ViTGluayh0aGlzLmdldFBhcmVudCgpLCBlLmN1cnJlbnRUYXJnZXQsIHRoaXMuY3R4KTtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcywgW3Jlc3VsdF0pO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG4gICAgfSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHN3aXRjaE9yaWVudGF0aW9uOiBmdW5jdGlvbihzZWxlY3RvcilcbiAgICB7XG4gICAgIFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG4gICAgIFx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCcoLipcXHMqcmFua2Rpclxccyo9XFxzKlwiKShbTF1bUl18W1RdW0JdKShcIlxccyouKiknKTtcblxuICAgICBcdGNvbnN0IG9yaWVudGF0aW9uID0gdGhpcy5kb3RTdHJpbmcubWF0Y2goKVsyXTtcblxuICAgICBcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICBcdGlmKG9yaWVudGF0aW9uID09PSAnTFInIClcbiAgICAgXHR7XG4gICAgIFx0XHR0aGlzLmRvdFN0cmluZyA9IHRoaXMuZG90U3RyaW5nLnJlcGxhY2UocmVnZXgsICckMVRCJDMnKTtcbiAgICAgXHR9XG4gICAgIFx0ZWxzZVxuICAgICBcdHtcblx0XHRcdHRoaXMuZG90U3RyaW5nID0gdGhpcy5kb3RTdHJpbmcucmVwbGFjZShyZWdleCwgJyQxTFIkMycpO1xuICAgICBcdH1cblxuICAgICBcdGNvbnNvbGUubG9nKHRoaXMuZG90U3RyaW5nKTtcblxuXHRcdHRoaXMuZGlzcGxheShzZWxlY3RvcikuZG9uZSgoKSA9PiB7XG5cdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcywgW3Jlc3VsdF0pO1xuXHRcdH0pO1xuICAgIH1cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8iXX0=
