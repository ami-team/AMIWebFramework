/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 *
 * @global Viz
 *
 */$AMIClass("GraphCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/Graph/twig/GraphCtrl.twig",amiWebApp.originURL+"/js/3rd-party/viz.min.js",amiWebApp.originURL+"/css/ami.min.css",amiWebApp.originURL+"/css/font-awesome.min.css"],{context:this}).done(function(data){_this.fragmentGraphCtrl=data[0]})},render_old:function render_old(selector,command,settings){var _this2=this;var result=$.Deferred();var _amiWebApp$setup=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup[0];amiCommand.execute(command).done(function(data){var dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";var dict={graph:typeof Viz!=="undefined"?Viz(dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;_this2.replaceHTML(selector,_this2.fragmentGraphCtrl,{dict:dict}).done(function(){$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this2.createControlFromWebLink(_this2.getParent(),e.currentTarget,_this2.ctx)});result.resolveWith(context,[data])})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},render:function render(selector,command,settings){var _this3=this;console.debug(selector);var result=$.Deferred();var _amiWebApp$setup2=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup2[0];amiCommand.execute(command).done(function(data){_this3.dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";_this3.display(selector).done(function(){$(_this3.patchId("#A8E7C88D_7B78_B221_0BCB_6EF1F9CC3C15")).change(function(e){e.preventDefault();_this3.switchOrientation(selector)});result.resolveWith(context,[data])})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},display:function display(selector){var _this4=this;var result=$.Deferred();var dict={graph:typeof Viz!=="undefined"?Viz(this.dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;this.replaceHTML(selector,this.fragmentGraphCtrl,{dict:dict}).done(function(){$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this4.createControlFromWebLink(_this4.getParent(),e.currentTarget,_this4.ctx)});result.resolveWith(_this4,[result])});return result.promise()},switchOrientation:function switchOrientation(selector){var _this5=this;var result=$.Deferred();var regex=new RegExp("(.*s*rankdirs*=s*\")([L][R]|[T][B])(\"s*.*)");var orientation=this.dotString.match()[2];if(orientation==="LR"){this.dotString=this.dotString.replace(regex,"$1TB$3")}else{this.dotString=this.dotString.replace(regex,"$1LR$3")}console.log(this.dotString);this.display(selector).done(function(){result.resolveWith(_this5,[result])})}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdyYXBoQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiY29udGV4dCIsImRvbmUiLCJkYXRhIiwiZnJhZ21lbnRHcmFwaEN0cmwiLCJyZW5kZXJfb2xkIiwic2VsZWN0b3IiLCJjb21tYW5kIiwic2V0dGluZ3MiLCJyZXN1bHQiLCIkIiwiRGVmZXJyZWQiLCJzZXR1cCIsImFtaUNvbW1hbmQiLCJleGVjdXRlIiwiZG90U3RyaW5nIiwianNwYXRoIiwiZGljdCIsImdyYXBoIiwiVml6IiwicmVwbGFjZSIsIngiLCJqc29uIiwianNvbmJPYmoiLCJKU09OIiwicGFyc2UiLCJodG1sVG9UZXh0IiwiYXR0cnMiLCJ0ZXh0VG9IdG1sIiwic3RyaW5naWZ5Iiwiam9pbiIsImRvYyIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsInN2ZyIsImRvY3VtZW50RWxlbWVudCIsImZpbmQiLCJlYWNoIiwiaSIsImVsIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiYXR0ciIsInByZXBlbmRUbyIsIm91dGVySFRNTCIsInJlcGxhY2VIVE1MIiwiY2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCJjcmVhdGVDb250cm9sRnJvbVdlYkxpbmsiLCJnZXRQYXJlbnQiLCJjdXJyZW50VGFyZ2V0IiwiY3R4IiwicmVzb2x2ZVdpdGgiLCJmYWlsIiwicmVqZWN0V2l0aCIsInByb21pc2UiLCJyZW5kZXIiLCJjb25zb2xlIiwiZGVidWciLCJkaXNwbGF5IiwicGF0Y2hJZCIsImNoYW5nZSIsInN3aXRjaE9yaWVudGF0aW9uIiwicmVnZXgiLCJSZWdFeHAiLCJvcmllbnRhdGlvbiIsIm1hdGNoIiwibG9nIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7O0dB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QUFPLENBQUNVLEdBQVIsQ0FBWSxLQUFLckQsU0FBakIsRUFFSixLQUFLNkMsT0FBTCxDQUFhdEQsUUFBYixFQUF1QkosSUFBdkIsQ0FBNEIsVUFBTSxDQUNqQ08sTUFBTSxDQUFDNEMsV0FBUCxDQUFtQixNQUFuQixDQUF5QixDQUFDNUMsTUFBRCxDQUF6QixDQUNBLENBRkQsQ0FHRyxDQTVPa0IsQ0FBZCxDQUFUIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBTUkgV2ViIEZyYW1ld29ya1xuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNC1YWFhYIFRoZSBBTUkgVGVhbSAvIExQU0MgLyBJTjJQM1xuICpcbiAqIFRoaXMgZmlsZSBtdXN0IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBDZUNJTEwtQzpcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1lbi5odG1sXG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZnIuaHRtbFxuICpcbiAqXG4gKiBAZ2xvYmFsIFZpelxuICpcbiAqL1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdHcmFwaEN0cmwnLCB7XG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGV4dGVuZHM6IGFtaS5Db250cm9sLFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGluaXQ6IGZ1bmN0aW9uKHBhcmVudCwgb3duZXIpXG5cdHtcblx0XHR0aGlzLiRzdXBlci4kaW5pdChwYXJlbnQsIG93bmVyKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKClcblx0e1xuXHRcdHJldHVybiBhbWlXZWJBcHAubG9hZFJlc291cmNlcyhbXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jb250cm9scy9HcmFwaC90d2lnL0dyYXBoQ3RybC50d2lnJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2pzLzNyZC1wYXJ0eS92aXoubWluLmpzJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2Nzcy9hbWkubWluLmNzcycsXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jc3MvZm9udC1hd2Vzb21lLm1pbi5jc3MnLFxuXHRcdF0sIHtjb250ZXh0OiB0aGlzfSkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHR0aGlzLmZyYWdtZW50R3JhcGhDdHJsID0gZGF0YVswXTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHJlbmRlcl9vbGQ6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb21tYW5kLCBzZXR0aW5ncylcblx0e1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IFtjb250ZXh0XSA9IGFtaVdlYkFwcC5zZXR1cChbJ2NvbnRleHQnXSwgW3Jlc3VsdF0sIHNldHRpbmdzKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGFtaUNvbW1hbmQuZXhlY3V0ZShjb21tYW5kKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdGNvbnN0IGRvdFN0cmluZyA9IGFtaVdlYkFwcC5qc3BhdGgoJy4ucm93c2V0ey5AdHlwZT09PVwiZ3JhcGhcIn0ucm93LmZpZWxkey5AbmFtZT09PVwiZG90XCJ9LiQnLCBkYXRhKVswXSB8fCAnJztcblxuXHRcdFx0Y29uc3QgZGljdCA9IHtcblx0XHRcdFx0Z3JhcGggOiB0eXBlb2YgVml6ICE9PSAndW5kZWZpbmVkJyA/IFZpeihkb3RTdHJpbmcsICdzdmcnKSA6ICcnLFxuXHRcdFx0fTtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdFx0XHQvKiBHUkFQSCBQT1NUIFRSRUFUTUVOVCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRkaWN0LmdyYXBoID0gZGljdC5ncmFwaC5yZXBsYWNlKC94bGluazpocmVmPVwiKFteXCJdKilcIi9nLCAoeCwganNvbikgPT4ge1xuXG5cdFx0XHRcdGNvbnN0IGpzb25iT2JqID0gSlNPTi5wYXJzZShhbWlXZWJBcHAuaHRtbFRvVGV4dChqc29uKSk7XG5cblx0XHRcdFx0Y29uc3QgYXR0cnMgPSBbXG5cdFx0XHRcdFx0J2RhdGEtY3RybD1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1jdHJsJ10pICsgJ1wiJyxcblx0XHRcdFx0XHQnZGF0YS1jdHJsLWxvY2F0aW9uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWN0cmwtbG9jYXRpb24nXSkgKyAnXCInLFxuXHRcdFx0XHRcdCdkYXRhLXBhcmFtcz1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChKU09OLnN0cmluZ2lmeShqc29uYk9ialsnZGF0YS1wYXJhbXMnXSkpICsgJ1wiJyxcblx0XHRcdFx0XHQnZGF0YS1zZXR0aW5ncz1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChKU09OLnN0cmluZ2lmeShqc29uYk9ialsnZGF0YS1zZXR0aW5ncyddKSkgKyAnXCInLFxuXHRcdFx0XHRcdCdkYXRhLWljb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtaWNvbiddKSArICdcIicsXG5cdFx0XHRcdFx0J2RhdGEtdGl0bGU9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtdGl0bGUnXSkgKyAnXCInLFxuXHRcdFx0XHRcdCdkYXRhLXRpdGxlLWljb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtdGl0bGUtaWNvbiddKSArICdcIicsXG5cdFx0XHRcdF07XG5cblx0XHRcdFx0cmV0dXJuICd4bGluazpocmVmPVwiI1wiICcgKyBhdHRycy5qb2luKCcgJyk7XG5cdFx0XHR9KTtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGNvbnN0IGRvYyA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZGljdC5ncmFwaCwgJ2ltYWdlL3N2Zyt4bWwnKTtcblxuXHRcdFx0Y29uc3Qgc3ZnID0gJChkb2MuZG9jdW1lbnRFbGVtZW50KTtcblxuXHRcdFx0c3ZnLmZpbmQoJ2FbZGF0YS10aXRsZS1pY29uXScpLmVhY2goKGksIGVsKSA9PiB7XG5cblx0XHRcdFx0JCgnPHRzcGFuIGZvbnQtZmFtaWx5PVwiRm9udEF3ZXNvbWVcIj4nICsgU3RyaW5nLmZyb21DaGFyQ29kZSgnMHgnICsgJChlbCkuYXR0cignZGF0YS10aXRsZS1pY29uJykpICsgJzwvdHNwYW4+PHRzcGFuPiA8L3RzcGFuPicpLnByZXBlbmRUbygkKGVsKS5maW5kKCd0ZXh0JykpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGRpY3QuZ3JhcGggPSBkb2MuZG9jdW1lbnRFbGVtZW50Lm91dGVySFRNTDtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdHRoaXMucmVwbGFjZUhUTUwoc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRHcmFwaEN0cmwsIHtkaWN0OiBkaWN0fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdFx0JChzZWxlY3RvciArICcgYVtkYXRhLWN0cmxdJykuY2xpY2soKGUpID0+IHtcblxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdHRoaXMuY3JlYXRlQ29udHJvbEZyb21XZWJMaW5rKHRoaXMuZ2V0UGFyZW50KCksIGUuY3VycmVudFRhcmdldCwgdGhpcy5jdHgpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgoY29udGV4dCwgW2RhdGFdKTtcblx0XHRcdH0pO1xuXG5cdFx0fSkuZmFpbCgoZGF0YSkgPT4ge1xuXG5cdFx0XHRyZXN1bHQucmVqZWN0V2l0aChjb250ZXh0LCBbZGF0YV0pO1xuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIHJlbmRlcjogZnVuY3Rpb24oc2VsZWN0b3IsIGNvbW1hbmQsIHNldHRpbmdzKVxuICAgIHtcblx0XHRjb25zb2xlLmRlYnVnKHNlbGVjdG9yKTtcblx0XHRjb25zdCByZXN1bHQgPSAkLkRlZmVycmVkKCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCBbY29udGV4dF0gPSBhbWlXZWJBcHAuc2V0dXAoWydjb250ZXh0J10sIFtyZXN1bHRdLCBzZXR0aW5ncyk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRhbWlDb21tYW5kLmV4ZWN1dGUoY29tbWFuZCkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHR0aGlzLmRvdFN0cmluZyA9IGFtaVdlYkFwcC5qc3BhdGgoJy4ucm93c2V0ey5AdHlwZT09PVwiZ3JhcGhcIn0ucm93LmZpZWxkey5AbmFtZT09PVwiZG90XCJ9LiQnLCBkYXRhKVswXSB8fCAnJztcblxuXHRcdFx0dGhpcy5kaXNwbGF5KHNlbGVjdG9yKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHQkKHRoaXMucGF0Y2hJZCgnI0E4RTdDODhEXzdCNzhfQjIyMV8wQkNCXzZFRjFGOUNDM0MxNScpKS5jaGFuZ2UoKGUpID0+IHtcblxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdHRoaXMuc3dpdGNoT3JpZW50YXRpb24oc2VsZWN0b3IpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgoY29udGV4dCwgW2RhdGFdKTtcblxuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cdFx0fSk7XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG5cbiAgICB9LFxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgZGlzcGxheTogZnVuY3Rpb24oc2VsZWN0b3IpXG4gICAge1xuICAgIFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuICAgICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCBkaWN0ID0ge1xuXHRcdFx0Z3JhcGggOiB0eXBlb2YgVml6ICE9PSAndW5kZWZpbmVkJyA/IFZpeih0aGlzLmRvdFN0cmluZywgJ3N2ZycpIDogJycsXG5cdFx0fTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0XHQvKiBHUkFQSCBQT1NUIFRSRUFUTUVOVCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0ZGljdC5ncmFwaCA9IGRpY3QuZ3JhcGgucmVwbGFjZSgveGxpbms6aHJlZj1cIihbXlwiXSopXCIvZywgKHgsIGpzb24pID0+IHtcblxuXHRcdFx0Y29uc3QganNvbmJPYmogPSBKU09OLnBhcnNlKGFtaVdlYkFwcC5odG1sVG9UZXh0KGpzb24pKTtcblxuXHRcdFx0Y29uc3QgYXR0cnMgPSBbXG5cdFx0XHRcdCdkYXRhLWN0cmw9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtY3RybCddKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLWN0cmwtbG9jYXRpb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtY3RybC1sb2NhdGlvbiddKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLXBhcmFtcz1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChKU09OLnN0cmluZ2lmeShqc29uYk9ialsnZGF0YS1wYXJhbXMnXSkpICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtc2V0dGluZ3M9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoSlNPTi5zdHJpbmdpZnkoanNvbmJPYmpbJ2RhdGEtc2V0dGluZ3MnXSkpICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtaWNvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1pY29uJ10pICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtdGl0bGU9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtdGl0bGUnXSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS10aXRsZS1pY29uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLXRpdGxlLWljb24nXSkgKyAnXCInLFxuXHRcdFx0XTtcblxuXHRcdFx0cmV0dXJuICd4bGluazpocmVmPVwiI1wiICcgKyBhdHRycy5qb2luKCcgJyk7XG5cdFx0fSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGRvYyA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZGljdC5ncmFwaCwgJ2ltYWdlL3N2Zyt4bWwnKTtcblxuXHRcdGNvbnN0IHN2ZyA9ICQoZG9jLmRvY3VtZW50RWxlbWVudCk7XG5cblx0XHRzdmcuZmluZCgnYVtkYXRhLXRpdGxlLWljb25dJykuZWFjaCgoaSwgZWwpID0+IHtcblxuXHRcdFx0JCgnPHRzcGFuIGZvbnQtZmFtaWx5PVwiRm9udEF3ZXNvbWVcIj4nICsgU3RyaW5nLmZyb21DaGFyQ29kZSgnMHgnICsgJChlbCkuYXR0cignZGF0YS10aXRsZS1pY29uJykpICsgJzwvdHNwYW4+PHRzcGFuPiA8L3RzcGFuPicpLnByZXBlbmRUbygkKGVsKS5maW5kKCd0ZXh0JykpO1xuXHRcdH0pO1xuXG5cdFx0ZGljdC5ncmFwaCA9IGRvYy5kb2N1bWVudEVsZW1lbnQub3V0ZXJIVE1MO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLnJlcGxhY2VIVE1MKHNlbGVjdG9yLCB0aGlzLmZyYWdtZW50R3JhcGhDdHJsLCB7ZGljdDogZGljdH0pLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHQkKHNlbGVjdG9yICsgJyBhW2RhdGEtY3RybF0nKS5jbGljaygoZSkgPT4ge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHR0aGlzLmNyZWF0ZUNvbnRyb2xGcm9tV2ViTGluayh0aGlzLmdldFBhcmVudCgpLCBlLmN1cnJlbnRUYXJnZXQsIHRoaXMuY3R4KTtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcywgW3Jlc3VsdF0pO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG4gICAgfSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHN3aXRjaE9yaWVudGF0aW9uOiBmdW5jdGlvbihzZWxlY3RvcilcbiAgICB7XG4gICAgIFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG4gICAgIFx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCcoLipcXHMqcmFua2Rpclxccyo9XFxzKlwiKShbTF1bUl18W1RdW0JdKShcIlxccyouKiknKTtcblxuICAgICBcdGNvbnN0IG9yaWVudGF0aW9uID0gdGhpcy5kb3RTdHJpbmcubWF0Y2goKVsyXTtcblxuICAgICBcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICBcdGlmKG9yaWVudGF0aW9uID09PSAnTFInIClcbiAgICAgXHR7XG4gICAgIFx0XHR0aGlzLmRvdFN0cmluZyA9IHRoaXMuZG90U3RyaW5nLnJlcGxhY2UocmVnZXgsICckMVRCJDMnKTtcbiAgICAgXHR9XG4gICAgIFx0ZWxzZVxuICAgICBcdHtcblx0XHRcdHRoaXMuZG90U3RyaW5nID0gdGhpcy5kb3RTdHJpbmcucmVwbGFjZShyZWdleCwgJyQxTFIkMycpO1xuICAgICBcdH1cblxuICAgICBcdGNvbnNvbGUubG9nKHRoaXMuZG90U3RyaW5nKTtcblxuXHRcdHRoaXMuZGlzcGxheShzZWxlY3RvcikuZG9uZSgoKSA9PiB7XG5cdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcywgW3Jlc3VsdF0pO1xuXHRcdH0pO1xuICAgIH1cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8iXX0=
