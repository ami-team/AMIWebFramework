/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 *
 * @global Viz, saveAs
 *
 */$AMIClass("GraphCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/Graph/twig/GraphCtrl.twig",amiWebApp.originURL+"/controls/Graph/twig/graph.twig",amiWebApp.originURL+"/js/3rd-party/viz.min.js",amiWebApp.originURL+"/css/ami.min.css",amiWebApp.originURL+"/css/font-awesome.min.css"],{context:this}).done(function(data){_this.fragmentGraphCtrl=data[0];_this.fragmentGraph=data[1]})},render:function render(selector,command,settings){var _this2=this;var result=$.Deferred();var _amiWebApp$setup=amiWebApp.setup(["context","mode"],[result,"dot"],settings);context=_amiWebApp$setup[0];this.mode=_amiWebApp$setup[1];amiCommand.execute(command).done(function(data){if(_this2.mode==="dot"){_this2.dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||""}else{_this2.dotString=_this2.jsonToDot(data)}console.log(_this2.dotString);_this2.replaceHTML(selector,_this2.fragmentGraphCtrl).done(function(){$(_this2.patchId("#A8E7C88D_7B78_B221_0BCB_6EF1F9CC3C15")).change(function(e){e.preventDefault();_this2.switchDirection()});$(_this2.patchId("#E90168C4_E4BD_ACC8_085F_9953D6CF789F")).click(function(e){e.preventDefault();_this2.exportSVG()});$(_this2.patchId("#D68E49F9_A0C7_C15D_8323_8BA215856428")).click(function(e){e.preventDefault();_this2.exportPNG()});_this2.display().done(function(){result.resolveWith(context,[data])})})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},display:function display(){var _this3=this;amiWebApp.lock();var result=$.Deferred();this.graph=typeof Viz!=="undefined"?Viz(this.dotString,"svg"):"";this.graph=this.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(this.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});this.graph=doc.documentElement.outerHTML;var dict={graph:this.graph};this.replaceHTML(this.patchId("#A0F6763F_DE29_5185_35C1_DCAA81E8C487"),this.fragmentGraph,{dict:dict}).done(function(){$(_this3.patchId("#A0F6763F_DE29_5185_35C1_DCAA81E8C487")+" a[data-ctrl]").click(function(e){e.preventDefault();_this3.createControlFromWebLink(_this3.getParent(),e.currentTarget,_this3.ctx)});amiWebApp.unlock();result.resolveWith(_this3,[result])});return result.promise()},switchDirection:function switchDirection(){var regex=new RegExp("(.*s*rankdirs*=s*\")([L][R]|[T][B])(\"s*.*)");var direction=this.dotString.match(regex)[2];if(direction==="LR"){this.dotString=this.dotString.replace(regex,"$1TB$3")}else if(direction==="TB"){this.dotString=this.dotString.replace(regex,"$1LR$3")}this.display()},exportSVG:function exportSVG(){var blob=new Blob([this.graph],{type:"image/svg+xml",endings:"native"});saveAs(blob,"graph.svg")},exportPNG:function exportPNG(){Viz.svgXmlToPngBase64(this.graph,1,this._exportPNG)},_exportPNG:function _exportPNG(err,data){var binary_string=window.atob(data);var len=binary_string.length;var bytes=new Uint8Array(len);for(var i=0;i<len;i++){bytes[i]=binary_string.charCodeAt(i)}var blob=new Blob([bytes.buffer],{type:"image/png",endings:"native"});saveAs(blob,"graph.png")},jsonToDot:function jsonToDot(json){var nodes=amiWebApp.jspath("..rowset{.@type===\"node\"}.row",json)||[];var edges=amiWebApp.jspath("..rowset{.@type===\"edge\"}.row",json)||[];var dot="digraph \"provenance\" {graph [rankdir=\"LR\", ranksep=\"0.20\"]; node [width=\"7.5em\",height=\"0.3em\", fontcolor=\"#004bffff\", fontname=\"Arial\", fontsize=\"10.0\"];";[].concat(nodes).forEach(function(node,idx){dot+="\""+(amiWebApp.jspath("..field{.@name===\"LABEL\"}.$",node)[0]||"")+"\" "+"[ "+"color=\""+(amiWebApp.jspath("..field{.@name===\"COLOUR\"}.$",node)[0]||"")+"\", "+"label=\""+(amiWebApp.jspath("..field{.@name===\"LABEL\"}.$",node)[0]||"")+"\" ";var url=amiWebApp.jspath("..field{.@name===\"URL\"}.$",node)[0]||"";if(url!==""){dot+=", URL=\""+url+"\" "}dot+="]"});[].concat(edges).forEach(function(edge,idx){dot+="\""+(amiWebApp.jspath("..field{.@name===\"SOURCE\"}.$",edge)[0]||"")+"\" "+"-> "+"\""+(amiWebApp.jspath("..field{.@name===\"DESTINATION\"}.$",edge)[0]||"")+"\" "});dot+="}";return dot}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdyYXBoQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiY29udGV4dCIsImRvbmUiLCJkYXRhIiwiZnJhZ21lbnRHcmFwaEN0cmwiLCJmcmFnbWVudEdyYXBoIiwicmVuZGVyIiwic2VsZWN0b3IiLCJjb21tYW5kIiwic2V0dGluZ3MiLCJyZXN1bHQiLCIkIiwiRGVmZXJyZWQiLCJzZXR1cCIsIm1vZGUiLCJhbWlDb21tYW5kIiwiZXhlY3V0ZSIsImRvdFN0cmluZyIsImpzcGF0aCIsImpzb25Ub0RvdCIsImNvbnNvbGUiLCJsb2ciLCJyZXBsYWNlSFRNTCIsInBhdGNoSWQiLCJjaGFuZ2UiLCJlIiwicHJldmVudERlZmF1bHQiLCJzd2l0Y2hEaXJlY3Rpb24iLCJjbGljayIsImV4cG9ydFNWRyIsImV4cG9ydFBORyIsImRpc3BsYXkiLCJyZXNvbHZlV2l0aCIsImZhaWwiLCJyZWplY3RXaXRoIiwicHJvbWlzZSIsImxvY2siLCJncmFwaCIsIlZpeiIsInJlcGxhY2UiLCJ4IiwianNvbiIsImpzb25iT2JqIiwiSlNPTiIsInBhcnNlIiwiaHRtbFRvVGV4dCIsImF0dHJzIiwidGV4dFRvSHRtbCIsInN0cmluZ2lmeSIsImpvaW4iLCJkb2MiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJzdmciLCJkb2N1bWVudEVsZW1lbnQiLCJmaW5kIiwiZWFjaCIsImkiLCJlbCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImF0dHIiLCJwcmVwZW5kVG8iLCJvdXRlckhUTUwiLCJkaWN0IiwiY3JlYXRlQ29udHJvbEZyb21XZWJMaW5rIiwiZ2V0UGFyZW50IiwiY3VycmVudFRhcmdldCIsImN0eCIsInVubG9jayIsInJlZ2V4IiwiUmVnRXhwIiwiZGlyZWN0aW9uIiwibWF0Y2giLCJibG9iIiwiQmxvYiIsInR5cGUiLCJlbmRpbmdzIiwic2F2ZUFzIiwic3ZnWG1sVG9QbmdCYXNlNjQiLCJfZXhwb3J0UE5HIiwiZXJyIiwiYmluYXJ5X3N0cmluZyIsIndpbmRvdyIsImF0b2IiLCJsZW4iLCJsZW5ndGgiLCJieXRlcyIsIlVpbnQ4QXJyYXkiLCJjaGFyQ29kZUF0IiwiYnVmZmVyIiwibm9kZXMiLCJlZGdlcyIsImRvdCIsImZvckVhY2giLCJub2RlIiwiaWR4IiwidXJsIiwiZWRnZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7OztHQWdCQUEsU0FBUyxDQUFDLFdBQUQsQ0FBYyxDQUd0QkMsUUFBUSxDQUFFQyxHQUFHLENBQUNDLE9BSFEsQ0FPdEJDLEtBQUssQ0FBRSxlQUFTQyxNQUFULENBQWlCQyxLQUFqQixDQUNQLENBQ0MsS0FBS0MsTUFBTCxDQUFZSCxLQUFaLENBQWtCQyxNQUFsQixDQUEwQkMsS0FBMUIsQ0FDQSxDQVZxQixDQWN0QkUsT0FBTyxDQUFFLGtCQUNULGdCQUNDLE1BQU9DLENBQUFBLFNBQVMsQ0FBQ0MsYUFBVixDQUF3QixDQUM5QkQsU0FBUyxDQUFDRSxTQUFWLENBQXNCLHFDQURRLENBRTlCRixTQUFTLENBQUNFLFNBQVYsQ0FBc0IsaUNBRlEsQ0FHOUJGLFNBQVMsQ0FBQ0UsU0FBVixDQUFzQiwwQkFIUSxDQUk5QkYsU0FBUyxDQUFDRSxTQUFWLENBQXNCLGtCQUpRLENBSzlCRixTQUFTLENBQUNFLFNBQVYsQ0FBc0IsMkJBTFEsQ0FBeEIsQ0FNSixDQUFDQyxPQUFPLENBQUUsSUFBVixDQU5JLEVBTWFDLElBTmIsQ0FNa0IsU0FBQ0MsSUFBRCxDQUFVLENBRWxDLEtBQUksQ0FBQ0MsaUJBQUwsQ0FBeUJELElBQUksQ0FBQyxDQUFELENBQTdCLENBQ0EsS0FBSSxDQUFDRSxhQUFMLENBQXFCRixJQUFJLENBQUMsQ0FBRCxDQUN6QixDQVZNLENBV1AsQ0EzQnFCLENBK0JuQkcsTUFBTSxDQUFFLGdCQUFTQyxRQUFU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RSxDQUFBQSxHQUFHLENBQUduRyxTQUFTLENBQUNvQixNQUFWLENBQWlCLDZCQUFqQixDQUE4QzZFLElBQTlDLEVBQW9ELENBQXBELEdBQTBELEVBQXBFLENBRUcsR0FBR0UsR0FBRyxHQUFLLEVBQVgsQ0FDQSxDQUNDSixHQUFHLEVBQUksV0FBWUksR0FBWixDQUFrQixLQUN6QixDQUNGSixHQUFHLEVBQUksR0FDUCxDQWJKLEVBaUJHLFVBQUlELEtBQUosRUFBV0UsT0FBWCxDQUFtQixTQUFDSSxJQUFELENBQU1GLEdBQU4sQ0FBYyxDQUNuQ0gsR0FBRyxFQUFJLE1BQU8vRixTQUFTLENBQUNvQixNQUFWLENBQWlCLGdDQUFqQixDQUFpRGdGLElBQWpELEVBQXVELENBQXZELEdBQTZELEVBQXBFLEVBQTBFLEtBQTFFLENBQ0gsS0FERyxDQUVILElBRkcsRUFFSXBHLFNBQVMsQ0FBQ29CLE1BQVYsQ0FBaUIscUNBQWpCLENBQXNEZ0YsSUFBdEQsRUFBNEQsQ0FBNUQsR0FBa0UsRUFGdEUsRUFFNEUsS0FDbkYsQ0FKRSxFQVFBTCxHQUFHLEVBQUksR0FBUCxDQUlBLE1BQU9BLENBQUFBLEdBQ1AsQ0FqU2tCLENBQWQsQ0FBVCIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQU1JIFdlYiBGcmFtZXdvcmtcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtWFhYWCBUaGUgQU1JIFRlYW0gLyBMUFNDIC8gSU4yUDNcbiAqXG4gKiBUaGlzIGZpbGUgbXVzdCBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgQ2VDSUxMLUM6XG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZW4uaHRtbFxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWZyLmh0bWxcbiAqXG4gKlxuICogQGdsb2JhbCBWaXosIHNhdmVBc1xuICpcbiAqL1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdHcmFwaEN0cmwnLCB7XG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGV4dGVuZHM6IGFtaS5Db250cm9sLFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGluaXQ6IGZ1bmN0aW9uKHBhcmVudCwgb3duZXIpXG5cdHtcblx0XHR0aGlzLiRzdXBlci4kaW5pdChwYXJlbnQsIG93bmVyKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKClcblx0e1xuXHRcdHJldHVybiBhbWlXZWJBcHAubG9hZFJlc291cmNlcyhbXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jb250cm9scy9HcmFwaC90d2lnL0dyYXBoQ3RybC50d2lnJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2NvbnRyb2xzL0dyYXBoL3R3aWcvZ3JhcGgudHdpZycsXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9qcy8zcmQtcGFydHkvdml6Lm1pbi5qcycsXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jc3MvYW1pLm1pbi5jc3MnLFxuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvY3NzL2ZvbnQtYXdlc29tZS5taW4uY3NzJyxcblx0XHRdLCB7Y29udGV4dDogdGhpc30pLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0dGhpcy5mcmFnbWVudEdyYXBoQ3RybCA9IGRhdGFbMF07XG5cdFx0XHR0aGlzLmZyYWdtZW50R3JhcGggPSBkYXRhWzFdO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb21tYW5kLCBzZXR0aW5ncylcbiAgICB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0W2NvbnRleHQsIHRoaXMubW9kZV0gPSBhbWlXZWJBcHAuc2V0dXAoWydjb250ZXh0JywgJ21vZGUnXSwgW3Jlc3VsdCwgJ2RvdCddLCBzZXR0aW5ncyk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRhbWlDb21tYW5kLmV4ZWN1dGUoY29tbWFuZCkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0aWYodGhpcy5tb2RlID09PSAnZG90Jylcblx0XHRcdHtcblx0XHRcdFx0dGhpcy5kb3RTdHJpbmcgPSBhbWlXZWJBcHAuanNwYXRoKCcuLnJvd3NldHsuQHR5cGU9PT1cImdyYXBoXCJ9LnJvdy5maWVsZHsuQG5hbWU9PT1cImRvdFwifS4kJywgZGF0YSlbMF0gfHwgJyc7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoaXMuZG90U3RyaW5nID0gdGhpcy5qc29uVG9Eb3QoZGF0YSk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnNvbGUubG9nKHRoaXMuZG90U3RyaW5nKTtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdHRoaXMucmVwbGFjZUhUTUwoc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRHcmFwaEN0cmwpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0JCh0aGlzLnBhdGNoSWQoJyNBOEU3Qzg4RF83Qjc4X0IyMjFfMEJDQl82RUYxRjlDQzNDMTUnKSkuY2hhbmdlKChlKSA9PiB7XG5cblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0XHR0aGlzLnN3aXRjaERpcmVjdGlvbigpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdCQodGhpcy5wYXRjaElkKCcjRTkwMTY4QzRfRTRCRF9BQ0M4XzA4NUZfOTk1M0Q2Q0Y3ODlGJykpLmNsaWNrKChlKSA9PiB7XG5cblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0XHR0aGlzLmV4cG9ydFNWRygpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQkKHRoaXMucGF0Y2hJZCgnI0Q2OEU0OUY5X0EwQzdfQzE1RF84MzIzXzhCQTIxNTg1NjQyOCcpKS5jbGljaygoZSkgPT4ge1xuXG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0dGhpcy5leHBvcnRQTkcoKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHR0aGlzLmRpc3BsYXkoKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHRcdHJlc3VsdC5yZXNvbHZlV2l0aChjb250ZXh0LCBbZGF0YV0pO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cdFx0fSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0LnByb21pc2UoKTtcblxuICAgIH0sXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICBkaXNwbGF5OiBmdW5jdGlvbigpXG4gICAge1xuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGFtaVdlYkFwcC5sb2NrKCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG4gICAgICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICAgICB0aGlzLmdyYXBoID0gdHlwZW9mIFZpeiAhPT0gJ3VuZGVmaW5lZCcgPyBWaXoodGhpcy5kb3RTdHJpbmcsICdzdmcnKSA6ICcnO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdC8qIEdSQVBIIFBPU1QgVFJFQVRNRU5UICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLmdyYXBoID0gdGhpcy5ncmFwaC5yZXBsYWNlKC94bGluazpocmVmPVwiKFteXCJdKilcIi9nLCAoeCwganNvbikgPT4ge1xuXG5cdFx0XHRjb25zdCBqc29uYk9iaiA9IEpTT04ucGFyc2UoYW1pV2ViQXBwLmh0bWxUb1RleHQoanNvbikpO1xuXG5cdFx0XHRjb25zdCBhdHRycyA9IFtcblx0XHRcdFx0J2RhdGEtY3RybD1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1jdHJsJ10pICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtY3RybC1sb2NhdGlvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1jdHJsLWxvY2F0aW9uJ10pICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtcGFyYW1zPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKEpTT04uc3RyaW5naWZ5KGpzb25iT2JqWydkYXRhLXBhcmFtcyddKSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS1zZXR0aW5ncz1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChKU09OLnN0cmluZ2lmeShqc29uYk9ialsnZGF0YS1zZXR0aW5ncyddKSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS1pY29uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWljb24nXSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS10aXRsZT1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS10aXRsZSddKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLXRpdGxlLWljb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtdGl0bGUtaWNvbiddKSArICdcIicsXG5cdFx0XHRdO1xuXG5cdFx0XHRyZXR1cm4gJ3hsaW5rOmhyZWY9XCIjXCIgJyArIGF0dHJzLmpvaW4oJyAnKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgZG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0aGlzLmdyYXBoLCAnaW1hZ2Uvc3ZnK3htbCcpO1xuXG5cdFx0Y29uc3Qgc3ZnID0gJChkb2MuZG9jdW1lbnRFbGVtZW50KTtcblxuXHRcdHN2Zy5maW5kKCdhW2RhdGEtdGl0bGUtaWNvbl0nKS5lYWNoKChpLCBlbCkgPT4ge1xuXG5cdFx0XHQkKCc8dHNwYW4gZm9udC1mYW1pbHk9XCJGb250QXdlc29tZVwiPicgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKCcweCcgKyAkKGVsKS5hdHRyKCdkYXRhLXRpdGxlLWljb24nKSkgKyAnPC90c3Bhbj48dHNwYW4+IDwvdHNwYW4+JykucHJlcGVuZFRvKCQoZWwpLmZpbmQoJ3RleHQnKSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmdyYXBoID0gZG9jLmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUw7XG5cbiAgICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgZGljdCA9IHtcblx0XHRcdGdyYXBoIDogdGhpcy5ncmFwaCxcblx0XHR9O1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLnJlcGxhY2VIVE1MKHRoaXMucGF0Y2hJZCgnI0EwRjY3NjNGX0RFMjlfNTE4NV8zNUMxX0RDQUE4MUU4QzQ4NycpLCB0aGlzLmZyYWdtZW50R3JhcGgsIHtkaWN0OiBkaWN0fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdCQodGhpcy5wYXRjaElkKCcjQTBGNjc2M0ZfREUyOV81MTg1XzM1QzFfRENBQTgxRThDNDg3JykgKyAnIGFbZGF0YS1jdHJsXScpLmNsaWNrKChlKSA9PiB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdHRoaXMuY3JlYXRlQ29udHJvbEZyb21XZWJMaW5rKHRoaXMuZ2V0UGFyZW50KCksIGUuY3VycmVudFRhcmdldCwgdGhpcy5jdHgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRhbWlXZWJBcHAudW5sb2NrKCk7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcywgW3Jlc3VsdF0pO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG4gICAgfSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHN3aXRjaERpcmVjdGlvbjogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgXHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoJyguKlxccypyYW5rZGlyXFxzKj1cXHMqXCIpKFtMXVtSXXxbVF1bQl0pKFwiXFxzKi4qKScpO1xuXG4gICAgIFx0Y29uc3QgZGlyZWN0aW9uID0gdGhpcy5kb3RTdHJpbmcubWF0Y2gocmVnZXgpWzJdO1xuXG4gICAgIFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgIFx0aWYoZGlyZWN0aW9uID09PSAnTFInIClcbiAgICAgXHR7XG4gICAgIFx0XHR0aGlzLmRvdFN0cmluZyA9IHRoaXMuZG90U3RyaW5nLnJlcGxhY2UocmVnZXgsICckMVRCJDMnKTtcbiAgICAgXHR9XG4gICAgIFx0ZWxzZSBpZihkaXJlY3Rpb24gPT09ICdUQicgKVxuICAgICBcdHtcblx0XHRcdHRoaXMuZG90U3RyaW5nID0gdGhpcy5kb3RTdHJpbmcucmVwbGFjZShyZWdleCwgJyQxTFIkMycpO1xuICAgICBcdH1cblxuXHRcdHRoaXMuZGlzcGxheSgpO1xuICAgIH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRleHBvcnRTVkc6IGZ1bmN0aW9uKClcblx0e1xuXHRcdGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGhpcy5ncmFwaF0sIHtcblx0XHRcdHR5cGU6ICdpbWFnZS9zdmcreG1sJyxcblx0XHRcdGVuZGluZ3MgOiAnbmF0aXZlJyxcblx0XHR9KTtcblxuXHRcdHNhdmVBcyhibG9iLCAnZ3JhcGguc3ZnJyk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRleHBvcnRQTkc6IGZ1bmN0aW9uKClcblx0e1xuXHRcdFZpei5zdmdYbWxUb1BuZ0Jhc2U2NCh0aGlzLmdyYXBoLCAxLCB0aGlzLl9leHBvcnRQTkcpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0X2V4cG9ydFBORzogZnVuY3Rpb24oZXJyLCBkYXRhKVxuICAgIHtcblx0XHRsZXQgYmluYXJ5X3N0cmluZyA9IHdpbmRvdy5hdG9iKGRhdGEpO1xuXHRcdGxldCBsZW4gPSBiaW5hcnlfc3RyaW5nLmxlbmd0aDtcblx0XHRsZXQgYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW4pO1xuXG5cdFx0Zm9yKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKVxuXHRcdHtcblx0XHRcdGJ5dGVzW2ldID0gYmluYXJ5X3N0cmluZy5jaGFyQ29kZUF0KGkpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbYnl0ZXMuYnVmZmVyXSwge1xuXHRcdFx0dHlwZTogJ2ltYWdlL3BuZycsXG5cdFx0XHRlbmRpbmdzIDogJ25hdGl2ZScsXG5cdFx0fSk7XG5cblx0XHRzYXZlQXMoYmxvYiwgJ2dyYXBoLnBuZycpO1xuXHR9LFxuXG5cdGpzb25Ub0RvdDogZnVuY3Rpb24oanNvbilcbiAgICB7XG5cdFx0bGV0IG5vZGVzID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5yb3dzZXR7LkB0eXBlPT09XCJub2RlXCJ9LnJvdycsIGpzb24pIHx8IFtdO1xuXHRcdGxldCBlZGdlcyA9IGFtaVdlYkFwcC5qc3BhdGgoJy4ucm93c2V0ey5AdHlwZT09PVwiZWRnZVwifS5yb3cnLCBqc29uKSB8fCBbXTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIFx0bGV0IGRvdCA9ICdkaWdyYXBoIFwicHJvdmVuYW5jZVwiIHtncmFwaCBbcmFua2Rpcj1cIkxSXCIsIHJhbmtzZXA9XCIwLjIwXCJdOyBub2RlIFt3aWR0aD1cIjcuNWVtXCIsaGVpZ2h0PVwiMC4zZW1cIiwgZm9udGNvbG9yPVwiIzAwNGJmZmZmXCIsIGZvbnRuYW1lPVwiQXJpYWxcIiwgZm9udHNpemU9XCIxMC4wXCJdOyc7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRbLi4ubm9kZXNdLmZvckVhY2goKG5vZGUsaWR4KSA9PiB7XG4gICAgXHRcdGRvdCArPSAnXCInICsgKGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJMQUJFTFwifS4kJywgbm9kZSlbMF0gfHwgJycpICsgJ1wiICdcbiAgICBcdFx0XHQrICdbICdcbiAgICBcdFx0XHQrICdjb2xvcj1cIicgKyAoYW1pV2ViQXBwLmpzcGF0aCgnLi5maWVsZHsuQG5hbWU9PT1cIkNPTE9VUlwifS4kJywgbm9kZSlbMF0gfHwgJycpICsgJ1wiLCAnXG4gICAgXHRcdFx0KyAnbGFiZWw9XCInICsgKGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJMQUJFTFwifS4kJywgbm9kZSlbMF0gfHwgJycpICsgJ1wiICc7XG5cblx0XHRcdFx0bGV0IHVybCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJVUkxcIn0uJCcsIG5vZGUpWzBdIHx8ICcnO1xuXG4gICAgXHRcdFx0aWYodXJsICE9PSAnJylcbiAgICBcdFx0XHR7XG4gICAgXHRcdFx0XHRkb3RcdCs9ICcsIFVSTD1cIicgKyB1cmwgKyAnXCIgJztcbiAgICBcdFx0XHR9XG4gICAgXHRcdGRvdCArPSAnXSc7XG4gICAgXHR9KTtcblxuICAgIFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgXHRbLi4uZWRnZXNdLmZvckVhY2goKGVkZ2UsaWR4KSA9PiB7XG5cdFx0XHRkb3QgKz0gJ1wiJyArIChhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwiU09VUkNFXCJ9LiQnLCBlZGdlKVswXSB8fCAnJykgKyAnXCIgJ1xuXHRcdFx0XHQgKyAnLT4gJ1xuXHRcdFx0XHQgKyAnXCInICsgKGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJERVNUSU5BVElPTlwifS4kJywgZWRnZSlbMF0gfHwgJycpICsgJ1wiICdcblx0XHR9KTtcblxuICAgIFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgXHRkb3QgKz0gJ30nXG5cbiAgICBcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIFx0cmV0dXJuIGRvdDtcbiAgICB9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG59KTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovIl19
