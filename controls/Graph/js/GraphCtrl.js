/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 *
 * @global Viz
 *
 */$AMIClass("GraphCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/Graph/twig/GraphCtrl.twig",amiWebApp.originURL+"/js/3rd-party/viz.min.js",amiWebApp.originURL+"/css/ami.min.css",amiWebApp.originURL+"/css/font-awesome.min.css"],{context:this}).done(function(data){_this.fragmentGraphCtrl=data[0]})},render:function render(selector,command,settings){var _this2=this;var result=$.Deferred();var _amiWebApp$setup=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup[0];amiCommand.execute(command).done(function(data){var dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";var dict={graph:typeof Viz!=="undefined"?Viz(dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=[];attrs.push("data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"");attrs.push("data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"");attrs.push("data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"");attrs.push("data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"");attrs.push("data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"");attrs.push("data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"");attrs.push("data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\"");return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;_this2.replaceHTML(_this2._selector=selector,_this2.fragmentGraphCtrl,{dict:dict}).done(function(){$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this2.createControlFromWebLink(_this2.getParent(),e.currentTarget,_this2.ctx)});result.resolveWith(context,[data])})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdyYXBoQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiY29udGV4dCIsImRvbmUiLCJkYXRhIiwiZnJhZ21lbnRHcmFwaEN0cmwiLCJyZW5kZXIiLCJzZWxlY3RvciIsImNvbW1hbmQiLCJzZXR0aW5ncyIsInJlc3VsdCIsIiQiLCJEZWZlcnJlZCIsInNldHVwIiwiYW1pQ29tbWFuZCIsImV4ZWN1dGUiLCJkb3RTdHJpbmciLCJqc3BhdGgiLCJkaWN0IiwiZ3JhcGgiLCJWaXoiLCJyZXBsYWNlIiwieCIsImpzb24iLCJqc29uYk9iaiIsIkpTT04iLCJwYXJzZSIsImh0bWxUb1RleHQiLCJhdHRycyIsInB1c2giLCJ0ZXh0VG9IdG1sIiwic3RyaW5naWZ5Iiwiam9pbiIsImRvYyIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsInN2ZyIsImRvY3VtZW50RWxlbWVudCIsImZpbmQiLCJlYWNoIiwiaSIsImVsIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiYXR0ciIsInByZXBlbmRUbyIsIm91dGVySFRNTCIsInJlcGxhY2VIVE1MIiwiX3NlbGVjdG9yIiwiY2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCJjcmVhdGVDb250cm9sRnJvbVdlYkxpbmsiLCJnZXRQYXJlbnQiLCJjdXJyZW50VGFyZ2V0IiwiY3R4IiwicmVzb2x2ZVdpdGgiLCJmYWlsIiwicmVqZWN0V2l0aCIsInByb21pc2UiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7R0FnQkFBLFNBQVMsQ0FBQyxXQUFELENBQWMsQ0FHdEJDLFFBQVEsQ0FBRUMsR0FBRyxDQUFDQyxPQUhRLENBT3RCQyxLQUFLLENBQUUsZUFBU0MsTUFBVCxDQUFpQkMsS0FBakIsQ0FDUCxDQUNDLEtBQUtDLE1BQUwsQ0FBWUgsS0FBWixDQUFrQkMsTUFBbEIsQ0FBMEJDLEtBQTFCLENBQ0EsQ0FWcUIsQ0FjdEJFLE9BQU8sQ0FBRSxrQkFDVCxnQkFDQyxNQUFPQyxDQUFBQSxTQUFTLENBQUNDLGFBQVYsQ0FBd0IsQ0FDOUJELFNBQVMsQ0FBQ0UsU0FBVixDQUFzQixxQ0FEUSxDQUU5QkYsU0FBUyxDQUFDRSxTQUFWLENBQXNCLDBCQUZRLENBRzlCRixTQUFTLENBQUNFLFNBQVYsQ0FBc0Isa0JBSFEsQ0FJOUJGLFNBQVMsQ0FBQ0UsU0FBVixDQUFzQiwyQkFKUSxDQUF4QixDQUtKLENBQUNDLE9BQU8sQ0FBRSxJQUFWLENBTEksRUFLYUMsSUFMYixDQUtrQixTQUFDQyxJQUFELENBQVUsQ0FFbEMsS0FBSSxDQUFDQyxpQkFBTCxDQUF5QkQsSUFBSSxDQUFDLENBQUQsQ0FDN0IsQ0FSTSxDQVNQLENBekJxQixDQTZCdEJFLE1BQU0sQ0FBRSxnQkFBU0MsUUFBVCxDQUFtQkMsT0FBbkIsQ0FBNEJDLFFBQTVCLENBQ1IsaUJBQ0MsR0FBTUMsQ0FBQUEsTUFBTSxDQUFHQyxDQUFDLENBQUNDLFFBQUYsRUFBZixDQURELHFCQUttQmIsU0FBUyxDQUFDYyxLQUFWLENBQWdCLENBQUMsU0FBRCxDQUFoQixDQUE2QixDQUFDSCxNQUFELENBQTdCLENBQXVDRCxRQUF2QyxDQUxuQixDQUtRUCxPQUxSLHFCQVNDWSxVQUFVLENBQUNDLE9BQVgsQ0FBbUJQLE9BQW5CLEVBQTRCTCxJQUE1QixDQUFpQyxTQUFDQyxJQUFELENBQVUsQ0FFMUMsR0FBSVksQ0FBQUEsU0FBUyxDQUFHakIsU0FBUyxDQUFDa0IsTUFBVixDQUFpQiw0REFBakIsQ0FBMkViLElBQTNFLEVBQWlGLENBQWpGLEdBQXVGLEVBQXZHLENBRUEsR0FBSWMsQ0FBQUEsSUFBSSxDQUFHLENBQ1ZDLEtBQUssQ0FBRyxNQUFPQyxDQUFBQSxHQUFQLEdBQWUsV0FBZixDQUE4QkEsR0FBRyxDQUFDSixTQUFELENBQVksS0FBWixDQUFqQyxDQUFzRCxFQURwRCxDQUFYLENBUUFFLElBQUksQ0FBQ0MsS0FBTCxDQUFhRCxJQUFJLENBQUNDLEtBQUwsQ0FBV0UsT0FBWCxDQUFtQix1QkFBbkIsQ0FBNEMsU0FBU0MsQ0FBVCxDQUFZQyxJQUFaLENBQWtCLENBRTFFLEdBQUlDLENBQUFBLFFBQVEsQ0FBR0MsSUFBSSxDQUFDQyxLQUFMLENBQVczQixTQUFTLENBQUM0QixVQUFWLENBQXFCSixJQUFyQixDQUFYLENBQWYsQ0FFQSxHQUFJSyxDQUFBQSxLQUFLLENBQUcsRUFBWixDQUVBQSxLQUFLLENBQUNDLElBQU4sQ0FBVyxlQUFnQjlCLFNBQVMsQ0FBQytCLFVBQVYsQ0FBcUJOLFFBQVEsQ0FBQyxXQUFELENBQTdCLENBQWhCLENBQThELElBQXpFLEVBQ0FJLEtBQUssQ0FBQ0MsSUFBTixDQUFXLHdCQUF5QjlCLFNBQVMsQ0FBQytCLFVBQVYsQ0FBcUJOLFFBQVEsQ0FBQyxvQkFBRCxDQUE3QixDQUF6QixDQUFnRixJQUEzRixFQUNBSSxLQUFLLENBQUNDLElBQU4sQ0FBVyxpQkFBa0I5QixTQUFTLENBQUMrQixVQUFWLENBQXFCTCxJQUFJLENBQUNNLFNBQUwsQ0FBZVAsUUFBUSxDQUFDLGFBQUQsQ0FBdkIsQ0FBckIsQ0FBbEIsQ0FBa0YsSUFBN0YsRUFDQUksS0FBSyxDQUFDQyxJQUFOLENBQVcsbUJBQW9COUIsU0FBUyxDQUFDK0IsVUFBVixDQUFxQkwsSUFBSSxDQUFDTSxTQUFMLENBQWVQLFFBQVEsQ0FBQyxlQUFELENBQXZCLENBQXJCLENBQXBCLENBQXNGLElBQWpHLEVBQ0FJLEtBQUssQ0FBQ0MsSUFBTixDQUFXLGVBQWdCOUIsU0FBUyxDQUFDK0IsVUFBVixDQUFxQk4sUUFBUSxDQUFDLFdBQUQsQ0FBN0IsQ0FBaEIsQ0FBOEQsSUFBekUsRUFDQUksS0FBSyxDQUFDQyxJQUFOLENBQVcsZ0JBQWlCOUIsU0FBUyxDQUFDK0IsVUFBVixDQUFxQk4sUUFBUSxDQUFDLFlBQUQsQ0FBN0IsQ0FBakIsQ0FBZ0UsSUFBM0UsRUFDQUksS0FBSyxDQUFDQyxJQUFOLENBQVcscUJBQXNCOUIsU0FBUyxDQUFDK0IsVUFBVixDQUFxQk4sUUFBUSxDQUFDLGlCQUFELENBQTdCLENBQXRCLENBQTBFLElBQXJGLEVBRUEsTUFBTyxvQkFBb0JJLEtBQUssQ0FBQ0ksSUFBTixDQUFXLEdBQVgsQ0FDM0IsQ0FmWSxDQUFiLENBbUJBLEdBQUlDLENBQUFBLEdBQUcsQ0FBRyxHQUFJQyxDQUFBQSxTQUFKLEdBQWdCQyxlQUFoQixDQUFnQ2pCLElBQUksQ0FBQ0MsS0FBckMsQ0FBNEMsZUFBNUMsQ0FBVixDQUVBLEdBQUlpQixDQUFBQSxHQUFHLENBQUd6QixDQUFDLENBQUNzQixHQUFHLENBQUNJLGVBQUwsQ0FBWCxDQUVBRCxHQUFHLENBQUNFLElBQUosQ0FBUyxvQkFBVCxFQUErQkMsSUFBL0IsQ0FBb0MsU0FBQ0MsQ0FBRCxDQUFJQyxFQUFKLENBQVcsQ0FFOUM5QixDQUFDLENBQUMsc0NBQXNDK0IsTUFBTSxDQUFDQyxZQUFQLENBQW9CLEtBQU9oQyxDQUFDLENBQUM4QixFQUFELENBQUQsQ0FBTUcsSUFBTixDQUFXLGlCQUFYLENBQTNCLENBQXRDLENBQWtHLDBCQUFuRyxDQUFELENBQWdJQyxTQUFoSSxDQUEwSWxDLENBQUMsQ0FBQzhCLEVBQUQsQ0FBRCxDQUFNSCxJQUFOLENBQVcsTUFBWCxDQUExSSxDQUNBLENBSEQsRUFLQXBCLElBQUksQ0FBQ0MsS0FBTCxDQUFhYyxHQUFHLENBQUNJLGVBQUosQ0FBb0JTLFNBQWpDLENBSUEsTUFBSSxDQUFDQyxXQUFMLENBQWlCLE1BQUksQ0FBQ0MsU0FBTCxDQUFpQnpDLFFBQWxDLENBQTRDLE1BQUksQ0FBQ0YsaUJBQWpELENBQW9FLENBQUNhLElBQUksQ0FBRUEsSUFBUCxDQUFwRSxFQUFrRmYsSUFBbEYsQ0FBdUYsVUFBTSxDQUU1RlEsQ0FBQyxDQUFDSixRQUFRLENBQUcsZUFBWixDQUFELENBQThCMEMsS0FBOUIsQ0FBb0MsU0FBQ0MsQ0FBRCxDQUFPLENBRTFDQSxDQUFDLENBQUNDLGNBQUYsR0FFQSxNQUFJLENBQUNDLHdCQUFMLENBQThCLE1BQUksQ0FBQ0MsU0FBTCxFQUE5QixDQUFnREgsQ0FBQyxDQUFDSSxhQUFsRCxDQUFpRSxNQUFJLENBQUNDLEdBQXRFLENBQ0EsQ0FMRCxFQU9BN0MsTUFBTSxDQUFDOEMsV0FBUCxDQUFtQnRELE9BQW5CLENBQTRCLENBQUNFLElBQUQsQ0FBNUIsQ0FDQSxDQVZELENBWUEsQ0F4REQsRUF3REdxRCxJQXhESCxDQXdEUSxTQUFDckQsSUFBRCxDQUFVLENBRWpCTSxNQUFNLENBQUNnRCxVQUFQLENBQWtCeEQsT0FBbEIsQ0FBMkIsQ0FBQ0UsSUFBRCxDQUEzQixDQUNBLENBM0RELEVBK0RBLE1BQU9NLENBQUFBLE1BQU0sQ0FBQ2lELE9BQVAsRUFDUCxDQXZHcUIsQ0FBZCxDQUFUIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBTUkgV2ViIEZyYW1ld29ya1xuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNC1YWFhYIFRoZSBBTUkgVGVhbSAvIExQU0MgLyBJTjJQM1xuICpcbiAqIFRoaXMgZmlsZSBtdXN0IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBDZUNJTEwtQzpcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1lbi5odG1sXG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZnIuaHRtbFxuICpcbiAqXG4gKiBAZ2xvYmFsIFZpelxuICpcbiAqL1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdHcmFwaEN0cmwnLCB7XG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGV4dGVuZHM6IGFtaS5Db250cm9sLFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGluaXQ6IGZ1bmN0aW9uKHBhcmVudCwgb3duZXIpXG5cdHtcblx0XHR0aGlzLiRzdXBlci4kaW5pdChwYXJlbnQsIG93bmVyKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKClcblx0e1xuXHRcdHJldHVybiBhbWlXZWJBcHAubG9hZFJlc291cmNlcyhbXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jb250cm9scy9HcmFwaC90d2lnL0dyYXBoQ3RybC50d2lnJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2pzLzNyZC1wYXJ0eS92aXoubWluLmpzJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2Nzcy9hbWkubWluLmNzcycsXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jc3MvZm9udC1hd2Vzb21lLm1pbi5jc3MnLFxuXHRcdF0sIHtjb250ZXh0OiB0aGlzfSkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHR0aGlzLmZyYWdtZW50R3JhcGhDdHJsID0gZGF0YVswXTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHJlbmRlcjogZnVuY3Rpb24oc2VsZWN0b3IsIGNvbW1hbmQsIHNldHRpbmdzKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgW2NvbnRleHRdID0gYW1pV2ViQXBwLnNldHVwKFsnY29udGV4dCddLCBbcmVzdWx0XSwgc2V0dGluZ3MpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0YW1pQ29tbWFuZC5leGVjdXRlKGNvbW1hbmQpLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0bGV0IGRvdFN0cmluZyA9IGFtaVdlYkFwcC5qc3BhdGgoJy4ucm93c2V0ey5AdHlwZT09PVwiZ3JhcGhcIn0ucm93LmZpZWxkey5AbmFtZT09PVwiZG90XCJ9LiQnLCBkYXRhKVswXSB8fCAnJztcblxuXHRcdFx0bGV0IGRpY3QgPSB7XG5cdFx0XHRcdGdyYXBoIDogdHlwZW9mIFZpeiAhPT0gJ3VuZGVmaW5lZCcgPyAgVml6KGRvdFN0cmluZywgJ3N2ZycpIDogJycsXG5cdFx0XHR9O1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0XHRcdC8qIEdSQVBIIFBPU1QgVFJFQVRNRU5UICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGRpY3QuZ3JhcGggPSBkaWN0LmdyYXBoLnJlcGxhY2UoL3hsaW5rOmhyZWY9XCIoW15cIl0qKVwiL2csIGZ1bmN0aW9uKHgsIGpzb24pIHtcblxuXHRcdFx0XHRsZXQganNvbmJPYmogPSBKU09OLnBhcnNlKGFtaVdlYkFwcC5odG1sVG9UZXh0KGpzb24pKTtcblxuXHRcdFx0XHRsZXQgYXR0cnMgPSBbXTtcblxuXHRcdFx0XHRhdHRycy5wdXNoKCdkYXRhLWN0cmw9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtY3RybCddKSArICdcIicpO1xuXHRcdFx0XHRhdHRycy5wdXNoKCdkYXRhLWN0cmwtbG9jYXRpb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtY3RybC1sb2NhdGlvbiddKSArICdcIicpO1xuXHRcdFx0XHRhdHRycy5wdXNoKCdkYXRhLXBhcmFtcz1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChKU09OLnN0cmluZ2lmeShqc29uYk9ialsnZGF0YS1wYXJhbXMnXSkpICsgJ1wiJyk7XG5cdFx0XHRcdGF0dHJzLnB1c2goJ2RhdGEtc2V0dGluZ3M9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoSlNPTi5zdHJpbmdpZnkoanNvbmJPYmpbJ2RhdGEtc2V0dGluZ3MnXSkpICsgJ1wiJyk7XG5cdFx0XHRcdGF0dHJzLnB1c2goJ2RhdGEtaWNvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1pY29uJ10pICsgJ1wiJyk7XG5cdFx0XHRcdGF0dHJzLnB1c2goJ2RhdGEtdGl0bGU9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtdGl0bGUnXSkgKyAnXCInKTtcblx0XHRcdFx0YXR0cnMucHVzaCgnZGF0YS10aXRsZS1pY29uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLXRpdGxlLWljb24nXSkgKyAnXCInKTtcblxuXHRcdFx0XHRyZXR1cm4gJ3hsaW5rOmhyZWY9XCIjXCIgJyArIGF0dHJzLmpvaW4oJyAnKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0bGV0IGRvYyA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZGljdC5ncmFwaCwgJ2ltYWdlL3N2Zyt4bWwnKTtcblxuXHRcdFx0bGV0IHN2ZyA9ICQoZG9jLmRvY3VtZW50RWxlbWVudCk7XG5cblx0XHRcdHN2Zy5maW5kKCdhW2RhdGEtdGl0bGUtaWNvbl0nKS5lYWNoKChpLCBlbCkgPT4ge1xuXG5cdFx0XHRcdCQoJzx0c3BhbiBmb250LWZhbWlseT1cIkZvbnRBd2Vzb21lXCI+JyArIFN0cmluZy5mcm9tQ2hhckNvZGUoJzB4JyArICQoZWwpLmF0dHIoJ2RhdGEtdGl0bGUtaWNvbicpKSArICc8L3RzcGFuPjx0c3Bhbj4gPC90c3Bhbj4nKS5wcmVwZW5kVG8oJChlbCkuZmluZCgndGV4dCcpKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRkaWN0LmdyYXBoID0gZG9jLmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUw7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0aGlzLnJlcGxhY2VIVE1MKHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRHcmFwaEN0cmwsIHtkaWN0OiBkaWN0fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdFx0JChzZWxlY3RvciArICcgYVtkYXRhLWN0cmxdJykuY2xpY2soKGUpID0+IHtcblxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdHRoaXMuY3JlYXRlQ29udHJvbEZyb21XZWJMaW5rKHRoaXMuZ2V0UGFyZW50KCksIGUuY3VycmVudFRhcmdldCwgdGhpcy5jdHgpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgoY29udGV4dCwgW2RhdGFdKTtcblx0XHRcdH0pO1xuXG5cdFx0fSkuZmFpbCgoZGF0YSkgPT4ge1xuXG5cdFx0XHRyZXN1bHQucmVqZWN0V2l0aChjb250ZXh0LCBbZGF0YV0pO1xuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG5cdH1cblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xufSk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLyJdfQ==
