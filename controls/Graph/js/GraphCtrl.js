/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 *
 * @global Viz
 *
 */$AMIClass("GraphCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/Graph/twig/GraphCtrl.twig",amiWebApp.originURL+"/controls/Graph/twig/graph.twig",amiWebApp.originURL+"/js/3rd-party/viz.min.js",amiWebApp.originURL+"/css/ami.min.css",amiWebApp.originURL+"/css/font-awesome.min.css"],{context:this}).done(function(data){_this.fragmentGraphCtrl=data[0];_this.fragmentGraph=data[1]})},render_old:function render_old(selector,command,settings){var _this2=this;var result=$.Deferred();var _amiWebApp$setup=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup[0];amiCommand.execute(command).done(function(data){var dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";var dict={graph:typeof Viz!=="undefined"?Viz(dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;_this2.replaceHTML(selector,_this2.fragmentGraphCtrl,{dict:dict}).done(function(){$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this2.createControlFromWebLink(_this2.getParent(),e.currentTarget,_this2.ctx)});result.resolveWith(context,[data])})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},render:function render(selector,command,settings){var _this3=this;var result=$.Deferred();var _amiWebApp$setup2=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup2[0];amiCommand.execute(command).done(function(data){_this3.dotString=amiWebApp.jspath("..rowset{.@type===\"graph\"}.row.field{.@name===\"dot\"}.$",data)[0]||"";_this3.replaceHTML(selector,_this3.fragmentGraphCtrl).done(function(){_this3.display().done(function(){result.resolveWith(context,[data])})})}).fail(function(data){result.rejectWith(context,[data])});return result.promise()},display:function display(){var _this4=this;var result=$.Deferred();var dict={graph:typeof Viz!=="undefined"?Viz(this.dotString,"svg"):""};dict.graph=dict.graph.replace(/xlink:href="([^"]*)"/g,function(x,json){var jsonbObj=JSON.parse(amiWebApp.htmlToText(json));var attrs=["data-ctrl=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl"])+"\"","data-ctrl-location=\""+amiWebApp.textToHtml(jsonbObj["data-ctrl-location"])+"\"","data-params=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-params"]))+"\"","data-settings=\""+amiWebApp.textToHtml(JSON.stringify(jsonbObj["data-settings"]))+"\"","data-icon=\""+amiWebApp.textToHtml(jsonbObj["data-icon"])+"\"","data-title=\""+amiWebApp.textToHtml(jsonbObj["data-title"])+"\"","data-title-icon=\""+amiWebApp.textToHtml(jsonbObj["data-title-icon"])+"\""];return"xlink:href=\"#\" "+attrs.join(" ")});var doc=new DOMParser().parseFromString(dict.graph,"image/svg+xml");var svg=$(doc.documentElement);svg.find("a[data-title-icon]").each(function(i,el){$("<tspan font-family=\"FontAwesome\">"+String.fromCharCode("0x"+$(el).attr("data-title-icon"))+"</tspan><tspan> </tspan>").prependTo($(el).find("text"))});dict.graph=doc.documentElement.outerHTML;this.replaceHTML(this.patchId("#A0F6763F_DE29_5185_35C1_DCAA81E8C487"),this.fragmentGraph,{dict:dict}).done(function(){$(_this4.patchId("#A8E7C88D_7B78_B221_0BCB_6EF1F9CC3C15")).change(function(e){e.preventDefault();_this4.switchOrientation()});$(selector+" a[data-ctrl]").click(function(e){e.preventDefault();_this4.createControlFromWebLink(_this4.getParent(),e.currentTarget,_this4.ctx)});result.resolveWith(_this4,[result])});return result.promise()},switchOrientation:function switchOrientation(){var _this5=this;var result=$.Deferred();var regex=new RegExp("(.*s*rankdirs*=s*\")([L][R]|[T][B])(\"s*.*)");var orientation=this.dotString.match(regex)[2];if(orientation==="LR"){this.dotString=this.dotString.replace(regex,"$1TB$3")}else if(orientation==="TB"){this.dotString=this.dotString.replace(regex,"$1LR$3")}this.display().done(function(){result.resolveWith(_this5,[result])});return result.promise()}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdyYXBoQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiY29udGV4dCIsImRvbmUiLCJkYXRhIiwiZnJhZ21lbnRHcmFwaEN0cmwiLCJmcmFnbWVudEdyYXBoIiwicmVuZGVyX29sZCIsInNlbGVjdG9yIiwiY29tbWFuZCIsInNldHRpbmdzIiwicmVzdWx0IiwiJCIsIkRlZmVycmVkIiwic2V0dXAiLCJhbWlDb21tYW5kIiwiZXhlY3V0ZSIsImRvdFN0cmluZyIsImpzcGF0aCIsImRpY3QiLCJncmFwaCIsIlZpeiIsInJlcGxhY2UiLCJ4IiwianNvbiIsImpzb25iT2JqIiwiSlNPTiIsInBhcnNlIiwiaHRtbFRvVGV4dCIsImF0dHJzIiwidGV4dFRvSHRtbCIsInN0cmluZ2lmeSIsImpvaW4iLCJkb2MiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJzdmciLCJkb2N1bWVudEVsZW1lbnQiLCJmaW5kIiwiZWFjaCIsImkiLCJlbCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImF0dHIiLCJwcmVwZW5kVG8iLCJvdXRlckhUTUwiLCJyZXBsYWNlSFRNTCIsImNsaWNrIiwiZSIsInByZXZlbnREZWZhdWx0IiwiY3JlYXRlQ29udHJvbEZyb21XZWJMaW5rIiwiZ2V0UGFyZW50IiwiY3VycmVudFRhcmdldCIsImN0eCIsInJlc29sdmVXaXRoIiwiZmFpbCIsInJlamVjdFdpdGgiLCJwcm9taXNlIiwicmVuZGVyIiwiZGlzcGxheSIsInBhdGNoSWQiLCJjaGFuZ2UiLCJzd2l0Y2hPcmllbnRhdGlvbiIsInJlZ2V4IiwiUmVnRXhwIiwib3JpZW50YXRpb24iLCJtYXRjaCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7OztHQWdCQUEsU0FB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QjBDLEtBQXZCLENBQThCLFFBQTlCLENBQ2pCLENBSEQsSUFJSyxJQUFHRSxXQUFXLEdBQUssSUFBbkIsQ0FDTCxDQUNILEtBQUtqRCxTQUFMLENBQWlCLEtBQUtBLFNBQUwsQ0FBZUssT0FBZixDQUF1QjBDLEtBQXZCLENBQThCLFFBQTlCLENBQ2IsQ0FFTCxLQUFLSixPQUFMLEdBQWV6RCxJQUFmLENBQW9CLFVBQU0sQ0FDekJRLE1BQU0sQ0FBQzRDLFdBQVAsQ0FBbUIsTUFBbkIsQ0FBeUIsQ0FBQzVDLE1BQUQsQ0FBekIsQ0FDQSxDQUZELEVBSUEsTUFBT0EsQ0FBQUEsTUFBTSxDQUFDK0MsT0FBUCxFQUNKLENBbFBrQixDQUFkLENBQVQiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFNSSBXZWIgRnJhbWV3b3JrXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LVhYWFggVGhlIEFNSSBUZWFtIC8gTFBTQyAvIElOMlAzXG4gKlxuICogVGhpcyBmaWxlIG11c3QgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIENlQ0lMTC1DOlxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWVuLmh0bWxcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1mci5odG1sXG4gKlxuICpcbiAqIEBnbG9iYWwgVml6XG4gKlxuICovXG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4kQU1JQ2xhc3MoJ0dyYXBoQ3RybCcsIHtcblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkZXh0ZW5kczogYW1pLkNvbnRyb2wsXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkaW5pdDogZnVuY3Rpb24ocGFyZW50LCBvd25lcilcblx0e1xuXHRcdHRoaXMuJHN1cGVyLiRpbml0KHBhcmVudCwgb3duZXIpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0b25SZWFkeTogZnVuY3Rpb24oKVxuXHR7XG5cdFx0cmV0dXJuIGFtaVdlYkFwcC5sb2FkUmVzb3VyY2VzKFtcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2NvbnRyb2xzL0dyYXBoL3R3aWcvR3JhcGhDdHJsLnR3aWcnLFxuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvY29udHJvbHMvR3JhcGgvdHdpZy9ncmFwaC50d2lnJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2pzLzNyZC1wYXJ0eS92aXoubWluLmpzJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2Nzcy9hbWkubWluLmNzcycsXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jc3MvZm9udC1hd2Vzb21lLm1pbi5jc3MnLFxuXHRcdF0sIHtjb250ZXh0OiB0aGlzfSkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHR0aGlzLmZyYWdtZW50R3JhcGhDdHJsID0gZGF0YVswXTtcblx0XHRcdHRoaXMuZnJhZ21lbnRHcmFwaCA9IGRhdGFbMV07XG5cdFx0fSk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZW5kZXJfb2xkOiBmdW5jdGlvbihzZWxlY3RvciwgY29tbWFuZCwgc2V0dGluZ3MpXG5cdHtcblx0XHRjb25zdCByZXN1bHQgPSAkLkRlZmVycmVkKCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCBbY29udGV4dF0gPSBhbWlXZWJBcHAuc2V0dXAoWydjb250ZXh0J10sIFtyZXN1bHRdLCBzZXR0aW5ncyk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRhbWlDb21tYW5kLmV4ZWN1dGUoY29tbWFuZCkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHRjb25zdCBkb3RTdHJpbmcgPSBhbWlXZWJBcHAuanNwYXRoKCcuLnJvd3NldHsuQHR5cGU9PT1cImdyYXBoXCJ9LnJvdy5maWVsZHsuQG5hbWU9PT1cImRvdFwifS4kJywgZGF0YSlbMF0gfHwgJyc7XG5cblx0XHRcdGNvbnN0IGRpY3QgPSB7XG5cdFx0XHRcdGdyYXBoIDogdHlwZW9mIFZpeiAhPT0gJ3VuZGVmaW5lZCcgPyBWaXooZG90U3RyaW5nLCAnc3ZnJykgOiAnJyxcblx0XHRcdH07XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0LyogR1JBUEggUE9TVCBUUkVBVE1FTlQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0ZGljdC5ncmFwaCA9IGRpY3QuZ3JhcGgucmVwbGFjZSgveGxpbms6aHJlZj1cIihbXlwiXSopXCIvZywgKHgsIGpzb24pID0+IHtcblxuXHRcdFx0XHRjb25zdCBqc29uYk9iaiA9IEpTT04ucGFyc2UoYW1pV2ViQXBwLmh0bWxUb1RleHQoanNvbikpO1xuXG5cdFx0XHRcdGNvbnN0IGF0dHJzID0gW1xuXHRcdFx0XHRcdCdkYXRhLWN0cmw9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtY3RybCddKSArICdcIicsXG5cdFx0XHRcdFx0J2RhdGEtY3RybC1sb2NhdGlvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS1jdHJsLWxvY2F0aW9uJ10pICsgJ1wiJyxcblx0XHRcdFx0XHQnZGF0YS1wYXJhbXM9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoSlNPTi5zdHJpbmdpZnkoanNvbmJPYmpbJ2RhdGEtcGFyYW1zJ10pKSArICdcIicsXG5cdFx0XHRcdFx0J2RhdGEtc2V0dGluZ3M9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoSlNPTi5zdHJpbmdpZnkoanNvbmJPYmpbJ2RhdGEtc2V0dGluZ3MnXSkpICsgJ1wiJyxcblx0XHRcdFx0XHQnZGF0YS1pY29uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWljb24nXSkgKyAnXCInLFxuXHRcdFx0XHRcdCdkYXRhLXRpdGxlPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLXRpdGxlJ10pICsgJ1wiJyxcblx0XHRcdFx0XHQnZGF0YS10aXRsZS1pY29uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLXRpdGxlLWljb24nXSkgKyAnXCInLFxuXHRcdFx0XHRdO1xuXG5cdFx0XHRcdHJldHVybiAneGxpbms6aHJlZj1cIiNcIiAnICsgYXR0cnMuam9pbignICcpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRjb25zdCBkb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGRpY3QuZ3JhcGgsICdpbWFnZS9zdmcreG1sJyk7XG5cblx0XHRcdGNvbnN0IHN2ZyA9ICQoZG9jLmRvY3VtZW50RWxlbWVudCk7XG5cblx0XHRcdHN2Zy5maW5kKCdhW2RhdGEtdGl0bGUtaWNvbl0nKS5lYWNoKChpLCBlbCkgPT4ge1xuXG5cdFx0XHRcdCQoJzx0c3BhbiBmb250LWZhbWlseT1cIkZvbnRBd2Vzb21lXCI+JyArIFN0cmluZy5mcm9tQ2hhckNvZGUoJzB4JyArICQoZWwpLmF0dHIoJ2RhdGEtdGl0bGUtaWNvbicpKSArICc8L3RzcGFuPjx0c3Bhbj4gPC90c3Bhbj4nKS5wcmVwZW5kVG8oJChlbCkuZmluZCgndGV4dCcpKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRkaWN0LmdyYXBoID0gZG9jLmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUw7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0aGlzLnJlcGxhY2VIVE1MKHNlbGVjdG9yLCB0aGlzLmZyYWdtZW50R3JhcGhDdHJsLCB7ZGljdDogZGljdH0pLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdCQoc2VsZWN0b3IgKyAnIGFbZGF0YS1jdHJsXScpLmNsaWNrKChlKSA9PiB7XG5cblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0XHR0aGlzLmNyZWF0ZUNvbnRyb2xGcm9tV2ViTGluayh0aGlzLmdldFBhcmVudCgpLCBlLmN1cnJlbnRUYXJnZXQsIHRoaXMuY3R4KTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0cmVzdWx0LnJlc29sdmVXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cdFx0XHR9KTtcblxuXHRcdH0pLmZhaWwoKGRhdGEpID0+IHtcblxuXHRcdFx0cmVzdWx0LnJlamVjdFdpdGgoY29udGV4dCwgW2RhdGFdKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdHJldHVybiByZXN1bHQucHJvbWlzZSgpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb21tYW5kLCBzZXR0aW5ncylcbiAgICB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgW2NvbnRleHRdID0gYW1pV2ViQXBwLnNldHVwKFsnY29udGV4dCddLCBbcmVzdWx0XSwgc2V0dGluZ3MpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0YW1pQ29tbWFuZC5leGVjdXRlKGNvbW1hbmQpLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0dGhpcy5kb3RTdHJpbmcgPSBhbWlXZWJBcHAuanNwYXRoKCcuLnJvd3NldHsuQHR5cGU9PT1cImdyYXBoXCJ9LnJvdy5maWVsZHsuQG5hbWU9PT1cImRvdFwifS4kJywgZGF0YSlbMF0gfHwgJyc7XG5cblx0XHRcdHRoaXMucmVwbGFjZUhUTUwoc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRHcmFwaEN0cmwpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdHRoaXMuZGlzcGxheSgpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdFx0cmVzdWx0LnJlc29sdmVXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cdFx0fSk7XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdC5wcm9taXNlKCk7XG5cbiAgICB9LFxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgZGlzcGxheTogZnVuY3Rpb24oKVxuICAgIHtcbiAgICBcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICAgICBjb25zdCByZXN1bHQgPSAkLkRlZmVycmVkKCk7XG5cbiAgICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgZGljdCA9IHtcblx0XHRcdGdyYXBoIDogdHlwZW9mIFZpeiAhPT0gJ3VuZGVmaW5lZCcgPyBWaXoodGhpcy5kb3RTdHJpbmcsICdzdmcnKSA6ICcnLFxuXHRcdH07XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdFx0LyogR1JBUEggUE9TVCBUUkVBVE1FTlQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGRpY3QuZ3JhcGggPSBkaWN0LmdyYXBoLnJlcGxhY2UoL3hsaW5rOmhyZWY9XCIoW15cIl0qKVwiL2csICh4LCBqc29uKSA9PiB7XG5cblx0XHRcdGNvbnN0IGpzb25iT2JqID0gSlNPTi5wYXJzZShhbWlXZWJBcHAuaHRtbFRvVGV4dChqc29uKSk7XG5cblx0XHRcdGNvbnN0IGF0dHJzID0gW1xuXHRcdFx0XHQnZGF0YS1jdHJsPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWN0cmwnXSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS1jdHJsLWxvY2F0aW9uPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLWN0cmwtbG9jYXRpb24nXSkgKyAnXCInLFxuXHRcdFx0XHQnZGF0YS1wYXJhbXM9XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoSlNPTi5zdHJpbmdpZnkoanNvbmJPYmpbJ2RhdGEtcGFyYW1zJ10pKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLXNldHRpbmdzPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKEpTT04uc3RyaW5naWZ5KGpzb25iT2JqWydkYXRhLXNldHRpbmdzJ10pKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLWljb249XCInICsgYW1pV2ViQXBwLnRleHRUb0h0bWwoanNvbmJPYmpbJ2RhdGEtaWNvbiddKSArICdcIicsXG5cdFx0XHRcdCdkYXRhLXRpdGxlPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9IdG1sKGpzb25iT2JqWydkYXRhLXRpdGxlJ10pICsgJ1wiJyxcblx0XHRcdFx0J2RhdGEtdGl0bGUtaWNvbj1cIicgKyBhbWlXZWJBcHAudGV4dFRvSHRtbChqc29uYk9ialsnZGF0YS10aXRsZS1pY29uJ10pICsgJ1wiJyxcblx0XHRcdF07XG5cblx0XHRcdHJldHVybiAneGxpbms6aHJlZj1cIiNcIiAnICsgYXR0cnMuam9pbignICcpO1xuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCBkb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGRpY3QuZ3JhcGgsICdpbWFnZS9zdmcreG1sJyk7XG5cblx0XHRjb25zdCBzdmcgPSAkKGRvYy5kb2N1bWVudEVsZW1lbnQpO1xuXG5cdFx0c3ZnLmZpbmQoJ2FbZGF0YS10aXRsZS1pY29uXScpLmVhY2goKGksIGVsKSA9PiB7XG5cblx0XHRcdCQoJzx0c3BhbiBmb250LWZhbWlseT1cIkZvbnRBd2Vzb21lXCI+JyArIFN0cmluZy5mcm9tQ2hhckNvZGUoJzB4JyArICQoZWwpLmF0dHIoJ2RhdGEtdGl0bGUtaWNvbicpKSArICc8L3RzcGFuPjx0c3Bhbj4gPC90c3Bhbj4nKS5wcmVwZW5kVG8oJChlbCkuZmluZCgndGV4dCcpKTtcblx0XHR9KTtcblxuXHRcdGRpY3QuZ3JhcGggPSBkb2MuZG9jdW1lbnRFbGVtZW50Lm91dGVySFRNTDtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0dGhpcy5yZXBsYWNlSFRNTCh0aGlzLnBhdGNoSWQoJyNBMEY2NzYzRl9ERTI5XzUxODVfMzVDMV9EQ0FBODFFOEM0ODcnKSwgdGhpcy5mcmFnbWVudEdyYXBoLCB7ZGljdDogZGljdH0pLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHQkKHRoaXMucGF0Y2hJZCgnI0E4RTdDODhEXzdCNzhfQjIyMV8wQkNCXzZFRjFGOUNDM0MxNScpKS5jaGFuZ2UoKGUpID0+IHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0dGhpcy5zd2l0Y2hPcmllbnRhdGlvbigpO1xuXHRcdFx0fSk7XG5cblx0XHRcdCQoc2VsZWN0b3IgKyAnIGFbZGF0YS1jdHJsXScpLmNsaWNrKChlKSA9PiB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdHRoaXMuY3JlYXRlQ29udHJvbEZyb21XZWJMaW5rKHRoaXMuZ2V0UGFyZW50KCksIGUuY3VycmVudFRhcmdldCwgdGhpcy5jdHgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJlc3VsdC5yZXNvbHZlV2l0aCh0aGlzLCBbcmVzdWx0XSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gcmVzdWx0LnByb21pc2UoKTtcbiAgICB9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0c3dpdGNoT3JpZW50YXRpb246IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgIFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG4gICAgIFx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCcoLipcXHMqcmFua2Rpclxccyo9XFxzKlwiKShbTF1bUl18W1RdW0JdKShcIlxccyouKiknKTtcblxuICAgICBcdGNvbnN0IG9yaWVudGF0aW9uID0gdGhpcy5kb3RTdHJpbmcubWF0Y2gocmVnZXgpWzJdO1xuXG4gICAgIFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgIFx0aWYob3JpZW50YXRpb24gPT09ICdMUicgKVxuICAgICBcdHtcbiAgICAgXHRcdHRoaXMuZG90U3RyaW5nID0gdGhpcy5kb3RTdHJpbmcucmVwbGFjZShyZWdleCwgJyQxVEIkMycpO1xuICAgICBcdH1cbiAgICAgXHRlbHNlIGlmKG9yaWVudGF0aW9uID09PSAnVEInIClcbiAgICAgXHR7XG5cdFx0XHR0aGlzLmRvdFN0cmluZyA9IHRoaXMuZG90U3RyaW5nLnJlcGxhY2UocmVnZXgsICckMUxSJDMnKTtcbiAgICAgXHR9XG5cblx0XHR0aGlzLmRpc3BsYXkoKS5kb25lKCgpID0+IHtcblx0XHRcdHJlc3VsdC5yZXNvbHZlV2l0aCh0aGlzLCBbcmVzdWx0XSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gcmVzdWx0LnByb21pc2UoKTtcbiAgICB9XG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG59KTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovIl19
