/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 * @global FieldEditorCtrl_lock
 */

/*-------------------------------------------------------------------------*/
$AMIClass('UnitEditorCtrl', {
  /*---------------------------------------------------------------------*/
  $extends: ami.Control,

  /*---------------------------------------------------------------------*/
  $init: function $init(parent, owner) {
    this.$super.$init(parent, owner);
  },

  /*---------------------------------------------------------------------*/
  onReady: function onReady() {
    var _this = this;

    return amiWebApp.loadResources([amiWebApp.originURL + '/controls/UnitEditor/twig/UnitEditorCtrl.twig']).done(function (data) {
      _this.inEditMode = false;
      amiWebApp.appendHTML('body', data[0]).done(function () {
        var el1 = $('#CE77B2CF_A83B_854D_6B94_1A7A65555833');
        var el2 = $('#C9712C7B_9A5C_BD83_45D1_4CC52CD81DA9');
        el1.change(function () {
          switch (el1.find('option:selected').val()) {
            case '1000':
              el2.find('.positive').show();
              el2.find('.negative').show();
              break;

            case '1024':
              el2.find('.positive').show();
              el2.find('.negative').hide();
              break;

            default:
              el2.find('.positive').hide();
              el2.find('.negative').hide();
              break;
          }
        });
      });
    });
  },

  /*---------------------------------------------------------------------*/
  setup: function setup(selector) {
    var _this2 = this;

    this.el = $(selector);
    this.el.find('[data-unit-name]').each(function (index, item) {
      var el = $(item);
      /*-------------------------------------------------------------*/

      /* GET UNIT INFO                                               */

      /*-------------------------------------------------------------*/

      var unitVal = el.attr('data-val');
      var unitName = el.attr('data-unit-name');
      var unitFactor = el.attr('data-unit-factor');
      var unitBase = el.attr('data-unit-base');
      /*-------------------------------------------------------------*/

      /* OPTIMIZE UNIT INFO                                          */

      /*-------------------------------------------------------------*/

      var scale = 0.0;
      var base = parseFloat(unitBase);

      var rawVal = parseFloat(unitVal) * _this2.getFactorFlt(unitFactor, base);

      if (!Number.isNaN(rawVal)) {
        if (rawVal !== 0.0) {
          scale = Math.log(rawVal) / Math.log(base);
          /**/

          if (scale > 0.0) {
            scale = Math.ceil(scale - 1);
          } else if (scale < 0.0) {
            scale = Math.floor(scale - 0);
          }
        }
      } else {
        return;
      }
      /*-------------------------------------------------------------*/


      var factor = Math.pow(base, scale);
      el.attr('data-unit-val', (rawVal / factor).toPrecision(3));
      el.attr('data-unit-factor', _this2.getFactorStr(factor, base));
      /*-------------------------------------------------------------*/

      el.attr('data-raw-unit-val', rawVal);
      el.attr('data-raw-unit-name', unitName);
      el.attr('data-raw-unit-factor', "");
      el.attr('data-raw-unit-base', unitBase);
      /*-------------------------------------------------------------*/

      /* SETUP EDITOR AND UPDATE TEXT                                */

      /*-------------------------------------------------------------*/

      el.click(function () {
        if (!_this2.inEditMode) {
          _this2.editUnit(el);
        }
      });

      _this2.updateText(el);
      /*-------------------------------------------------------------*/

    });
  },

  /*---------------------------------------------------------------------*/
  isInEditMode: function isInEditMode() {
    return this.inEditMode();
  },

  /*---------------------------------------------------------------------*/
  setInEditMode: function setInEditMode(inEditMode) {
    if (inEditMode) {
      this.el.addClass('field-edit');
    } else {
      this.el.removeClass('field-edit');
    }

    this.inEditMode = inEditMode;
  },

  /*---------------------------------------------------------------------*/
  editUnit: function editUnit(el) {
    var _this3 = this;

    /*-----------------------------------------------------------------*/
    var rawUnitVal = el.attr('data-raw-unit-val');
    var rawUnitName = el.attr('data-raw-unit-name');
    var rawUnitFactor = el.attr('data-raw-unit-factor');
    var unitName = el.attr('data-unit-name');
    var unitFactor = el.attr('data-unit-factor');
    var unitBase = el.attr('data-unit-base');
    /*-----------------------------------------------------------------*/

    $('#DB6F1B3B_A1E1_474F_494D_B673367D6020').text('raw value: ' + rawUnitVal + ' ' + rawUnitFactor + rawUnitName);
    /*-----------------------------------------------------------------*/

    $('#B23EA96D_07CB_0D49_564A_8CBC446331F0').val(unitName);
    $('#C9712C7B_9A5C_BD83_45D1_4CC52CD81DA9').val(unitFactor);
    $('#CE77B2CF_A83B_854D_6B94_1A7A65555833').val(unitBase);

    if (el.attr('data-human-readable').replace(/^\s+|\s+$/g, '').toLowerCase() === 'false') {
      $('#D84D615F_8E4A_C9FB_18DD_D927B9CD68BD').prop('checked', false);
    } else {
      $('#D84D615F_8E4A_C9FB_18DD_D927B9CD68BD').prop('checked', true);
    }
    /*-----------------------------------------------------------------*/


    $('#B16DD66F_D5A1_BCDF_DB78_D375D7B208C5').off().on('submit', function (e) {
      e.preventDefault();

      _this3.apply(el);
    });
    /*-----------------------------------------------------------------*/

    $('#EEFEE4E6_2756_0FAC_6E1C_77F89E501417').modal('show');
    /*-----------------------------------------------------------------*/
  },

  /*---------------------------------------------------------------------*/
  apply: function apply(el) {
    /*-----------------------------------------------------------------*/
    var unitName = $('#B23EA96D_07CB_0D49_564A_8CBC446331F0').val();
    var unitFactor = $('#C9712C7B_9A5C_BD83_45D1_4CC52CD81DA9').val();
    var unitBase = $('#CE77B2CF_A83B_854D_6B94_1A7A65555833').val();
    /*-----------------------------------------------------------------*/

    el.attr('data-unit-name', unitName);
    el.attr('data-unit-factor', unitFactor);
    el.attr('data-unit-base', unitBase);

    if ($('#D84D615F_8E4A_C9FB_18DD_D927B9CD68BD').prop('checked')) {
      el.attr('data-human-readable', 'true');
    } else {
      el.attr('data-human-readable', 'false');
    }
    /*-----------------------------------------------------------------*/


    var newVal = parseFloat(el.attr('data-raw-unit-val')) / this.getFactorFlt(unitFactor, parseFloat(unitBase));
    el.attr('data-unit-val', newVal.toPrecision(3));
    this.updateText(el);
    /*-----------------------------------------------------------------*/

    $('#EEFEE4E6_2756_0FAC_6E1C_77F89E501417').modal('hide');
    /*-----------------------------------------------------------------*/
  },

  /*---------------------------------------------------------------------*/
  updateText: function updateText(el) {
    if (el.attr('data-human-readable').replace(/^\s+|\s+$/g, '').toLowerCase() === 'false') {
      el.text(el.attr('data-raw-unit-val') + ' ' + el.attr('data-raw-unit-factor') + el.attr('data-raw-unit-name'));
    } else {
      el.text(el.attr('data-unit-val') + ' ' + el.attr('data-unit-factor') + el.attr('data-unit-name'));
    }
  },

  /*---------------------------------------------------------------------*/
  factor2Unit_1000: {
    1.0e+24: 'Y',
    1.0e+21: 'Z',
    1.0e+18: 'E',
    1.0e+15: 'P',
    1.0e+12: 'T',
    1.0e+9: 'G',
    1.0e+6: 'M',
    1.0e+3: 'k',
    1.0: '',
    1.0e-3: 'm',
    1.0e-6: 'u',
    1.0e-9: 'n',
    1.0e-12: 'p',
    1.0e-15: 'f',
    1.0e-18: 'a',
    1.0e-21: 'z',
    1.0e-24: 'y'
  },
  factor2Unit_1024: {
    1208925819614629174706176.0: 'Y',
    1180591620717411303424.0: 'Z',
    1152921504606846976.0: 'E',
    1125899906842624.0: 'P',
    1099511627776.0: 'T',
    1073741824.0: 'G',
    1048576.0: 'M',
    1024.0: 'k',
    1.0: ''
  },

  /*---------------------------------------------------------------------*/
  getFactorStr: function getFactorStr(factor, base) {
    var result;
    /**/

    if (base === 1000.0) {
      result = this.factor2Unit_1000.hasOwnProperty(factor) ? this.factor2Unit_1000[factor] : '?';
    } else if (base == 1024.0) {
      result = this.factor2Unit_1024.hasOwnProperty(factor) ? this.factor2Unit_1024[factor] : '?';
    } else {
      result = '?';
    }

    return result;
  },

  /*---------------------------------------------------------------------*/
  unit2Factor_1000: {
    'Y': 1.0e+24,
    'Z': 1.0e+21,
    'E': 1.0e+18,
    'P': 1.0e+15,
    'T': 1.0e+12,
    'G': 1.0e+9,
    'M': 1.0e+6,
    'k': 1.0e+3,
    '': 1.0,
    'm': 1.0e-3,
    'u': 1.0e-6,
    'n': 1.0e-9,
    'p': 1.0e-12,
    'f': 1.0e-15,
    'a': 1.0e-18,
    'z': 1.0e-21,
    'y': 1.0e-24
  },
  unit2Factor_1024: {
    'Y': 1208925819614629174706176.0,
    'Z': 1180591620717411303424.0,
    'E': 1152921504606846976.0,
    'P': 1125899906842624.0,
    'T': 1099511627776.0,
    'G': 1073741824.0,
    'M': 1048576.0,
    'k': 1024.0,
    '': 1.0
  },

  /*---------------------------------------------------------------------*/
  getFactorFlt: function getFactorFlt(unit, base) {
    var result;
    /**/

    if (base === 1000.0) {
      result = this.unit2Factor_1000.hasOwnProperty(unit) ? this.unit2Factor_1000[unit] : 1.0;
    } else if (base == 1024.0) {
      result = this.unit2Factor_1024.hasOwnProperty(unit) ? this.unit2Factor_1024[unit] : 1.0;
    } else {
      result = 1.0;
    }

    return result;
  }
  /*---------------------------------------------------------------------*/

});
/*-------------------------------------------------------------------------*/
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVuaXRFZGl0b3JDdHJsLmVzNi5qcyJdLCJuYW1lcyI6WyIkQU1JQ2xhc3MiLCIkZXh0ZW5kcyIsImFtaSIsIkNvbnRyb2wiLCIkaW5pdCIsInBhcmVudCIsIm93bmVyIiwiJHN1cGVyIiwib25SZWFkeSIsImFtaVdlYkFwcCIsImxvYWRSZXNvdXJjZXMiLCJvcmlnaW5VUkwiLCJkb25lIiwiZGF0YSIsImluRWRpdE1vZGUiLCJhcHBlbmRIVE1MIiwiZWwxIiwiJCIsImVsMiIsImNoYW5nZSIsImZpbmQiLCJ2YWwiLCJzaG93IiwiaGlkZSIsInNldHVwIiwic2VsZWN0b3IiLCJlbCIsImVhY2giLCJpbmRleCIsIml0ZW0iLCJ1bml0VmFsIiwiYXR0ciIsInVuaXROYW1lIiwidW5pdEZhY3RvciIsInVuaXRCYXNlIiwic2NhbGUiLCJiYXNlIiwicGFyc2VGbG9hdCIsInJhd1ZhbCIsImdldEZhY3RvckZsdCIsIk51bWJlciIsImlzTmFOIiwiTWF0aCIsImxvZyIsImNlaWwiLCJmbG9vciIsImZhY3RvciIsInBvdyIsInRvUHJlY2lzaW9uIiwiZ2V0RmFjdG9yU3RyIiwiY2xpY2siLCJlZGl0VW5pdCIsInVwZGF0ZVRleHQiLCJpc0luRWRpdE1vZGUiLCJzZXRJbkVkaXRNb2RlIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInJhd1VuaXRWYWwiLCJyYXdVbml0TmFtZSIsInJhd1VuaXRGYWN0b3IiLCJ0ZXh0IiwicmVwbGFjZSIsInRvTG93ZXJDYXNlIiwicHJvcCIsIm9mZiIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiYXBwbHkiLCJtb2RhbCIsIm5ld1ZhbCIsImZhY3RvcjJVbml0XzEwMDAiLCJmYWN0b3IyVW5pdF8xMDI0IiwicmVzdWx0IiwiaGFzT3duUHJvcGVydHkiLCJ1bml0MkZhY3Rvcl8xMDAwIiwidW5pdDJGYWN0b3JfMTAyNCIsInVuaXQiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7QUFZQTtBQUVBQSxTQUFTLENBQUMsZ0JB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UUFBSTtBQVRhLEdBdlZTOztBQW1XM0I7QUFFQXJDLEVBQUFBLFlBQVksRUFBRSxzQkFBU3NDLElBQVQsRUFBZXpDLElBQWYsRUFDZDtBQUNDLFFBQUlxQyxNQUFKO0FBRUE7O0FBQUssUUFBR3JDLElBQUksS0FBSyxNQUFaLEVBQW9CO0FBQ3hCcUMsTUFBQUEsTUFBTSxHQUFHLEtBQUtFLGdCQUFMLENBQXNCRCxjQUF0QixDQUFxQ0csSUFBckMsSUFBNkMsS0FBS0YsZ0JBQUwsQ0FBc0JFLElBQXRCLENBQTdDLEdBQTJFLEdBQXBGO0FBQ0EsS0FGSSxNQUdBLElBQUd6QyxJQUFJLElBQUksTUFBWCxFQUFtQjtBQUN2QnFDLE1BQUFBLE1BQU0sR0FBRyxLQUFLRyxnQkFBTCxDQUFzQkYsY0FBdEIsQ0FBcUNHLElBQXJDLElBQTZDLEtBQUtELGdCQUFMLENBQXNCQyxJQUF0QixDQUE3QyxHQUEyRSxHQUFwRjtBQUNBLEtBRkksTUFHQTtBQUNKSixNQUFBQSxNQUFNLEdBQUcsR0FBVDtBQUNBOztBQUVELFdBQU9BLE1BQVA7QUFDQTtBQUVEOztBQXRYMkIsQ0FBbkIsQ0FBVDtBQXlYQSIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQU1JIFdlYiBGcmFtZXdvcmtcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtWFhYWCBUaGUgQU1JIFRlYW0gLyBMUFNDIC8gSU4yUDNcbiAqXG4gKiBUaGlzIGZpbGUgbXVzdCBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgQ2VDSUxMLUM6XG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZW4uaHRtbFxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWZyLmh0bWxcbiAqXG4gKiBAZ2xvYmFsIEZpZWxkRWRpdG9yQ3RybF9sb2NrXG4gKi9cblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdVbml0RWRpdG9yQ3RybCcsIHtcblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdCRleHRlbmRzOiBhbWkuQ29udHJvbCxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGluaXQ6IGZ1bmN0aW9uKHBhcmVudCwgb3duZXIpXG5cdHtcblx0XHR0aGlzLiRzdXBlci4kaW5pdChwYXJlbnQsIG93bmVyKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0b25SZWFkeTogZnVuY3Rpb24oKVxuXHR7XG5cdFx0cmV0dXJuIGFtaVdlYkFwcC5sb2FkUmVzb3VyY2VzKFtcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2NvbnRyb2xzL1VuaXRFZGl0b3IvdHdpZy9Vbml0RWRpdG9yQ3RybC50d2lnJyxcblx0XHRdKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdHRoaXMuaW5FZGl0TW9kZSA9IGZhbHNlO1xuXG5cdFx0XHRhbWlXZWJBcHAuYXBwZW5kSFRNTCgnYm9keScsIGRhdGFbMF0pLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdGNvbnN0IGVsMSA9ICQoJyNDRTc3QjJDRl9BODNCXzg1NERfNkI5NF8xQTdBNjU1NTU4MzMnKTtcblx0XHRcdFx0Y29uc3QgZWwyID0gJCgnI0M5NzEyQzdCXzlBNUNfQkQ4M180NUQxXzRDQzUyQ0Q4MURBOScpO1xuXG5cdFx0XHRcdGVsMS5jaGFuZ2UoKCkgPT4ge1xuXG5cdFx0XHRcdFx0c3dpdGNoKGVsMS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS52YWwoKSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRjYXNlICcxMDAwJzpcblx0XHRcdFx0XHRcdFx0ZWwyLmZpbmQoJy5wb3NpdGl2ZScpLnNob3coKTtcblx0XHRcdFx0XHRcdFx0ZWwyLmZpbmQoJy5uZWdhdGl2ZScpLnNob3coKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdGNhc2UgJzEwMjQnOlxuXHRcdFx0XHRcdFx0XHRlbDIuZmluZCgnLnBvc2l0aXZlJykuc2hvdygpO1xuXHRcdFx0XHRcdFx0XHRlbDIuZmluZCgnLm5lZ2F0aXZlJykuaGlkZSgpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0ZWwyLmZpbmQoJy5wb3NpdGl2ZScpLmhpZGUoKTtcblx0XHRcdFx0XHRcdFx0ZWwyLmZpbmQoJy5uZWdhdGl2ZScpLmhpZGUoKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRzZXR1cDogZnVuY3Rpb24oc2VsZWN0b3IpXG5cdHtcblx0XHR0aGlzLmVsID0gJChzZWxlY3Rvcik7XG5cblx0XHR0aGlzLmVsLmZpbmQoJ1tkYXRhLXVuaXQtbmFtZV0nKS5lYWNoKChpbmRleCwgaXRlbSkgPT4ge1xuXG5cdFx0XHRjb25zdCBlbCA9ICQoaXRlbSk7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdFx0XHQvKiBHRVQgVU5JVCBJTkZPICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0Y29uc3QgdW5pdFZhbCA9IGVsLmF0dHIoJ2RhdGEtdmFsJyk7XG5cdFx0XHRjb25zdCB1bml0TmFtZSA9IGVsLmF0dHIoJ2RhdGEtdW5pdC1uYW1lJyk7XG5cdFx0XHRjb25zdCB1bml0RmFjdG9yID0gZWwuYXR0cignZGF0YS11bml0LWZhY3RvcicpO1xuXHRcdFx0Y29uc3QgdW5pdEJhc2UgPSBlbC5hdHRyKCdkYXRhLXVuaXQtYmFzZScpO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0LyogT1BUSU1JWkUgVU5JVCBJTkZPICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGxldCBzY2FsZSA9IDAuMDtcblxuXHRcdFx0Y29uc3QgYmFzZSA9IHBhcnNlRmxvYXQodW5pdEJhc2UpO1xuXG5cdFx0XHRjb25zdCByYXdWYWwgPSBwYXJzZUZsb2F0KHVuaXRWYWwpICogdGhpcy5nZXRGYWN0b3JGbHQodW5pdEZhY3RvciwgYmFzZSk7XG5cblx0XHRcdGlmKCFOdW1iZXIuaXNOYU4ocmF3VmFsKSlcblx0XHRcdHtcblx0XHRcdFx0aWYocmF3VmFsICE9PSAwLjApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRzY2FsZSA9IE1hdGgubG9nKHJhd1ZhbCkgLyBNYXRoLmxvZyhiYXNlKTtcblxuXHRcdFx0XHRcdC8qKi8gaWYoc2NhbGUgPiAwLjApIHtcblx0XHRcdFx0XHRcdHNjYWxlID0gTWF0aC5jZWlsKHNjYWxlIC0gMSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYoc2NhbGUgPCAwLjApIHtcblx0XHRcdFx0XHRcdHNjYWxlID0gTWF0aC5mbG9vcihzY2FsZSAtIDApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGNvbnN0IGZhY3RvciA9IE1hdGgucG93KGJhc2UsIHNjYWxlKTtcblxuXHRcdFx0ZWwuYXR0cignZGF0YS11bml0LXZhbCcsIChyYXdWYWwgLyBmYWN0b3IpLnRvUHJlY2lzaW9uKDMpKTtcblxuXHRcdFx0ZWwuYXR0cignZGF0YS11bml0LWZhY3RvcicsIHRoaXMuZ2V0RmFjdG9yU3RyKGZhY3RvciwgYmFzZSkpO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRlbC5hdHRyKCdkYXRhLXJhdy11bml0LXZhbCcsIHJhd1ZhbCk7XG5cdFx0XHRlbC5hdHRyKCdkYXRhLXJhdy11bml0LW5hbWUnLCB1bml0TmFtZSk7XG5cdFx0XHRlbC5hdHRyKCdkYXRhLXJhdy11bml0LWZhY3RvcicsICgoKFwiXCIpKSkpO1xuXHRcdFx0ZWwuYXR0cignZGF0YS1yYXctdW5pdC1iYXNlJywgdW5pdEJhc2UpO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0LyogU0VUVVAgRURJVE9SIEFORCBVUERBVEUgVEVYVCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGVsLmNsaWNrKCgpID0+IHtcblxuXHRcdFx0XHRpZighdGhpcy5pbkVkaXRNb2RlKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhpcy5lZGl0VW5pdChlbCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnVwZGF0ZVRleHQoZWwpO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRpc0luRWRpdE1vZGU6IGZ1bmN0aW9uKClcblx0e1xuXHRcdHJldHVybiB0aGlzLmluRWRpdE1vZGUoKTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0c2V0SW5FZGl0TW9kZTogZnVuY3Rpb24oaW5FZGl0TW9kZSlcblx0e1xuXHRcdGlmKGluRWRpdE1vZGUpIHtcblx0XHRcdHRoaXMuZWwuYWRkQ2xhc3MoJ2ZpZWxkLWVkaXQnKTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHR0aGlzLmVsLnJlbW92ZUNsYXNzKCdmaWVsZC1lZGl0Jyk7XG5cdFx0fVxuXG5cdFx0dGhpcy5pbkVkaXRNb2RlID0gaW5FZGl0TW9kZTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0ZWRpdFVuaXQ6IGZ1bmN0aW9uKGVsKVxuXHR7XG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCByYXdVbml0VmFsID0gZWwuYXR0cignZGF0YS1yYXctdW5pdC12YWwnKTtcblx0XHRjb25zdCByYXdVbml0TmFtZSA9IGVsLmF0dHIoJ2RhdGEtcmF3LXVuaXQtbmFtZScpO1xuXHRcdGNvbnN0IHJhd1VuaXRGYWN0b3IgPSBlbC5hdHRyKCdkYXRhLXJhdy11bml0LWZhY3RvcicpO1xuXG5cdFx0Y29uc3QgdW5pdE5hbWUgPSBlbC5hdHRyKCdkYXRhLXVuaXQtbmFtZScpO1xuXHRcdGNvbnN0IHVuaXRGYWN0b3IgPSBlbC5hdHRyKCdkYXRhLXVuaXQtZmFjdG9yJyk7XG5cdFx0Y29uc3QgdW5pdEJhc2UgPSBlbC5hdHRyKCdkYXRhLXVuaXQtYmFzZScpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHQkKCcjREI2RjFCM0JfQTFFMV80NzRGXzQ5NERfQjY3MzM2N0Q2MDIwJykudGV4dCgncmF3IHZhbHVlOiAnICsgcmF3VW5pdFZhbCArICcgJyArIHJhd1VuaXRGYWN0b3IgKyByYXdVbml0TmFtZSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCQoJyNCMjNFQTk2RF8wN0NCXzBENDlfNTY0QV84Q0JDNDQ2MzMxRjAnKS52YWwodW5pdE5hbWUpO1xuXHRcdCQoJyNDOTcxMkM3Ql85QTVDX0JEODNfNDVEMV80Q0M1MkNEODFEQTknKS52YWwodW5pdEZhY3Rvcik7XG5cdFx0JCgnI0NFNzdCMkNGX0E4M0JfODU0RF82Qjk0XzFBN0E2NTU1NTgzMycpLnZhbCh1bml0QmFzZSk7XG5cblx0XHRpZihlbC5hdHRyKCdkYXRhLWh1bWFuLXJlYWRhYmxlJykucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpLnRvTG93ZXJDYXNlKCkgPT09ICdmYWxzZScpXG5cdFx0e1xuXHRcdFx0JCgnI0Q4NEQ2MTVGXzhFNEFfQzlGQl8xOEREX0Q5MjdCOUNENjhCRCcpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHQkKCcjRDg0RDYxNUZfOEU0QV9DOUZCXzE4RERfRDkyN0I5Q0Q2OEJEJykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuXHRcdH1cblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0JCgnI0IxNkRENjZGX0Q1QTFfQkNERl9EQjc4X0QzNzVEN0IyMDhDNScpLm9mZigpLm9uKCdzdWJtaXQnLCAoZSkgPT4ge1xuXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdHRoaXMuYXBwbHkoZWwpO1xuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHQkKCcjRUVGRUU0RTZfMjc1Nl8wRkFDXzZFMUNfNzdGODlFNTAxNDE3JykubW9kYWwoJ3Nob3cnKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRhcHBseTogZnVuY3Rpb24oZWwpXG5cdHtcblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IHVuaXROYW1lID0gJCgnI0IyM0VBOTZEXzA3Q0JfMEQ0OV81NjRBXzhDQkM0NDYzMzFGMCcpLnZhbCgpO1xuXHRcdGNvbnN0IHVuaXRGYWN0b3IgPSAkKCcjQzk3MTJDN0JfOUE1Q19CRDgzXzQ1RDFfNENDNTJDRDgxREE5JykudmFsKCk7XG5cdFx0Y29uc3QgdW5pdEJhc2UgPSAkKCcjQ0U3N0IyQ0ZfQTgzQl84NTREXzZCOTRfMUE3QTY1NTU1ODMzJykudmFsKCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGVsLmF0dHIoJ2RhdGEtdW5pdC1uYW1lJywgdW5pdE5hbWUpO1xuXHRcdGVsLmF0dHIoJ2RhdGEtdW5pdC1mYWN0b3InLCB1bml0RmFjdG9yKTtcblx0XHRlbC5hdHRyKCdkYXRhLXVuaXQtYmFzZScsIHVuaXRCYXNlKTtcblxuXHRcdGlmKCQoJyNEODRENjE1Rl84RTRBX0M5RkJfMThERF9EOTI3QjlDRDY4QkQnKS5wcm9wKCdjaGVja2VkJykpXG5cdFx0e1xuXHRcdFx0ZWwuYXR0cignZGF0YS1odW1hbi1yZWFkYWJsZScsICd0cnVlJyk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHRlbC5hdHRyKCdkYXRhLWh1bWFuLXJlYWRhYmxlJywgJ2ZhbHNlJyk7XG5cdFx0fVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCBuZXdWYWwgPSBwYXJzZUZsb2F0KGVsLmF0dHIoJ2RhdGEtcmF3LXVuaXQtdmFsJykpIC8gdGhpcy5nZXRGYWN0b3JGbHQodW5pdEZhY3RvciwgcGFyc2VGbG9hdCh1bml0QmFzZSkpO1xuXG5cdFx0ZWwuYXR0cignZGF0YS11bml0LXZhbCcsIG5ld1ZhbC50b1ByZWNpc2lvbigzKSk7XG5cblx0XHR0aGlzLnVwZGF0ZVRleHQoZWwpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHQkKCcjRUVGRUU0RTZfMjc1Nl8wRkFDXzZFMUNfNzdGODlFNTAxNDE3JykubW9kYWwoJ2hpZGUnKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHR1cGRhdGVUZXh0OiBmdW5jdGlvbihlbClcblx0e1xuXHRcdGlmKGVsLmF0dHIoJ2RhdGEtaHVtYW4tcmVhZGFibGUnKS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJykudG9Mb3dlckNhc2UoKSA9PT0gJ2ZhbHNlJylcblx0XHR7XG5cdFx0XHRlbC50ZXh0KFxuXHRcdFx0XHRlbC5hdHRyKCdkYXRhLXJhdy11bml0LXZhbCcpXG5cdFx0XHRcdCsgJyAnICtcblx0XHRcdFx0ZWwuYXR0cignZGF0YS1yYXctdW5pdC1mYWN0b3InKVxuXHRcdFx0XHQrXG5cdFx0XHRcdGVsLmF0dHIoJ2RhdGEtcmF3LXVuaXQtbmFtZScpXG5cdFx0XHQpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0ZWwudGV4dChcblx0XHRcdFx0ZWwuYXR0cignZGF0YS11bml0LXZhbCcpXG5cdFx0XHRcdCsgJyAnICtcblx0XHRcdFx0ZWwuYXR0cignZGF0YS11bml0LWZhY3RvcicpXG5cdFx0XHRcdCtcblx0XHRcdFx0ZWwuYXR0cignZGF0YS11bml0LW5hbWUnKVxuXHRcdFx0KTtcblx0XHR9XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdGZhY3RvcjJVbml0XzEwMDA6IHtcblx0XHQxLjBlKzI0OiAnWScsXG5cdFx0MS4wZSsyMTogJ1onLFxuXHRcdDEuMGUrMTg6ICdFJyxcblx0XHQxLjBlKzE1OiAnUCcsXG5cdFx0MS4wZSsxMjogJ1QnLFxuXHRcdDEuMGUrOTogJ0cnLFxuXHRcdDEuMGUrNjogJ00nLFxuXHRcdDEuMGUrMzogJ2snLFxuXHRcdDEuMDogJycsXG5cdFx0MS4wZS0zOiAnbScsXG5cdFx0MS4wZS02OiAndScsXG5cdFx0MS4wZS05OiAnbicsXG5cdFx0MS4wZS0xMjogJ3AnLFxuXHRcdDEuMGUtMTU6ICdmJyxcblx0XHQxLjBlLTE4OiAnYScsXG5cdFx0MS4wZS0yMTogJ3onLFxuXHRcdDEuMGUtMjQ6ICd5Jyxcblx0fSxcblxuXHRmYWN0b3IyVW5pdF8xMDI0OiB7XG5cdFx0MTIwODkyNTgxOTYxNDYyOTE3NDcwNjE3Ni4wOiAnWScsXG5cdFx0MTE4MDU5MTYyMDcxNzQxMTMwMzQyNC4wOiAnWicsXG5cdFx0MTE1MjkyMTUwNDYwNjg0Njk3Ni4wOiAnRScsXG5cdFx0MTEyNTg5OTkwNjg0MjYyNC4wOiAnUCcsXG5cdFx0MTA5OTUxMTYyNzc3Ni4wOiAnVCcsXG5cdFx0MTA3Mzc0MTgyNC4wOiAnRycsXG5cdFx0MTA0ODU3Ni4wOiAnTScsXG5cdFx0MTAyNC4wOiAnaycsXG5cdFx0MS4wOiAnJyxcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0Z2V0RmFjdG9yU3RyOiBmdW5jdGlvbihmYWN0b3IsIGJhc2UpXG5cdHtcblx0XHRsZXQgcmVzdWx0O1xuXG5cdFx0LyoqLyBpZihiYXNlID09PSAxMDAwLjApIHtcblx0XHRcdHJlc3VsdCA9IHRoaXMuZmFjdG9yMlVuaXRfMTAwMC5oYXNPd25Qcm9wZXJ0eShmYWN0b3IpID8gdGhpcy5mYWN0b3IyVW5pdF8xMDAwW2ZhY3Rvcl0gOiAnPyc7XG5cdFx0fVxuXHRcdGVsc2UgaWYoYmFzZSA9PSAxMDI0LjApIHtcblx0XHRcdHJlc3VsdCA9IHRoaXMuZmFjdG9yMlVuaXRfMTAyNC5oYXNPd25Qcm9wZXJ0eShmYWN0b3IpID8gdGhpcy5mYWN0b3IyVW5pdF8xMDI0W2ZhY3Rvcl0gOiAnPyc7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0cmVzdWx0ID0gJz8nO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHVuaXQyRmFjdG9yXzEwMDA6IHtcblx0XHQnWSc6IDEuMGUrMjQsXG5cdFx0J1onOiAxLjBlKzIxLFxuXHRcdCdFJzogMS4wZSsxOCxcblx0XHQnUCc6IDEuMGUrMTUsXG5cdFx0J1QnOiAxLjBlKzEyLFxuXHRcdCdHJzogMS4wZSs5LFxuXHRcdCdNJzogMS4wZSs2LFxuXHRcdCdrJzogMS4wZSszLFxuXHRcdCcnOiAxLjAsXG5cdFx0J20nOiAxLjBlLTMsXG5cdFx0J3UnOiAxLjBlLTYsXG5cdFx0J24nOiAxLjBlLTksXG5cdFx0J3AnOiAxLjBlLTEyLFxuXHRcdCdmJzogMS4wZS0xNSxcblx0XHQnYSc6IDEuMGUtMTgsXG5cdFx0J3onOiAxLjBlLTIxLFxuXHRcdCd5JzogMS4wZS0yNCxcblx0fSxcblxuXHR1bml0MkZhY3Rvcl8xMDI0OiB7XG5cdFx0J1knOiAxMjA4OTI1ODE5NjE0NjI5MTc0NzA2MTc2LjAsXG5cdFx0J1onOiAxMTgwNTkxNjIwNzE3NDExMzAzNDI0LjAsXG5cdFx0J0UnOiAxMTUyOTIxNTA0NjA2ODQ2OTc2LjAsXG5cdFx0J1AnOiAxMTI1ODk5OTA2ODQyNjI0LjAsXG5cdFx0J1QnOiAxMDk5NTExNjI3Nzc2LjAsXG5cdFx0J0cnOiAxMDczNzQxODI0LjAsXG5cdFx0J00nOiAxMDQ4NTc2LjAsXG5cdFx0J2snOiAxMDI0LjAsXG5cdFx0Jyc6IDEuMCxcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0Z2V0RmFjdG9yRmx0OiBmdW5jdGlvbih1bml0LCBiYXNlKVxuXHR7XG5cdFx0bGV0IHJlc3VsdDtcblxuXHRcdC8qKi8gaWYoYmFzZSA9PT0gMTAwMC4wKSB7XG5cdFx0XHRyZXN1bHQgPSB0aGlzLnVuaXQyRmFjdG9yXzEwMDAuaGFzT3duUHJvcGVydHkodW5pdCkgPyB0aGlzLnVuaXQyRmFjdG9yXzEwMDBbdW5pdF0gOiAxLjA7XG5cdFx0fVxuXHRcdGVsc2UgaWYoYmFzZSA9PSAxMDI0LjApIHtcblx0XHRcdHJlc3VsdCA9IHRoaXMudW5pdDJGYWN0b3JfMTAyNC5oYXNPd25Qcm9wZXJ0eSh1bml0KSA/IHRoaXMudW5pdDJGYWN0b3JfMTAyNFt1bml0XSA6IDEuMDtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRyZXN1bHQgPSAxLjA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG59KTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiJdfQ==
