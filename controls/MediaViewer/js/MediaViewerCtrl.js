/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / CNRS
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 */$AMIClass("MediaViewerCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/MediaViewer/twig/MediaViewerCtrl.twig"]).done(function(data){_this.fragmentMediaViewerCtrl=data[0]})},render:function render(selector,catalog,entity,primaryFieldName,primaryFieldValue,field,base64,mime,settings){var result=$.Deferred();this.ctx={catalog:catalog,entity:entity,primaryFieldName:primaryFieldName,primaryFieldValue:primaryFieldValue,field:field,base64:base64,mime:mime};var _amiWebApp$setup=amiWebApp.setup(["context","card"],[result,false],settings);this.ctx.context=_amiWebApp$setup[0];this.ctx.card=_amiWebApp$setup[1];this._render(result,selector);return result},_render:function _render(result,selector){var _this2=this;if(this.getParent().$name!=="TabCtrl"){var tab=new this.tabCtor(null,this);tab.render(selector,this.ctx).done(function(){tab.appendItem("<i class=\"fa fa-arrows-alt\"></i> "+_this2.ctx.entity,{closable:false}).done(function(selector){_this2.setParent(tab);_this2.__render(result,selector)})})}else{this.__render(result,selector)}},__render:function __render(result,selector){var _this3=this;var dict={field:this.ctx.field,mime:this.ctx.mime};this.replaceHTML(selector,this.fragmentMediaViewerCtrl,{dict:dict}).done(function(){_this3.refresh().done(function(data){result.resolveWith(_this3.ctx.context,[data])}).fail(function(message){result.rejectWith(_this3.ctx.context,[message])})})},refresh:function refresh(settings){var _this4=this;var result=$.Deferred();var _amiWebApp$setup2=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup2[0];var command="SearchQuery -catalog=\""+amiWebApp.textToString(this.ctx.catalog)+"\" -entity=\""+amiWebApp.textToString(this.ctx.entity)+"\" -sql=\"SELECT `"+amiWebApp.textToString(this.ctx.field)+"` FROM `"+amiWebApp.textToString(this.ctx.entity)+"` WHERE `"+amiWebApp.textToString(this.ctx.primaryFieldName)+"` = '"+amiWebApp.textToString(this.ctx.primaryFieldValue)+"'\"";amiCommand.execute(command).done(function(data){var text=amiWebApp.jspath("..field.$",data)[0]||"";if(_this4.ctx.mime.startsWith("image/")){$("<img />").attr({alt:_this4.ctx.field,src:"data:"+_this4.ctx.mime+";base64,"+text,height:"auto",width:"800"}).appendTo(_this4.patchId("#D25C9390_A722_9C48_BC81_5C8875CAAC95"))}else{$("<object />").attr({type:_this4.ctx.mime,data:"data:"+_this4.ctx.mime+";base64,"+text,height:"600",width:"800"}).appendTo(_this4.patchId("#D25C9390_A722_9C48_BC81_5C8875CAAC95"))}result.resolveWith(context,[data])}).fail(function(data,message){result.rejectWith(context,[message])});return result}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1lZGlhVmlld2VyQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiZG9uZSIsImRhdGEiLCJmcmFnbWVudE1lZGlhVmlld2VyQ3RybCIsInJlbmRlciIsInNlbGVjdG9yIiwiY2F0YWxvZyIsImVudGl0eSIsInByaW1hcnlGaWVsZE5hbWUiLCJwcmltYXJ5RmllbGRWYWx1ZSIsImZpZWxkIiwiYmFzZTY0IiwibWltZSIsInNldHRpbmdzIiwicmVzdWx0IiwiJCIsIkRlZmVycmVkIiwiY3R4Iiwic2V0dXAiLCJjb250ZXh0IiwiY2FyZCIsIl9yZW5kZXIiLCJnZXRQYXJlbnQiLCIkbmFtZSIsInRhYiIsInRhYkN0b3IiLCJhcHBlbmRJdGVtIiwiY2xvc2FibGUiLCJzZXRQYXJlbnQiLCJfX3JlbmRlciIsImRpY3QiLCJyZXBsYWNlSFRNTCIsInJlZnJlc2giLCJyZXNvbHZlV2l0aCIsImZhaWwiLCJtZXNzYWdlIiwicmVqZWN0V2l0aCIsImNvbW1hbmQiLCJ0ZXh0VG9TdHJpbmciLCJhbWlDb21tYW5kIiwiZXhlY3V0ZSIsInRleHQiLCJqc3BhdGgiLCJzdGFydHNXaXRoIiwiYXR0ciIsImFsdCIsInNyYyIsImhlaWdodCIsIndpZHRoIiwiYXBwZW5kVG8iLCJwYXRjaElkIiwidHlwZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztHQWFBQSxTQUFTLENBQUMsaUJBQUQsQ0FBb0IsQ0FHNUJDLFFBQVEsQ0FBRUMsR0FBRyxDQUFDQyxPQUhjLENBTzVCQyxLQUFLLENBQUUsZUFBU0MsTUFBVCxDQUFpQkMsS0FBakIsQ0FDUCxDQUNDLEtBQUtDLE1BQUwsQ0FBWUgsS0FBWixDQUFrQkMsTUFBbEIsQ0FBMEJDLEtBQTFCLENBQ0EsQ0FWMkIsQ0Fj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QixDQUFBQSxNQUNQLENBekwyQixDQUFwQixDQUFUIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBTUkgV2ViIEZyYW1ld29ya1xuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNC1YWFhYIFRoZSBBTUkgVGVhbSAvIExQU0MgLyBDTlJTXG4gKlxuICogVGhpcyBmaWxlIG11c3QgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIENlQ0lMTC1DOlxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWVuLmh0bWxcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1mci5odG1sXG4gKlxuICovXG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4kQU1JQ2xhc3MoJ01lZGlhVmlld2VyQ3RybCcsIHtcblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkZXh0ZW5kczogYW1pLkNvbnRyb2wsXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkaW5pdDogZnVuY3Rpb24ocGFyZW50LCBvd25lcilcblx0e1xuXHRcdHRoaXMuJHN1cGVyLiRpbml0KHBhcmVudCwgb3duZXIpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0b25SZWFkeTogZnVuY3Rpb24oKVxuXHR7XG5cdFx0cmV0dXJuIGFtaVdlYkFwcC5sb2FkUmVzb3VyY2VzKFtcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL2NvbnRyb2xzL01lZGlhVmlld2VyL3R3aWcvTWVkaWFWaWV3ZXJDdHJsLnR3aWcnLFxuXHRcdF0pLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0dGhpcy5mcmFnbWVudE1lZGlhVmlld2VyQ3RybCA9IGRhdGFbMF07XG5cdFx0fSk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZW5kZXI6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjYXRhbG9nLCBlbnRpdHksIHByaW1hcnlGaWVsZE5hbWUsIHByaW1hcnlGaWVsZFZhbHVlLCBmaWVsZCwgYmFzZTY0LCBtaW1lLCBzZXR0aW5ncylcblx0e1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdHRoaXMuY3R4ID0ge1xuXHRcdFx0Y2F0YWxvZzogY2F0YWxvZyxcblx0XHRcdGVudGl0eTogZW50aXR5LFxuXHRcdFx0cHJpbWFyeUZpZWxkTmFtZTogcHJpbWFyeUZpZWxkTmFtZSxcblx0XHRcdHByaW1hcnlGaWVsZFZhbHVlOiBwcmltYXJ5RmllbGRWYWx1ZSxcblx0XHRcdGZpZWxkOiBmaWVsZCxcblx0XHRcdGJhc2U2NDogYmFzZTY0LFxuXHRcdFx0bWltZTogbWltZSxcblx0XHR9O1xuXG5cdFx0W1xuXHRcdFx0dGhpcy5jdHguY29udGV4dCxcblx0XHRcdHRoaXMuY3R4LmNhcmRcblx0XHRdID0gYW1pV2ViQXBwLnNldHVwKFxuXHRcdFx0W1xuXHRcdFx0XHQnY29udGV4dCcsXG5cdFx0XHRcdCdjYXJkJyxcblx0XHRcdF0sXG5cdFx0XHRbXG5cdFx0XHRcdHJlc3VsdCxcblx0XHRcdFx0ZmFsc2UsXG5cdFx0XHRdLFxuXHRcdFx0c2V0dGluZ3Ncblx0XHQpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0dGhpcy5fcmVuZGVyKHJlc3VsdCwgc2VsZWN0b3IpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdF9yZW5kZXI6IGZ1bmN0aW9uKHJlc3VsdCwgc2VsZWN0b3IpXG5cdHtcblx0XHRpZih0aGlzLmdldFBhcmVudCgpLiRuYW1lICE9PSAnVGFiQ3RybCcpXG5cdFx0e1xuXHRcdFx0Y29uc3QgdGFiID0gbmV3IHRoaXMudGFiQ3RvcihudWxsLCB0aGlzKTtcblxuXHRcdFx0dGFiLnJlbmRlcihzZWxlY3RvciwgdGhpcy5jdHgpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdHRhYi5hcHBlbmRJdGVtKCc8aSBjbGFzcz1cImZhIGZhLWFycm93cy1hbHRcIj48L2k+ICcgKyB0aGlzLmN0eC5lbnRpdHksIHtjbG9zYWJsZTogZmFsc2V9KS5kb25lKChzZWxlY3RvcikgPT4ge1xuXG5cdFx0XHRcdFx0dGhpcy5zZXRQYXJlbnQodGFiKTtcblxuXHRcdFx0XHRcdHRoaXMuX19yZW5kZXIocmVzdWx0LCBzZWxlY3Rvcik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGlzLl9fcmVuZGVyKHJlc3VsdCwgc2VsZWN0b3IpO1xuXHRcdH1cblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdF9fcmVuZGVyOiBmdW5jdGlvbihyZXN1bHQsIHNlbGVjdG9yKVxuXHR7XG5cdFx0Y29uc3QgZGljdCA9IHtcblx0XHRcdGZpZWxkOiB0aGlzLmN0eC5maWVsZCxcblx0XHRcdG1pbWU6IHRoaXMuY3R4Lm1pbWUsXG5cdFx0fTtcblxuXHRcdHRoaXMucmVwbGFjZUhUTUwoc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRNZWRpYVZpZXdlckN0cmwsIHtkaWN0OiBkaWN0fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdHRoaXMucmVmcmVzaCgpLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcy5jdHguY29udGV4dCwgW2RhdGFdKTtcblxuXHRcdFx0fSkuZmFpbCgobWVzc2FnZSkgPT4ge1xuXG5cdFx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKHRoaXMuY3R4LmNvbnRleHQsIFttZXNzYWdlXSk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHJlZnJlc2g6IGZ1bmN0aW9uKHNldHRpbmdzKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgW2NvbnRleHRdID0gYW1pV2ViQXBwLnNldHVwKFsnY29udGV4dCddLCBbcmVzdWx0XSwgc2V0dGluZ3MpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgY29tbWFuZCA9ICdTZWFyY2hRdWVyeSAtY2F0YWxvZz1cIicgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LmNhdGFsb2cpICsgJ1wiIC1lbnRpdHk9XCInICsgYW1pV2ViQXBwLnRleHRUb1N0cmluZyh0aGlzLmN0eC5lbnRpdHkpICsgJ1wiIC1zcWw9XCJTRUxFQ1QgYCcgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LmZpZWxkKSArICdgIEZST00gYCcgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LmVudGl0eSkgKyAnYCBXSEVSRSBgJyArIGFtaVdlYkFwcC50ZXh0VG9TdHJpbmcodGhpcy5jdHgucHJpbWFyeUZpZWxkTmFtZSkgKyAnYCA9IFxcJycgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LnByaW1hcnlGaWVsZFZhbHVlKSArICdcXCdcIic7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRhbWlDb21tYW5kLmV4ZWN1dGUoY29tbWFuZCkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0Y29uc3QgdGV4dCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGQuJCcsIGRhdGEpWzBdIHx8ICcnO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0aWYodGhpcy5jdHgubWltZS5zdGFydHNXaXRoKCdpbWFnZS8nKSlcblx0XHRcdHtcblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHQkKCc8aW1nIC8+JykuYXR0cih7XG5cblx0XHRcdFx0XHRhbHQ6IHRoaXMuY3R4LmZpZWxkLFxuXG5cdFx0XHRcdFx0c3JjOiAnZGF0YTonICsgdGhpcy5jdHgubWltZSArICc7YmFzZTY0LCcgKyB0ZXh0LFxuXG5cdFx0XHRcdFx0aGVpZ2h0OiAnYXV0bycsXG5cdFx0XHRcdFx0d2lkdGg6ICc4MDAnLFxuXG5cdFx0XHRcdH0pLmFwcGVuZFRvKHRoaXMucGF0Y2hJZCgnI0QyNUM5MzkwX0E3MjJfOUM0OF9CQzgxXzVDODg3NUNBQUM5NScpKTtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdCQoJzxvYmplY3QgLz4nKS5hdHRyKHtcblxuXHRcdFx0XHRcdHR5cGU6IHRoaXMuY3R4Lm1pbWUsXG5cblx0XHRcdFx0XHRkYXRhOiAnZGF0YTonICsgdGhpcy5jdHgubWltZSArICc7YmFzZTY0LCcgKyB0ZXh0LFxuXG5cdFx0XHRcdFx0aGVpZ2h0OiAnNjAwJyxcblx0XHRcdFx0XHR3aWR0aDogJzgwMCcsXG5cblx0XHRcdFx0fSkuYXBwZW5kVG8odGhpcy5wYXRjaElkKCcjRDI1QzkzOTBfQTcyMl85QzQ4X0JDODFfNUM4ODc1Q0FBQzk1JykpO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdFx0XHR9XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgoY29udGV4dCwgW2RhdGFdKTtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR9KS5mYWlsKChkYXRhLCBtZXNzYWdlKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKGNvbnRleHQsIFttZXNzYWdlXSk7XG5cdFx0fSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG59KTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4iXX0=
