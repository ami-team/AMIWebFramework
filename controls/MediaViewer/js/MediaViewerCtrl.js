/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / CNRS
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 */$AMIClass("MediaViewerCtrl",{$extends:ami.Control,$init:function $init(parent,owner){this.$super.$init(parent,owner)},onReady:function onReady(){var _this=this;return amiWebApp.loadResources([amiWebApp.originURL+"/controls/MediaViewer/twig/MediaViewerCtrl.twig"]).done(function(data){_this.fragmentMediaViewerCtrl=data[0]})},render:function render(selector,catalog,entity,primaryFieldName,primaryFieldValue,field,base64,mime,settings){var result=$.Deferred();this.ctx={catalog:catalog,entity:entity,primaryFieldName:primaryFieldName,primaryFieldValue:primaryFieldValue,field:field,base64:base64,mime:mime};var _amiWebApp$setup=amiWebApp.setup(["context","card"],[result,false],settings),context=_amiWebApp$setup[0],card=_amiWebApp$setup[1];this.ctx.card=card;this._render(result,selector);return result},_render:function _render(result,selector){var _this2=this;if(this.getParent().$name!=="TabCtrl"){var tab=new this.tabCtor(null,this);tab.render(selector,this.ctx).done(function(){tab.appendItem("<i class=\"fa fa-arrows-alt\"></i> "+_this2.ctx.entity,{closable:false}).done(function(selector){_this2.setParent(tab);_this2.__render(result,selector)})})}else{this.__render(result,selector)}},__render:function __render(result,selector){var _this3=this;var dict={field:this.ctx.field,mime:this.ctx.mime};this.replaceHTML(selector,this.fragmentMediaViewerCtrl,{dict:dict}).done(function(){_this3.refresh().done(function(data){result.resolveWith(_this3.ctx.context,[data])}).fail(function(message){result.rejectWith(_this3.ctx.context,[message])})})},refresh:function refresh(settings){var _this4=this;var result=$.Deferred();var _amiWebApp$setup2=amiWebApp.setup(["context"],[result],settings),context=_amiWebApp$setup2[0];var command="SearchQuery -catalog=\""+amiWebApp.textToString(this.ctx.catalog)+"\" -entity=\""+amiWebApp.textToString(this.ctx.entity)+"\" -sql=\"SELECT `"+amiWebApp.textToString(this.ctx.field)+"` FROM `"+amiWebApp.textToString(this.ctx.entity)+"` WHERE `"+amiWebApp.textToString(this.ctx.primaryFieldName)+"` = '"+amiWebApp.textToString(this.ctx.primaryFieldValue)+"'\"";amiCommand.execute(command).done(function(data){var text=amiWebApp.jspath("..field.$",data)[0]||"";if(_this4.ctx.mime.startsWith("image/")){$("<img />").attr({alt:_this4.ctx.field,src:"data:"+_this4.ctx.mime+";base64,"+text,height:"auto",width:"800"}).appendTo(_this4.patchId("#D25C9390_A722_9C48_BC81_5C8875CAAC95"))}else{$("<object />").attr({type:_this4.ctx.mime,data:"data:"+_this4.ctx.mime+";base64,"+text,height:"600",width:"800"}).appendTo(_this4.patchId("#D25C9390_A722_9C48_BC81_5C8875CAAC95"))}result.resolveWith(context,[data])}).fail(function(data,message){result.rejectWith(context,[message])});return result}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1lZGlhVmlld2VyQ3RybC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJDb250cm9sIiwiJGluaXQiLCJwYXJlbnQiLCJvd25lciIsIiRzdXBlciIsIm9uUmVhZHkiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwib3JpZ2luVVJMIiwiZG9uZSIsImRhdGEiLCJmcmFnbWVudE1lZGlhVmlld2VyQ3RybCIsInJlbmRlciIsInNlbGVjdG9yIiwiY2F0YWxvZyIsImVudGl0eSIsInByaW1hcnlGaWVsZE5hbWUiLCJwcmltYXJ5RmllbGRWYWx1ZSIsImZpZWxkIiwiYmFzZTY0IiwibWltZSIsInNldHRpbmdzIiwicmVzdWx0IiwiJCIsIkRlZmVycmVkIiwiY3R4Iiwic2V0dXAiLCJjb250ZXh0IiwiY2FyZCIsIl9yZW5kZXIiLCJnZXRQYXJlbnQiLCIkbmFtZSIsInRhYiIsInRhYkN0b3IiLCJhcHBlbmRJdGVtIiwiY2xvc2FibGUiLCJzZXRQYXJlbnQiLCJfX3JlbmRlciIsImRpY3QiLCJyZXBsYWNlSFRNTCIsInJlZnJlc2giLCJyZXNvbHZlV2l0aCIsImZhaWwiLCJtZXNzYWdlIiwicmVqZWN0V2l0aCIsImNvbW1hbmQiLCJ0ZXh0VG9TdHJpbmciLCJhbWlDb21tYW5kIiwiZXhlY3V0ZSIsInRleHQiLCJqc3BhdGgiLCJzdGFydHNXaXRoIiwiYXR0ciIsImFsdCIsInNyYyIsImhlaWdodCIsIndpZHRoIiwiYXBwZW5kVG8iLCJwYXRjaElkIiwidHlwZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztHQWFBQSxTQUFTLENBQUMsaUJBQUQsQ0FBb0IsQ0FHNUJDLFFBQVEsQ0FBRUMsR0FBRyxDQUFDQyxPQUhjLENBTzVCQyxLQUFLLENBQUUsZUFBU0MsTUFBVCxDQUFpQkMsS0FBakIsQ0FDUCxDQUNDLEtBQUtDLE1BQUwsQ0FBWUgsS0FBWixDQUFrQkMsTUFBbEIsQ0FBMEJDLEtBQTFCLENBQ0EsQ0FWMkIsQ0Fj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REEsTUFBT3JCLENBQUFBLE1BQ1AsQ0EzTDJCLENBQXBCLENBQVQiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFNSSBXZWIgRnJhbWV3b3JrXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LVhYWFggVGhlIEFNSSBUZWFtIC8gTFBTQyAvIENOUlNcbiAqXG4gKiBUaGlzIGZpbGUgbXVzdCBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgQ2VDSUxMLUM6XG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZW4uaHRtbFxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWZyLmh0bWxcbiAqXG4gKi9cblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdNZWRpYVZpZXdlckN0cmwnLCB7XG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkZXh0ZW5kczogYW1pLkNvbnRyb2wsXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdCRpbml0OiBmdW5jdGlvbihwYXJlbnQsIG93bmVyKVxuXHR7XG5cdFx0dGhpcy4kc3VwZXIuJGluaXQocGFyZW50LCBvd25lcik7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKClcblx0e1xuXHRcdHJldHVybiBhbWlXZWJBcHAubG9hZFJlc291cmNlcyhbXG5cdFx0XHRhbWlXZWJBcHAub3JpZ2luVVJMICsgJy9jb250cm9scy9NZWRpYVZpZXdlci90d2lnL01lZGlhVmlld2VyQ3RybC50d2lnJyxcblx0XHRdKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdHRoaXMuZnJhZ21lbnRNZWRpYVZpZXdlckN0cmwgPSBkYXRhWzBdO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZW5kZXI6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjYXRhbG9nLCBlbnRpdHksIHByaW1hcnlGaWVsZE5hbWUsIHByaW1hcnlGaWVsZFZhbHVlLCBmaWVsZCwgYmFzZTY0LCBtaW1lLCBzZXR0aW5ncylcblx0e1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0dGhpcy5jdHggPSB7XG5cdFx0XHRjYXRhbG9nOiBjYXRhbG9nLFxuXHRcdFx0ZW50aXR5OiBlbnRpdHksXG5cdFx0XHRwcmltYXJ5RmllbGROYW1lOiBwcmltYXJ5RmllbGROYW1lLFxuXHRcdFx0cHJpbWFyeUZpZWxkVmFsdWU6IHByaW1hcnlGaWVsZFZhbHVlLFxuXHRcdFx0ZmllbGQ6IGZpZWxkLFxuXHRcdFx0YmFzZTY0OiBiYXNlNjQsXG5cdFx0XHRtaW1lOiBtaW1lLFxuXHRcdH07XG5cblx0XHRjb25zdCBbXG5cdFx0XHRjb250ZXh0LFxuXHRcdFx0Y2FyZFxuXHRcdF0gPSBhbWlXZWJBcHAuc2V0dXAoXG5cdFx0XHRbXG5cdFx0XHRcdCdjb250ZXh0Jyxcblx0XHRcdFx0J2NhcmQnLFxuXHRcdFx0XSxcblx0XHRcdFtcblx0XHRcdFx0cmVzdWx0LFxuXHRcdFx0XHRmYWxzZSxcblx0XHRcdF0sXG5cdFx0XHRzZXR0aW5nc1xuXHRcdCk7XG5cblx0XHR0aGlzLmN0eC5jYXJkID0gY2FyZDtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0dGhpcy5fcmVuZGVyKHJlc3VsdCwgc2VsZWN0b3IpO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRfcmVuZGVyOiBmdW5jdGlvbihyZXN1bHQsIHNlbGVjdG9yKVxuXHR7XG5cdFx0aWYodGhpcy5nZXRQYXJlbnQoKS4kbmFtZSAhPT0gJ1RhYkN0cmwnKVxuXHRcdHtcblx0XHRcdGNvbnN0IHRhYiA9IG5ldyB0aGlzLnRhYkN0b3IobnVsbCwgdGhpcyk7XG5cblx0XHRcdHRhYi5yZW5kZXIoc2VsZWN0b3IsIHRoaXMuY3R4KS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHR0YWIuYXBwZW5kSXRlbSgnPGkgY2xhc3M9XCJmYSBmYS1hcnJvd3MtYWx0XCI+PC9pPiAnICsgdGhpcy5jdHguZW50aXR5LCB7Y2xvc2FibGU6IGZhbHNlfSkuZG9uZSgoc2VsZWN0b3IpID0+IHtcblxuXHRcdFx0XHRcdHRoaXMuc2V0UGFyZW50KHRhYik7XG5cblx0XHRcdFx0XHR0aGlzLl9fcmVuZGVyKHJlc3VsdCwgc2VsZWN0b3IpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhpcy5fX3JlbmRlcihyZXN1bHQsIHNlbGVjdG9yKTtcblx0XHR9XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdF9fcmVuZGVyOiBmdW5jdGlvbihyZXN1bHQsIHNlbGVjdG9yKVxuXHR7XG5cdFx0Y29uc3QgZGljdCA9IHtcblx0XHRcdGZpZWxkOiB0aGlzLmN0eC5maWVsZCxcblx0XHRcdG1pbWU6IHRoaXMuY3R4Lm1pbWUsXG5cdFx0fTtcblxuXHRcdHRoaXMucmVwbGFjZUhUTUwoc2VsZWN0b3IsIHRoaXMuZnJhZ21lbnRNZWRpYVZpZXdlckN0cmwsIHtkaWN0OiBkaWN0fSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdHRoaXMucmVmcmVzaCgpLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZVdpdGgodGhpcy5jdHguY29udGV4dCwgW2RhdGFdKTtcblxuXHRcdFx0fSkuZmFpbCgobWVzc2FnZSkgPT4ge1xuXG5cdFx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKHRoaXMuY3R4LmNvbnRleHQsIFttZXNzYWdlXSk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0cmVmcmVzaDogZnVuY3Rpb24oc2V0dGluZ3MpXG5cdHtcblx0XHRjb25zdCByZXN1bHQgPSAkLkRlZmVycmVkKCk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IFtjb250ZXh0XSA9IGFtaVdlYkFwcC5zZXR1cChbJ2NvbnRleHQnXSwgW3Jlc3VsdF0sIHNldHRpbmdzKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0Y29uc3QgY29tbWFuZCA9ICdTZWFyY2hRdWVyeSAtY2F0YWxvZz1cIicgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LmNhdGFsb2cpICsgJ1wiIC1lbnRpdHk9XCInICsgYW1pV2ViQXBwLnRleHRUb1N0cmluZyh0aGlzLmN0eC5lbnRpdHkpICsgJ1wiIC1zcWw9XCJTRUxFQ1QgYCcgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LmZpZWxkKSArICdgIEZST00gYCcgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LmVudGl0eSkgKyAnYCBXSEVSRSBgJyArIGFtaVdlYkFwcC50ZXh0VG9TdHJpbmcodGhpcy5jdHgucHJpbWFyeUZpZWxkTmFtZSkgKyAnYCA9IFxcJycgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKHRoaXMuY3R4LnByaW1hcnlGaWVsZFZhbHVlKSArICdcXCdcIic7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGFtaUNvbW1hbmQuZXhlY3V0ZShjb21tYW5kKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdGNvbnN0IHRleHQgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkLiQnLCBkYXRhKVswXSB8fCAnJztcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0aWYodGhpcy5jdHgubWltZS5zdGFydHNXaXRoKCdpbWFnZS8nKSlcblx0XHRcdHtcblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdCQoJzxpbWcgLz4nKS5hdHRyKHtcblxuXHRcdFx0XHRcdGFsdDogdGhpcy5jdHguZmllbGQsXG5cblx0XHRcdFx0XHRzcmM6ICdkYXRhOicgKyB0aGlzLmN0eC5taW1lICsgJztiYXNlNjQsJyArIHRleHQsXG5cblx0XHRcdFx0XHRoZWlnaHQ6ICdhdXRvJyxcblx0XHRcdFx0XHR3aWR0aDogJzgwMCcsXG5cblx0XHRcdFx0fSkuYXBwZW5kVG8odGhpcy5wYXRjaElkKCcjRDI1QzkzOTBfQTcyMl85QzQ4X0JDODFfNUM4ODc1Q0FBQzk1JykpO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdCQoJzxvYmplY3QgLz4nKS5hdHRyKHtcblxuXHRcdFx0XHRcdHR5cGU6IHRoaXMuY3R4Lm1pbWUsXG5cblx0XHRcdFx0XHRkYXRhOiAnZGF0YTonICsgdGhpcy5jdHgubWltZSArICc7YmFzZTY0LCcgKyB0ZXh0LFxuXG5cdFx0XHRcdFx0aGVpZ2h0OiAnNjAwJyxcblx0XHRcdFx0XHR3aWR0aDogJzgwMCcsXG5cblx0XHRcdFx0fSkuYXBwZW5kVG8odGhpcy5wYXRjaElkKCcjRDI1QzkzOTBfQTcyMl85QzQ4X0JDODFfNUM4ODc1Q0FBQzk1JykpO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0XHRcdH1cblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0cmVzdWx0LnJlc29sdmVXaXRoKGNvbnRleHQsIFtkYXRhXSk7XG5cblx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR9KS5mYWlsKChkYXRhLCBtZXNzYWdlKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3RXaXRoKGNvbnRleHQsIFttZXNzYWdlXSk7XG5cdFx0fSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xufSk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4iXX0=
