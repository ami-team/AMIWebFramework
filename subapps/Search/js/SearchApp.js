/*!
 * AMI Twig Engine
 *
 * Copyright (c) 2014-2019 The AMI Team / LPSC / IN2P3
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 */$AMIClass("SearchApp",{$extends:ami.SubApp,onReady:function onReady(userdata){var _this=this;var result=$.Deferred();amiWebApp.loadResources(["subapps/Search/twig/SearchApp.twig","subapps/Search/twig/interface.twig","ctrl:search","ctrl:tab"]).done(function(data){_this.searchCtor=data[2];_this.tabCtrl=new data[3];amiWebApp.replaceHTML("#ami_main_content",data[0]).done(function(){_this.tabCtrl.render("#FE8BB925_A267_F972_060E_CC9C70D0C6D2",{card:false}).done(function(){_this.fragmentInterface=data[1];_this.searchInterfaces={};_this.groups1=[];_this.groups2=[];if(userdata){userdata.split(",").forEach(function(item){var parts=item.split(":");if(parts.length>0){var group=parts[0].trim();if(_this.groups1.indexOf(group)<0){_this.groups1.push(group)}if(parts.length>1){var name=parts[1].trim();if(_this.groups2.indexOf(group+":"+name)<0){_this.groups2.push(group+":"+name)}}}})}result.resolve()})})}).fail(function(data){result.reject(data)});return result},onLogin:function onLogin(){this.getInterfaceList()},onLogout:function onLogout(){this.maskInterfaceList()},getInterfaceList:function getInterfaceList(){var _this2=this;amiWebApp.lock();var sql=this.groups1.length===0?"SELECT `id`, `group`, `name`, `rank`, `json` FROM `router_search_interface` WHERE `archived` = 0 ORDER BY `rank` ASC, `group` ASC, `name` ASC":"SELECT `id`, `group`, `name`, `rank`, `json` FROM `router_search_interface` WHERE `archived` = 0 AND `group` IN ("+this.groups1.map(function(group){return"'"+amiWebApp.textToSQL(group)+"'"}).join(", ")+") ORDER BY `rank` ASC, `group` ASC, `name` ASC";amiCommand.execute("SearchQuery -catalog=\"self\" -entity=\"router_search_interface\" -sql=\""+sql+"\"").done(function(data){var rows=amiWebApp.jspath("..row",data);var dict={groups:{}};var auto_open=[];rows.forEach(function(row){var id=amiWebApp.jspath("..field{.@name===\"id\"}.$",row)[0]||"";var group=amiWebApp.jspath("..field{.@name===\"group\"}.$",row)[0]||"";var name=amiWebApp.jspath("..field{.@name===\"name\"}.$",row)[0]||"";var json=amiWebApp.jspath("..field{.@name===\"json\"}.$",row)[0]||"";try{if(!(group in dict.groups)){dict.groups[group]=[]}var searchInterface={id:id,name:name,json:JSON.parse(json)};dict.groups[group].push(searchInterface);_this2.searchInterfaces[id]=searchInterface;if(_this2.groups2.indexOf(group+":"+name)>=0){auto_open.push(id)}}catch(e){}});amiWebApp.replaceHTML("#CCFE77D9_5798_A236_8108_E59AE44FB242",_this2.fragmentInterface,{dict:dict}).done(function(){$("#FE8BB925_A267_F972_060E_CC9C70D0C6D2").show();auto_open.forEach(function(item){_this2.select(item)});amiWebApp.unlock()})}).fail(function(data,message){amiWebApp.error(message,true)})},maskInterfaceList:function maskInterfaceList(){amiWebApp.replaceHTML("#CCFE77D9_5798_A236_8108_E59AE44FB242","Please sign-in.").done(function(){$("#FE8BB925_A267_F972_060E_CC9C70D0C6D2").hide()})},select:function select(id){var _this3=this;amiWebApp.lock();var searchInterface=this.searchInterfaces[id];this.tabCtrl.appendItem(searchInterface.name,{context:this,closable:true}).done(function(sel){searchInterface.json.name=searchInterface.name;new _this3.searchCtor(_this3.tabCtrl).render(sel,searchInterface.json).always(function(){amiWebApp.unlock()})})}});var searchApp=new SearchApp;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlYXJjaEFwcC5lczYuanMiXSwibmFtZXMiOlsiJEFNSUNsYXNzIiwiJGV4dGVuZHMiLCJhbWkiLCJTdWJBcHAiLCJvblJlYWR5IiwidXNlcmRhdGEiLCJyZXN1bHQiLCIkIiwiRGVmZXJyZWQiLCJhbWlXZWJBcHAiLCJsb2FkUmVzb3VyY2VzIiwiZG9uZSIsImRhdGEiLCJzZWFyY2hDdG9yIiwidGFiQ3RybCIsInJlcGxhY2VIVE1MIiwicmVuZGVyIiwiY2FyZCIsImZyYWdtZW50SW50ZXJmYWNlIiwic2VhcmNoSW50ZXJmYWNlcyIsImdyb3VwczEiLCJncm91cHMyIiwic3BsaXQiLCJmb3JFYWNoIiwiaXRlbSIsInBhcnRzIiwibGVuZ3RoIiwiZ3JvdXAiLCJ0cmltIiwiaW5kZXhPZiIsInB1c2giLCJuYW1lIiwicmVzb2x2ZSIsImZhaWwiLCJyZWplY3QiLCJvbkxvZ2luIiwiZ2V0SW50ZXJmYWNlTGlzdCIsIm9uTG9nb3V0IiwibWFza0ludGVyZmFjZUxpc3QiLCJsb2NrIiwic3FsIiwibWFwIiwidGV4dFRvU1FMIiwiam9pbiIsImFtaUNvbW1hbmQiLCJleGVjdXRlIiwicm93cyIsImpzcGF0aCIsImRpY3QiLCJncm91cHMiLCJhdXRvX29wZW4iLCJyb3ciLCJpZCIsImpzb24iLCJzZWFyY2hJbnRlcmZhY2UiLCJKU09OIiwicGFyc2UiLCJlIiwic2hvdyIsInNlbGVjdCIsInVubG9jayIsIm1lc3NhZ2UiLCJlcnJvciIsImhpZGUiLCJhcHBlbmRJdGVtIiwiY29udGV4dCIsImNsb3NhYmxlIiwic2VsIiwiYWx3YXlzIiwic2VhcmNoQXBwIiwiU2VhcmNoQXBwIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O0dBYUFBLFNBQVMsQ0FBQyxXQUFELENBQWMsQ0FHdEJDLFFBQVEsQ0FBRUMsR0FBRyxDQUFDQyxNQUhRLENBT3RCQyxPQUFPLENBQUUsaUJBQVNDLFFBQVQsQ0FDVCxnQkFDQyxHQUFNQyxDQUFBQSxNQUFNLENBQUdDLENBQUMsQ0FBQ0Ms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LENBSEQsQ0FJQSxDQWhMcUIsQ0FvTHRCSixNQUFNLENBQUUsZ0JBQVNQLEVBQVQsQ0FDUixpQkFDQzNDLFNBQVMsQ0FBQzhCLElBQVYsR0FFQSxHQUFNZSxDQUFBQSxlQUFlLENBQUcsS0FBS25DLGdCQUFMLENBQXNCaUMsRUFBdEIsQ0FBeEIsQ0FFQSxLQUFLdEMsT0FBTCxDQUFha0QsVUFBYixDQUF3QlYsZUFBZSxDQUFDdkIsSUFBeEMsQ0FBOEMsQ0FBQ2tDLE9BQU8sQ0FBRSxJQUFWLENBQWdCQyxRQUFRLENBQUUsSUFBMUIsQ0FBOUMsRUFBK0V2RCxJQUEvRSxDQUFvRixTQUFDd0QsR0FBRCxDQUFTLENBRTVGYixlQUFlLENBQUNELElBQWhCLENBQXFCdEIsSUFBckIsQ0FBNEJ1QixlQUFlLENBQUN2QixJQUE1QyxDQUVBLEdBQUksQ0FBQSxNQUFJLENBQUNsQixVQUFULENBQW9CLE1BQUksQ0FBQ0MsT0FBekIsRUFBa0NFLE1BQWxDLENBQXlDbUQsR0FBekMsQ0FBOENiLGVBQWUsQ0FBQ0QsSUFBOUQsRUFBb0VlLE1BQXBFLENBQTJFLFVBQU0sQ0FFaEYzRCxTQUFTLENBQUNtRCxNQUFWLEVBQ0EsQ0FIRCxDQUlBLENBUkQsQ0FTQSxDQW5NcUIsQ0FBZCxDQUFULENBNE1BLEdBQU1TLENBQUFBLFNBQVMsQ0FBRyxHQUFJQyxDQUFBQSxTQUF0QiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQU1JIFR3aWcgRW5naW5lXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMTkgVGhlIEFNSSBUZWFtIC8gTFBTQyAvIElOMlAzXG4gKlxuICogVGhpcyBmaWxlIG11c3QgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIENlQ0lMTC1DOlxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWVuLmh0bWxcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1mci5odG1sXG4gKlxuICovXG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4kQU1JQ2xhc3MoJ1NlYXJjaEFwcCcsIHtcblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkZXh0ZW5kczogYW1pLlN1YkFwcCxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKHVzZXJkYXRhKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0YW1pV2ViQXBwLmxvYWRSZXNvdXJjZXMoW1xuXHRcdFx0J3N1YmFwcHMvU2VhcmNoL3R3aWcvU2VhcmNoQXBwLnR3aWcnLFxuXHRcdFx0J3N1YmFwcHMvU2VhcmNoL3R3aWcvaW50ZXJmYWNlLnR3aWcnLFxuXHRcdFx0J2N0cmw6c2VhcmNoJyxcblx0XHRcdCdjdHJsOnRhYicsXG5cdFx0XSkuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHR0aGlzLnNlYXJjaEN0b3IgPSBkYXRhWzJdO1xuXG5cdFx0XHR0aGlzLnRhYkN0cmwgPSBuZXcgZGF0YVszXSgpO1xuXG5cdFx0XHRhbWlXZWJBcHAucmVwbGFjZUhUTUwoJyNhbWlfbWFpbl9jb250ZW50JywgZGF0YVswXSkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdFx0dGhpcy50YWJDdHJsLnJlbmRlcignI0ZFOEJCOTI1X0EyNjdfRjk3Ml8wNjBFX0NDOUM3MEQwQzZEMicsIHtjYXJkOiBmYWxzZX0pLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0dGhpcy5mcmFnbWVudEludGVyZmFjZSA9IGRhdGFbMV07XG5cblx0XHRcdFx0XHR0aGlzLnNlYXJjaEludGVyZmFjZXMgPSB7fTtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRcdHRoaXMuZ3JvdXBzMSA9IFtdO1xuXHRcdFx0XHRcdHRoaXMuZ3JvdXBzMiA9IFtdO1xuXG5cdFx0XHRcdFx0aWYodXNlcmRhdGEpXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0dXNlcmRhdGEuc3BsaXQoJywnKS5mb3JFYWNoKChpdGVtKSA9PiB7XG5cblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFydHMgPSBpdGVtLnNwbGl0KCc6Jyk7XG5cblx0XHRcdFx0XHRcdFx0LyoqL1xuXG5cdFx0XHRcdFx0XHRcdGlmKHBhcnRzLmxlbmd0aCA+IDApXG5cdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBncm91cCA9IHBhcnRzWzBdLnRyaW0oKTtcblxuXHRcdFx0XHRcdFx0XHRcdGlmKHRoaXMuZ3JvdXBzMS5pbmRleE9mKGdyb3VwKSA8IDApXG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5ncm91cHMxLnB1c2goZ3JvdXApO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdGlmKHBhcnRzLmxlbmd0aCA+IDEpXG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgbmFtZSA9IHBhcnRzWzFdLnRyaW0oKTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYodGhpcy5ncm91cHMyLmluZGV4T2YoZ3JvdXAgKyAnOicgKyBuYW1lKSA8IDApXG5cdFx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZ3JvdXBzMi5wdXNoKChncm91cCArICc6JyArIG5hbWUpKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRcdHJlc3VsdC5yZXNvbHZlKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3QoZGF0YSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0b25Mb2dpbjogZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5nZXRJbnRlcmZhY2VMaXN0KCk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRvbkxvZ291dDogZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5tYXNrSW50ZXJmYWNlTGlzdCgpO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0Z2V0SW50ZXJmYWNlTGlzdDogZnVuY3Rpb24oKVxuXHR7XG5cdFx0YW1pV2ViQXBwLmxvY2soKTtcblxuXHRcdGNvbnN0IHNxbCA9ICh0aGlzLmdyb3VwczEubGVuZ3RoID09PSAwKSA/ICdTRUxFQ1QgYGlkYCwgYGdyb3VwYCwgYG5hbWVgLCBgcmFua2AsIGBqc29uYCBGUk9NIGByb3V0ZXJfc2VhcmNoX2ludGVyZmFjZWAgV0hFUkUgYGFyY2hpdmVkYCA9IDAgT1JERVIgQlkgYHJhbmtgIEFTQywgYGdyb3VwYCBBU0MsIGBuYW1lYCBBU0MnXG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJ1NFTEVDVCBgaWRgLCBgZ3JvdXBgLCBgbmFtZWAsIGByYW5rYCwgYGpzb25gIEZST00gYHJvdXRlcl9zZWFyY2hfaW50ZXJmYWNlYCBXSEVSRSBgYXJjaGl2ZWRgID0gMCBBTkQgYGdyb3VwYCBJTiAoJyArIHRoaXMuZ3JvdXBzMS5tYXAoZ3JvdXAgPT4gJ1xcJycgKyBhbWlXZWJBcHAudGV4dFRvU1FMKGdyb3VwKSArICdcXCcnKS5qb2luKCcsICcpICsgJykgT1JERVIgQlkgYHJhbmtgIEFTQywgYGdyb3VwYCBBU0MsIGBuYW1lYCBBU0MnXG5cdFx0O1xuXG5cdFx0YW1pQ29tbWFuZC5leGVjdXRlKCdTZWFyY2hRdWVyeSAtY2F0YWxvZz1cInNlbGZcIiAtZW50aXR5PVwicm91dGVyX3NlYXJjaF9pbnRlcmZhY2VcIiAtc3FsPVwiJyArIHNxbCArICdcIicpLmRvbmUoKGRhdGEpID0+IHtcblxuXHRcdFx0Y29uc3Qgcm93cyA9IGFtaVdlYkFwcC5qc3BhdGgoJy4ucm93JywgZGF0YSk7XG5cblx0XHRcdGNvbnN0IGRpY3QgPSB7XG5cdFx0XHRcdGdyb3Vwczoge30sXG5cdFx0XHR9O1xuXG5cdFx0XHRjb25zdCBhdXRvX29wZW4gPSBbXTtcblxuXHRcdFx0cm93cy5mb3JFYWNoKChyb3cpID0+IHtcblxuXHRcdFx0XHRjb25zdCBpZCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJpZFwifS4kJywgcm93KVswXSB8fCAnJztcblx0XHRcdFx0Y29uc3QgZ3JvdXAgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwiZ3JvdXBcIn0uJCcsIHJvdylbMF0gfHwgJyc7XG5cdFx0XHRcdGNvbnN0IG5hbWUgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwibmFtZVwifS4kJywgcm93KVswXSB8fCAnJztcblx0XHRcdFx0Y29uc3QganNvbiA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJqc29uXCJ9LiQnLCByb3cpWzBdIHx8ICcnO1xuXG5cdFx0XHRcdHRyeVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0aWYoIShncm91cCBpbiBkaWN0Lmdyb3VwcykpXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0ZGljdC5ncm91cHNbZ3JvdXBdID0gW107XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Y29uc3Qgc2VhcmNoSW50ZXJmYWNlID0ge1xuXHRcdFx0XHRcdFx0aWQ6IGlkLFxuXHRcdFx0XHRcdFx0bmFtZTogbmFtZSxcblx0XHRcdFx0XHRcdGpzb246IEpTT04ucGFyc2UoanNvbiksXG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGRpY3QuZ3JvdXBzW2dyb3VwXS5wdXNoKHNlYXJjaEludGVyZmFjZSk7XG5cblx0XHRcdFx0XHR0aGlzLnNlYXJjaEludGVyZmFjZXNbaWRdID0gc2VhcmNoSW50ZXJmYWNlO1xuXG5cdFx0XHRcdFx0aWYodGhpcy5ncm91cHMyLmluZGV4T2YoZ3JvdXAgKyAnOicgKyBuYW1lKSA+PSAwKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGF1dG9fb3Blbi5wdXNoKGlkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Y2F0Y2goZSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdC8qIElHTk9SRSAqL1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0YW1pV2ViQXBwLnJlcGxhY2VIVE1MKCcjQ0NGRTc3RDlfNTc5OF9BMjM2XzgxMDhfRTU5QUU0NEZCMjQyJywgdGhpcy5mcmFnbWVudEludGVyZmFjZSwge2RpY3Q6IGRpY3R9KS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHQkKCcjRkU4QkI5MjVfQTI2N19GOTcyXzA2MEVfQ0M5QzcwRDBDNkQyJykuc2hvdygpO1xuXG5cdFx0XHRcdGF1dG9fb3Blbi5mb3JFYWNoKChpdGVtKSA9PiB7XG5cblx0XHRcdFx0XHR0aGlzLnNlbGVjdChpdGVtKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0YW1pV2ViQXBwLnVubG9jaygpO1xuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhLCBtZXNzYWdlKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC5lcnJvcihtZXNzYWdlLCB0cnVlKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG1hc2tJbnRlcmZhY2VMaXN0OiBmdW5jdGlvbigpXG5cdHtcblx0XHRhbWlXZWJBcHAucmVwbGFjZUhUTUwoJyNDQ0ZFNzdEOV81Nzk4X0EyMzZfODEwOF9FNTlBRTQ0RkIyNDInLCAnUGxlYXNlIHNpZ24taW4uJykuZG9uZSgoKSA9PiB7XG5cblx0XHRcdCQoJyNGRThCQjkyNV9BMjY3X0Y5NzJfMDYwRV9DQzlDNzBEMEM2RDInKS5oaWRlKCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRzZWxlY3Q6IGZ1bmN0aW9uKGlkKVxuXHR7XG5cdFx0YW1pV2ViQXBwLmxvY2soKTtcblxuXHRcdGNvbnN0IHNlYXJjaEludGVyZmFjZSA9IHRoaXMuc2VhcmNoSW50ZXJmYWNlc1tpZF07XG5cblx0XHR0aGlzLnRhYkN0cmwuYXBwZW5kSXRlbShzZWFyY2hJbnRlcmZhY2UubmFtZSwge2NvbnRleHQ6IHRoaXMsIGNsb3NhYmxlOiB0cnVlfSkuZG9uZSgoc2VsKSA9PiB7XG5cblx0XHRcdHNlYXJjaEludGVyZmFjZS5qc29uLm5hbWUgPSBzZWFyY2hJbnRlcmZhY2UubmFtZTtcblxuXHRcdFx0bmV3IHRoaXMuc2VhcmNoQ3Rvcih0aGlzLnRhYkN0cmwpLnJlbmRlcihzZWwsIHNlYXJjaEludGVyZmFjZS5qc29uKS5hbHdheXMoKCkgPT4ge1xuXG5cdFx0XHRcdGFtaVdlYkFwcC51bmxvY2soKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG59KTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4vKiBHTE9CQUwgSU5TVEFOQ0UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5jb25zdCBzZWFyY2hBcHAgPSBuZXcgU2VhcmNoQXBwKCk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuIl19
