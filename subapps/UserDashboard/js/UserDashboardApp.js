/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / CNRS
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 */$AMIClass("UserDashboardApp",{$extends:ami.SubApp,onReady:function onReady(userdata){var _this=this;var result=$.Deferred();amiWebApp.loadResources(["subapps/UserDashboard/css/UserDashboardApp.css","subapps/UserDashboard/twig/UserDashboardApp.twig","subapps/UserDashboard/js/jquery-ui.min.js",amiWebApp.originURL+"/subapps/UserDashboard/js/gridstack.min.css",amiWebApp.originURL+"/subapps/UserDashboard/js/gridstack.all.js"]).done(function(data){amiWebApp.replaceHTML("#ami_main_content",data[1]).done(function(){var el=$("#F251696F_D42E_F7FF_86F7_2E6B4F2E8F74");var settings={float:true,cellHeight:36,verticalMargin:12,width:12};_this.gridstack=el.gridstack(settings).data("gridstack");el.on("change",function(e,items){if(items&&!_this.lock){items.forEach(function(item){_this.updateWidget(item)})}});_this.lock=false;result.resolve()})}).fail(function(data){result.reject(data)});return result},onLogin:function onLogin(){var _this2=this;$("#ami_user_menu_content").html("<div class=\"dropdown-divider\"></div>"+"<a class=\"dropdown-item\" href=\"javascript:userDashboardApp.reload2();\">Reload Dashboard</a>"+"<a class=\"dropdown-item\" href=\"javascript:userDashboardApp.refresh2();\">Refresh Dashboard</a>"+"<a class=\"dropdown-item\" href=\""+amiWebApp.webAppURL+"?subapp=dashboardAdmin\" target=\"_blank\">Edit Dashboard</a>");return this.reload().done(function(){_this2.interval=setInterval(function(){_this2.refresh()},10000)})},onLogout:function onLogout(){$("#F251696F_D42E_F7FF_86F7_2E6B4F2E8F74").empty();clearInterval(this.interval);this.controls=[]},_reload:function _reload(result,rows,idx){var _this3=this;if(idx===rows.length){return result.resolve()}var row=rows[idx];var id=amiWebApp.jspath("..field{.@name===\"id\"}.$",row)[0]||"";var control=amiWebApp.jspath("..field{.@name===\"control\"}.$",row)[0]||"";var params=amiWebApp.jspath("..field{.@name===\"params\"}.$",row)[0]||"[]";var settings=amiWebApp.jspath("..field{.@name===\"settings\"}.$",row)[0]||"{}";var transparent=amiWebApp.jspath("..field{.@name===\"transparent\"}.$",row)[0]||"0";var autoRefresh=amiWebApp.jspath("..field{.@name===\"autoRefresh\"}.$",row)[0]||"1";var x=amiWebApp.jspath("..field{.@name===\"x\"}.$",row)[0]||"0";var y=amiWebApp.jspath("..field{.@name===\"y\"}.$",row)[0]||"0";var width=amiWebApp.jspath("..field{.@name===\"width\"}.$",row)[0]||"0";var height=amiWebApp.jspath("..field{.@name===\"height\"}.$",row)[0]||"0";var item_content_clazz=parseInt(transparent)?"grid-stack-item-content grid-stack-item-transparent-content":"grid-stack-item-content grid-stack-item-translucent-content";this.gridstack.addWidget($("<div data-gs-id=\""+id+"\">"+"  <div class=\""+item_content_clazz+"\" id=\"EB4DF671_2C31_BED0_6BED_44790525F28F_"+idx+"\"></div>"+"  <div class=\"grid-stack-item-close-handle\" id=\"D08B4F35_49D8_4844_D9D2_FB951948AF17_"+idx+"\"></div>"+"</div>"),x,y,width,height).promise().done(function(){$("#D08B4F35_49D8_4844_D9D2_FB951948AF17_"+idx).click(function(e){var el=$(e.currentTarget).parent();_this3.removeWidget(el.data("_gridstack_node")).done(function(){el.remove()})});try{amiWebApp.createControl(_this3,_this3,control,["#EB4DF671_2C31_BED0_6BED_44790525F28F_"+idx].concat(JSON.parse(params),JSON.parse(settings))).done(function(control){control.autoRefresh=parseInt(autoRefresh);_this3.controls.push(control);_this3._reload(result,rows,idx+1)}).fail(function(message){amiWebApp.error("For widget `"+id+"`: "+message);_this3._reload(result,rows,idx+1)})}catch(e){amiWebApp.error("For widget `"+id+"`: "+e.message);_this3._reload(result,rows,idx+1)}});return result},reload:function reload(){var _this4=this;var result=$.Deferred();amiCommand.execute("GetDashboardInfo").done(function(data){_this4.gridstack.removeAll();_this4.controls=[];_this4.lock=true;_this4._reload($.Deferred(),amiWebApp.jspath("..row",data),0).done(function(){_this4.refresh().done(function(){_this4.lock=false;result.resolve()})})}).fail(function(data,message){result.reject(message)});return result},reload2:function reload2(){amiWebApp.lock();this.reload().done(function(){amiWebApp.unlock()}).fail(function(message){amiWebApp.error(message)})},refresh:function refresh(){this.controls.forEach(function(control){if(control.autoRefresh!==0&&control.refresh){control.refresh()}});return $.Deferred().resolve()},refresh2:function refresh2(){amiWebApp.lock();this.refresh().done(function(){amiWebApp.unlock()}).fail(function(message){amiWebApp.error(message)})},updateWidget:function updateWidget(item){amiWebApp.lock();return amiCommand.execute("UpdateWidget -id=\""+amiWebApp.textToString(item.id)+"\" -x=\""+item.x+"\" -y=\""+item.y+"\" -width=\""+item.width+"\" -height=\""+item.height+"\"").done(function(){amiWebApp.unlock()}).fail(function(data,message){amiWebApp.error(message)})},removeWidget:function removeWidget(item){amiWebApp.lock();return amiCommand.execute("RemoveWidget -id=\""+amiWebApp.textToString(item.id)+"\"").done(function(){amiWebApp.unlock()}).fail(function(data,message){amiWebApp.error(message)})}});var userDashboardApp=new UserDashboardApp;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJEYXNoYm9hcmRBcHAuZXM2LmpzIl0sIm5hbWVzIjpbIiRBTUlDbGFzcyIsIiRleHRlbmRzIiwiYW1pIiwiU3ViQXBwIiwib25SZWFkeSIsInVzZXJkYXRhIiwicmVzdWx0IiwiJCIsIkRlZmVycmVkIiwiYW1pV2ViQXBwIiwibG9hZFJlc291cmNlcyIsIm9yaWdpblVSTCIsImRvbmUiLCJkYXRhIiwicmVwbGFjZUhUTUwiLCJlbCIsInNldHRpbmdzIiwiZmxvYXQiLCJjZWxsSGVpZ2h0IiwidmVydGljYWxNYXJnaW4iLCJ3aWR0aCIsImdyaWRzdGFjayIsIm9uIiwiZSIsIml0ZW1zIiwibG9jayIsImZvckVhY2giLCJpdGVtIiwidXBkYXRlV2lkZ2V0IiwicmVzb2x2ZSIsImZhaWwiLCJyZWplY3QiLCJvbkxvZ2luIiwiaHRtbCIsIndlYkFwcFVSTCIsInJlbG9hZCIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJyZWZyZXNoIiwib25Mb2dvdXQiLCJlbXB0eSIsImNsZWFySW50ZXJ2YWwiLCJjb250cm9scyIsIl9yZWxvYWQiLCJyb3dzIiwiaWR4IiwibGVuZ3RoIiwicm93IiwiaWQiLCJqc3BhdGgiLCJjb250cm9sIiwicGFyYW1zIiwidHJhbnNwYXJlbnQiLCJhdXRvUmVmcmVzaCIsIngiLCJ5IiwiaGVpZ2h0IiwiaXRlbV9jb250ZW50X2NsYXp6IiwicGFyc2VJbnQiLCJhZGRXaWRnZXQiLCJwcm9taXNlIiwiY2xpY2siLCJjdXJyZW50VGFyZ2V0IiwicGFyZW50IiwicmVtb3ZlV2lkZ2V0IiwicmVtb3ZlIiwiY3JlYXRlQ29udHJvbCIsImNvbmNhdCIsIkpTT04iLCJwYXJzZSIsInB1c2giLCJtZXNzYWdlIiwiZXJyb3IiLCJhbWlDb21tYW5kIiwiZXhlY3V0ZSIsInJlbW92ZUFsbCIsInJlbG9hZDIiLCJ1bmxvY2siLCJyZWZyZXNoMiIsInRleHRUb1N0cmluZyIsInVzZXJEYXNoYm9hcmRBcHAiLCJVc2VyRGFzaGJvYXJkQXBwIl0sIm1h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NEIsQ0FBckIsQ0FBVCxDQTRWQSxHQUFJUyxDQUFBQSxnQkFBZ0IsQ0FBRyxHQUFJQyxDQUFBQSxnQkFBM0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFNSSBXZWIgRnJhbWV3b3JrXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LVhYWFggVGhlIEFNSSBUZWFtIC8gTFBTQyAvIENOUlNcbiAqXG4gKiBUaGlzIGZpbGUgbXVzdCBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgQ2VDSUxMLUM6XG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZW4uaHRtbFxuICogaHR0cDovL3d3dy5jZWNpbGwuaW5mby9saWNlbmNlcy9MaWNlbmNlX0NlQ0lMTC1DX1YxLWZyLmh0bWxcbiAqXG4gKi9cblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuJEFNSUNsYXNzKCdVc2VyRGFzaGJvYXJkQXBwJywge1xuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0JGV4dGVuZHM6IGFtaS5TdWJBcHAsXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdG9uUmVhZHk6IGZ1bmN0aW9uKHVzZXJkYXRhKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0YW1pV2ViQXBwLmxvYWRSZXNvdXJjZXMoW1xuXHRcdFx0J3N1YmFwcHMvVXNlckRhc2hib2FyZC9jc3MvVXNlckRhc2hib2FyZEFwcC5jc3MnLFxuXHRcdFx0J3N1YmFwcHMvVXNlckRhc2hib2FyZC90d2lnL1VzZXJEYXNoYm9hcmRBcHAudHdpZycsXG5cdFx0XHQvKiovXG5cdFx0XHQnc3ViYXBwcy9Vc2VyRGFzaGJvYXJkL2pzL2pxdWVyeS11aS5taW4uanMnLFxuXHRcdFx0LyoqL1xuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvc3ViYXBwcy9Vc2VyRGFzaGJvYXJkL2pzL2dyaWRzdGFjay5taW4uY3NzJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL3N1YmFwcHMvVXNlckRhc2hib2FyZC9qcy9ncmlkc3RhY2suYWxsLmpzJyxcblx0XHRdKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC5yZXBsYWNlSFRNTCgnI2FtaV9tYWluX2NvbnRlbnQnLCBkYXRhWzFdKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0Y29uc3QgZWwgPSAkKCcjRjI1MTY5NkZfRDQyRV9GN0ZGXzg2RjdfMkU2QjRGMkU4Rjc0Jyk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdGNvbnN0IHNldHRpbmdzID0ge1xuXHRcdFx0XHRcdGZsb2F0OiB0cnVlLFxuXHRcdFx0XHRcdGNlbGxIZWlnaHQ6IDM2LFxuXHRcdFx0XHRcdHZlcnRpY2FsTWFyZ2luOiAxMixcblx0XHRcdFx0XHR3aWR0aDogMTIsXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dGhpcy5ncmlkc3RhY2sgPSBlbC5ncmlkc3RhY2soc2V0dGluZ3MpLmRhdGEoJ2dyaWRzdGFjaycpO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRlbC5vbignY2hhbmdlJywgKGUsIGl0ZW1zKSA9PiB7XG5cblx0XHRcdFx0XHRpZihpdGVtcyAmJiAhdGhpcy5sb2NrKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcblxuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZVdpZGdldChpdGVtKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdHRoaXMubG9jayA9IGZhbHNlO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZSgpO1xuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3QoZGF0YSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRvbkxvZ2luOiBmdW5jdGlvbigpXG5cdHtcblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCQoJyNhbWlfdXNlcl9tZW51X2NvbnRlbnQnKS5odG1sKFxuXHRcdFx0JzxkaXYgY2xhc3M9XCJkcm9wZG93bi1kaXZpZGVyXCI+PC9kaXY+J1xuXHRcdFx0K1xuXHRcdFx0JzxhIGNsYXNzPVwiZHJvcGRvd24taXRlbVwiIGhyZWY9XCJqYXZhc2NyaXB0OnVzZXJEYXNoYm9hcmRBcHAucmVsb2FkMigpO1wiPlJlbG9hZCBEYXNoYm9hcmQ8L2E+J1xuXHRcdFx0K1xuXHRcdFx0JzxhIGNsYXNzPVwiZHJvcGRvd24taXRlbVwiIGhyZWY9XCJqYXZhc2NyaXB0OnVzZXJEYXNoYm9hcmRBcHAucmVmcmVzaDIoKTtcIj5SZWZyZXNoIERhc2hib2FyZDwvYT4nXG5cdFx0XHQrXG5cdFx0XHQnPGEgY2xhc3M9XCJkcm9wZG93bi1pdGVtXCIgaHJlZj1cIicgKyBhbWlXZWJBcHAud2ViQXBwVVJMICsgJz9zdWJhcHA9ZGFzaGJvYXJkQWRtaW5cIiB0YXJnZXQ9XCJfYmxhbmtcIj5FZGl0IERhc2hib2FyZDwvYT4nXG5cdFx0KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHRoaXMucmVsb2FkKCkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG5cblx0XHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cblx0XHRcdH0sIDEwMDAwKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRvbkxvZ291dDogZnVuY3Rpb24oKVxuXHR7XG5cdFx0JCgnI0YyNTE2OTZGX0Q0MkVfRjdGRl84NkY3XzJFNkI0RjJFOEY3NCcpLmVtcHR5KCk7XG5cblx0XHRjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuXG5cdFx0dGhpcy5jb250cm9scyA9IFtdO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRfcmVsb2FkOiBmdW5jdGlvbihyZXN1bHQsIHJvd3MsIGlkeClcblx0e1xuXHRcdGlmKGlkeCA9PT0gcm93cy5sZW5ndGgpXG5cdFx0e1xuXHRcdFx0cmV0dXJuIHJlc3VsdC5yZXNvbHZlKCk7XG5cdFx0fVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCByb3cgPSByb3dzW2lkeF07XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGlkID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5maWVsZHsuQG5hbWU9PT1cImlkXCJ9LiQnLCByb3cpWzBdIHx8ICcnO1xuXHRcdGNvbnN0IGNvbnRyb2wgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwiY29udHJvbFwifS4kJywgcm93KVswXSB8fCAnJztcblx0XHRjb25zdCBwYXJhbXMgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwicGFyYW1zXCJ9LiQnLCByb3cpWzBdIHx8ICdbXSc7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwic2V0dGluZ3NcIn0uJCcsIHJvdylbMF0gfHwgJ3t9Jztcblx0XHRjb25zdCB0cmFuc3BhcmVudCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJ0cmFuc3BhcmVudFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cdFx0Y29uc3QgYXV0b1JlZnJlc2ggPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwiYXV0b1JlZnJlc2hcIn0uJCcsIHJvdylbMF0gfHwgJzEnO1xuXHRcdGNvbnN0IHggPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwieFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cdFx0Y29uc3QgeSA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJ5XCJ9LiQnLCByb3cpWzBdIHx8ICcwJztcblx0XHRjb25zdCB3aWR0aCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJ3aWR0aFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cdFx0Y29uc3QgaGVpZ2h0ID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5maWVsZHsuQG5hbWU9PT1cImhlaWdodFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGl0ZW1fY29udGVudF9jbGF6eiA9IHBhcnNlSW50KHRyYW5zcGFyZW50KSA/ICdncmlkLXN0YWNrLWl0ZW0tY29udGVudCBncmlkLXN0YWNrLWl0ZW0tdHJhbnNwYXJlbnQtY29udGVudCdcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnZ3JpZC1zdGFjay1pdGVtLWNvbnRlbnQgZ3JpZC1zdGFjay1pdGVtLXRyYW5zbHVjZW50LWNvbnRlbnQnXG5cdFx0O1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLmdyaWRzdGFjay5hZGRXaWRnZXQoJChcblx0XHRcdCc8ZGl2IGRhdGEtZ3MtaWQ9XCInICsgaWQgKyAnXCI+JyArXG5cdFx0XHQnICA8ZGl2IGNsYXNzPVwiJyArICBpdGVtX2NvbnRlbnRfY2xhenogICsgJ1wiIGlkPVwiRUI0REY2NzFfMkMzMV9CRUQwXzZCRURfNDQ3OTA1MjVGMjhGXycgKyBpZHggKyAnXCI+PC9kaXY+JyArXG5cdFx0XHQnICA8ZGl2IGNsYXNzPVwiZ3JpZC1zdGFjay1pdGVtLWNsb3NlLWhhbmRsZVwiIGlkPVwiRDA4QjRGMzVfNDlEOF80ODQ0X0Q5RDJfRkI5NTE5NDhBRjE3XycgKyBpZHggKyAnXCI+PC9kaXY+JyArXG5cdFx0XHQnPC9kaXY+J1xuXHRcdCksIHgsIHksIHdpZHRoLCBoZWlnaHQpLnByb21pc2UoKS5kb25lKCgpID0+IHtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0JCgnI0QwOEI0RjM1XzQ5RDhfNDg0NF9EOUQyX0ZCOTUxOTQ4QUYxN18nICsgaWR4KS5jbGljaygoZSkgPT4ge1xuXG5cdFx0XHRcdGNvbnN0IGVsID0gJChlLmN1cnJlbnRUYXJnZXQpLnBhcmVudCgpO1xuXG5cdFx0XHRcdHRoaXMucmVtb3ZlV2lkZ2V0KGVsLmRhdGEoJ19ncmlkc3RhY2tfbm9kZScpKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHRcdGVsLnJlbW92ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0cnlcblx0XHRcdHtcblx0XHRcdFx0YW1pV2ViQXBwLmNyZWF0ZUNvbnRyb2wodGhpcywgdGhpcywgY29udHJvbCwgWycjRUI0REY2NzFfMkMzMV9CRUQwXzZCRURfNDQ3OTA1MjVGMjhGXycgKyBpZHhdLmNvbmNhdChKU09OLnBhcnNlKHBhcmFtcyksIEpTT04ucGFyc2Uoc2V0dGluZ3MpKSkuZG9uZSgoY29udHJvbCkgPT4ge1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHRjb250cm9sLmF1dG9SZWZyZXNoID0gcGFyc2VJbnQoYXV0b1JlZnJlc2gpO1xuXG5cdFx0XHRcdFx0dGhpcy5jb250cm9scy5wdXNoKGNvbnRyb2wpO1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHR0aGlzLl9yZWxvYWQocmVzdWx0LCByb3dzLCBpZHggKyAxKTtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdH0pLmZhaWwoKG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0YW1pV2ViQXBwLmVycm9yKCdGb3Igd2lkZ2V0IGAnICsgaWQgKyAnYDogJyArIG1lc3NhZ2UpO1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHR0aGlzLl9yZWxvYWQocmVzdWx0LCByb3dzLCBpZHggKyAxKTtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGNhdGNoKGUpXG5cdFx0XHR7XG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRhbWlXZWJBcHAuZXJyb3IoJ0ZvciB3aWRnZXQgYCcgKyBpZCArICdgOiAnICsgZS5tZXNzYWdlKTtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0dGhpcy5fcmVsb2FkKHJlc3VsdCwgcm93cywgaWR4ICsgMSk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0fVxuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZWxvYWQ6IGZ1bmN0aW9uKClcblx0e1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0YW1pQ29tbWFuZC5leGVjdXRlKCdHZXREYXNoYm9hcmRJbmZvJykuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0aGlzLmdyaWRzdGFjay5yZW1vdmVBbGwoKTtcblxuXHRcdFx0dGhpcy5jb250cm9scyA9IFtdO1xuXG5cdFx0XHR0aGlzLmxvY2sgPSB0cnVlO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0aGlzLl9yZWxvYWQoJC5EZWZlcnJlZCgpLCBhbWlXZWJBcHAuanNwYXRoKCcuLnJvdycsIGRhdGEpLCAwKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHR0aGlzLnJlZnJlc2goKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHRcdHRoaXMubG9jayA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0cmVzdWx0LnJlc29sdmUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdH0pLmZhaWwoKGRhdGEsIG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0cmVzdWx0LnJlamVjdChtZXNzYWdlKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0cmVsb2FkMjogZnVuY3Rpb24oKVxuXHR7XG5cdFx0YW1pV2ViQXBwLmxvY2soKTtcblxuXHRcdHRoaXMucmVsb2FkKCkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC51bmxvY2soLyotLS0qLyk7XG5cblx0XHR9KS5mYWlsKChtZXNzYWdlKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC5lcnJvcihtZXNzYWdlKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0cmVmcmVzaDogZnVuY3Rpb24oKVxuXHR7XG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLmNvbnRyb2xzLmZvckVhY2goKGNvbnRyb2wpID0+IHtcblxuXHRcdFx0aWYoY29udHJvbC5hdXRvUmVmcmVzaCAhPT0gMCAmJiBjb250cm9sLnJlZnJlc2gpXG5cdFx0XHR7XG5cdFx0XHRcdGNvbnRyb2wucmVmcmVzaCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gJC5EZWZlcnJlZCgpLnJlc29sdmUoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZWZyZXNoMjogZnVuY3Rpb24oKVxuXHR7XG5cdFx0YW1pV2ViQXBwLmxvY2soKTtcblxuXHRcdHRoaXMucmVmcmVzaCgpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRhbWlXZWJBcHAudW5sb2NrKC8qLS0tKi8pO1xuXG5cdFx0fSkuZmFpbCgobWVzc2FnZSkgPT4ge1xuXG5cdFx0XHRhbWlXZWJBcHAuZXJyb3IobWVzc2FnZSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHVwZGF0ZVdpZGdldDogZnVuY3Rpb24oaXRlbSlcblx0e1xuXHRcdGFtaVdlYkFwcC5sb2NrKCk7XG5cblx0XHRyZXR1cm4gYW1pQ29tbWFuZC5leGVjdXRlKCdVcGRhdGVXaWRnZXQgLWlkPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9TdHJpbmcoaXRlbS5pZCkgKyAnXCIgLXg9XCInICsgaXRlbS54ICsgJ1wiIC15PVwiJyArIGl0ZW0ueSArICdcIiAtd2lkdGg9XCInICsgaXRlbS53aWR0aCArICdcIiAtaGVpZ2h0PVwiJyArIGl0ZW0uaGVpZ2h0ICsgJ1wiJykuZG9uZSgoKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC51bmxvY2soKTtcblxuXHRcdH0pLmZhaWwoKGRhdGEsIG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0YW1pV2ViQXBwLmVycm9yKG1lc3NhZ2UpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZW1vdmVXaWRnZXQ6IGZ1bmN0aW9uKGl0ZW0pXG5cdHtcblx0XHRhbWlXZWJBcHAubG9jaygpO1xuXG5cdFx0cmV0dXJuIGFtaUNvbW1hbmQuZXhlY3V0ZSgnUmVtb3ZlV2lkZ2V0IC1pZD1cIicgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKGl0ZW0uaWQpICsgJ1wiJykuZG9uZSgoKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC51bmxvY2soKTtcblxuXHRcdH0pLmZhaWwoKGRhdGEsIG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0YW1pV2ViQXBwLmVycm9yKG1lc3NhZ2UpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuLyogR0xPQkFMIElOU1RBTkNFICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbnZhciB1c2VyRGFzaGJvYXJkQXBwID0gbmV3IFVzZXJEYXNoYm9hcmRBcHAoKTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiJdfQ==
