/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-XXXX The AMI Team / LPSC / CNRS
 *
 * This file must be used under the terms of the CeCILL-C:
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-fr.html
 *
 */$AMIClass("UserDashboardApp",{$extends:ami.SubApp,onReady:function onReady(){var _this=this;var result=$.Deferred();amiWebApp.loadResources(["subapps/UserDashboard/css/UserDashboardApp.css","subapps/UserDashboard/twig/UserDashboardApp.twig","subapps/UserDashboard/js/jquery-ui.min.js",amiWebApp.originURL+"/subapps/UserDashboard/js/gridstack.min.css",amiWebApp.originURL+"/subapps/UserDashboard/js/gridstack.all.js"]).done(function(data){amiWebApp.replaceHTML("#ami_main_content",data[1]).done(function(){var el=$("#F251696F_D42E_F7FF_86F7_2E6B4F2E8F74");var settings={float:true,cellHeight:36,verticalMargin:12,width:12};_this.gridstack=el.gridstack(settings).data("gridstack");el.on("change",function(e,items){if(items&&!_this.lock){items.forEach(function(item){_this.updateWidget(item)})}});_this.lock=false;result.resolve()})}).fail(function(data){result.reject(data)});return result},onLogin:function onLogin(){var _this2=this;$("#ami_user_menu_content").html("<div class=\"dropdown-divider\"></div>"+"<a class=\"dropdown-item\" href=\"javascript:userDashboardApp.reload2();\">Reload Dashboard</a>"+"<a class=\"dropdown-item\" href=\"javascript:userDashboardApp.refresh2();\">Refresh Dashboard</a>"+"<a class=\"dropdown-item\" href=\""+amiWebApp.webAppURL+"?subapp=dashboardAdmin\" target=\"_blank\">Edit Dashboard</a>");return this.reload().done(function(){_this2.interval=setInterval(function(){_this2.refresh()},10000)})},onLogout:function onLogout(){$("#F251696F_D42E_F7FF_86F7_2E6B4F2E8F74").empty();clearInterval(this.interval);this.controls=[]},_reload:function _reload(result,rows,idx){var _this3=this;if(idx===rows.length){return result.resolve()}var row=rows[idx];var id=amiWebApp.jspath("..field{.@name===\"id\"}.$",row)[0]||"";var control=amiWebApp.jspath("..field{.@name===\"control\"}.$",row)[0]||"";var params=amiWebApp.jspath("..field{.@name===\"params\"}.$",row)[0]||"[]";var settings=amiWebApp.jspath("..field{.@name===\"settings\"}.$",row)[0]||"{}";var transparent=amiWebApp.jspath("..field{.@name===\"transparent\"}.$",row)[0]||"0";var autoRefresh=amiWebApp.jspath("..field{.@name===\"autoRefresh\"}.$",row)[0]||"1";var x=amiWebApp.jspath("..field{.@name===\"x\"}.$",row)[0]||"0";var y=amiWebApp.jspath("..field{.@name===\"y\"}.$",row)[0]||"0";var width=amiWebApp.jspath("..field{.@name===\"width\"}.$",row)[0]||"0";var height=amiWebApp.jspath("..field{.@name===\"height\"}.$",row)[0]||"0";var item_content_clazz=parseInt(transparent)?"grid-stack-item-content grid-stack-item-transparent-content":"grid-stack-item-content grid-stack-item-translucent-content";this.gridstack.addWidget($("<div data-gs-id=\""+id+"\">"+"  <div class=\""+item_content_clazz+"\" id=\"EB4DF671_2C31_BED0_6BED_44790525F28F_"+idx+"\"></div>"+"  <div class=\"grid-stack-item-close-handle\" id=\"D08B4F35_49D8_4844_D9D2_FB951948AF17_"+idx+"\"></div>"+"</div>"),x,y,width,height).promise().done(function(){$("#D08B4F35_49D8_4844_D9D2_FB951948AF17_"+idx).click(function(e){var el=$(e.currentTarget).parent();_this3.removeWidget(el.data("_gridstack_node")).done(function(){el.remove()})});try{amiWebApp.createControl(_this3,_this3,control,["#EB4DF671_2C31_BED0_6BED_44790525F28F_"+idx].concat(JSON.parse(params),JSON.parse(settings))).done(function(control){control.autoRefresh=parseInt(autoRefresh);_this3.controls.push(control);_this3._reload(result,rows,idx+1)}).fail(function(message){amiWebApp.error("For widget `"+id+"`: "+message);_this3._reload(result,rows,idx+1)})}catch(e){amiWebApp.error("For widget `"+id+"`: "+e.message);_this3._reload(result,rows,idx+1)}});return result},reload:function reload(){var _this4=this;var result=$.Deferred();amiCommand.execute("GetDashboardInfo").done(function(data){_this4.gridstack.removeAll();_this4.controls=[];_this4.lock=true;_this4._reload($.Deferred(),amiWebApp.jspath("..row",data),0).done(function(){_this4.refresh().done(function(){_this4.lock=false;result.resolve()})})}).fail(function(data,message){result.reject(message)});return result},reload2:function reload2(){amiWebApp.lock();this.reload().done(function(){amiWebApp.unlock()}).fail(function(message){amiWebApp.error(message)})},refresh:function refresh(){this.controls.forEach(function(control){if(control.autoRefresh!==0&&control.refresh){control.refresh()}});return $.Deferred().resolve()},refresh2:function refresh2(){amiWebApp.lock();this.refresh().done(function(){amiWebApp.unlock()}).fail(function(message){amiWebApp.error(message)})},updateWidget:function updateWidget(item){amiWebApp.lock();return amiCommand.execute("UpdateWidget -id=\""+amiWebApp.textToString(item.id)+"\" -x=\""+item.x+"\" -y=\""+item.y+"\" -width=\""+item.width+"\" -height=\""+item.height+"\"").done(function(){amiWebApp.unlock()}).fail(function(data,message){amiWebApp.error(message)})},removeWidget:function removeWidget(item){amiWebApp.lock();return amiCommand.execute("RemoveWidget -id=\""+amiWebApp.textToString(item.id)+"\"").done(function(){amiWebApp.unlock()}).fail(function(data,message){amiWebApp.error(message)})}});var userDashboardApp=new UserDashboardApp;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJEYXNoYm9hcmRBcHAuZXM2LmpzIl0sIm5hbWVzIjpbIiRBTUlDbGFzcyIsIiRleHRlbmRzIiwiYW1pIiwiU3ViQXBwIiwib25SZWFkeSIsInJlc3VsdCIsIiQiLCJEZWZlcnJlZCIsImFtaVdlYkFwcCIsImxvYWRSZXNvdXJjZXMiLCJvcmlnaW5VUkwiLCJkb25lIiwiZGF0YSIsInJlcGxhY2VIVE1MIiwiZWwiLCJzZXR0aW5ncyIsImZsb2F0IiwiY2VsbEhlaWdodCIsInZlcnRpY2FsTWFyZ2luIiwid2lkdGgiLCJncmlkc3RhY2siLCJvbiIsImUiLCJpdGVtcyIsImxvY2siLCJmb3JFYWNoIiwiaXRlbSIsInVwZGF0ZVdpZGdldCIsInJlc29sdmUiLCJmYWlsIiwicmVqZWN0Iiwib25Mb2dpbiIsImh0bWwiLCJ3ZWJBcHBVUkwiLCJyZWxvYWQiLCJpbnRlcnZhbCIsInNldEludGVydmFsIiwicmVmcmVzaCIsIm9uTG9nb3V0IiwiZW1wdHkiLCJjbGVhckludGVydmFsIiwiY29udHJvbHMiLCJfcmVsb2FkIiwicm93cyIsImlkeCIsImxlbmd0aCIsInJvdyIsImlkIiwianNwYXRoIiwiY29udHJvbCIsInBhcmFtcyIsInRyYW5zcGFyZW50IiwiYXV0b1JlZnJlc2giLCJ4IiwieSIsImhlaWdodCIsIml0ZW1fY29udGVudF9jbGF6eiIsInBhcnNlSW50IiwiYWRkV2lkZ2V0IiwicHJvbWlzZSIsImNsaWNrIiwiY3VycmVudFRhcmdldCIsInBhcmVudCIsInJlbW92ZVdpZGdldCIsInJlbW92ZSIsImNyZWF0ZUNvbnRyb2wiLCJjb25jYXQiLCJKU09OIiwicGFyc2UiLCJwdXNoIiwibWVzc2FnZSIsImVycm9yIiwiYW1pQ29tbWFuZCIsImV4ZWN1dGUiLCJyZW1vdmVBbGwiLCJyZWxvYWQyIiwidW5sb2NrIiwicmVmcmVzaDIiLCJ0ZXh0VG9TdHJpbmciLCJ1c2VyRGFzaGJvYXJkQXBwIiwiVXNlckRhc2hib2FyZEFwcCJdLCJtYXBwaW5ncyI6IkFB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QUlTLENBQUFBLGdCQUFnQixDQUFHLEdBQUlDLENBQUFBLGdCQUEzQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQU1JIFdlYiBGcmFtZXdvcmtcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtWFhYWCBUaGUgQU1JIFRlYW0gLyBMUFNDIC8gQ05SU1xuICpcbiAqIFRoaXMgZmlsZSBtdXN0IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBDZUNJTEwtQzpcbiAqIGh0dHA6Ly93d3cuY2VjaWxsLmluZm8vbGljZW5jZXMvTGljZW5jZV9DZUNJTEwtQ19WMS1lbi5odG1sXG4gKiBodHRwOi8vd3d3LmNlY2lsbC5pbmZvL2xpY2VuY2VzL0xpY2VuY2VfQ2VDSUxMLUNfVjEtZnIuaHRtbFxuICpcbiAqL1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4kQU1JQ2xhc3MoJ1VzZXJEYXNoYm9hcmRBcHAnLCB7XG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQkZXh0ZW5kczogYW1pLlN1YkFwcCxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0b25SZWFkeTogZnVuY3Rpb24oKVxuXHR7XG5cdFx0Y29uc3QgcmVzdWx0ID0gJC5EZWZlcnJlZCgpO1xuXG5cdFx0YW1pV2ViQXBwLmxvYWRSZXNvdXJjZXMoW1xuXHRcdFx0J3N1YmFwcHMvVXNlckRhc2hib2FyZC9jc3MvVXNlckRhc2hib2FyZEFwcC5jc3MnLFxuXHRcdFx0J3N1YmFwcHMvVXNlckRhc2hib2FyZC90d2lnL1VzZXJEYXNoYm9hcmRBcHAudHdpZycsXG5cdFx0XHQvKiovXG5cdFx0XHQnc3ViYXBwcy9Vc2VyRGFzaGJvYXJkL2pzL2pxdWVyeS11aS5taW4uanMnLFxuXHRcdFx0LyoqL1xuXHRcdFx0YW1pV2ViQXBwLm9yaWdpblVSTCArICcvc3ViYXBwcy9Vc2VyRGFzaGJvYXJkL2pzL2dyaWRzdGFjay5taW4uY3NzJyxcblx0XHRcdGFtaVdlYkFwcC5vcmlnaW5VUkwgKyAnL3N1YmFwcHMvVXNlckRhc2hib2FyZC9qcy9ncmlkc3RhY2suYWxsLmpzJyxcblx0XHRdKS5kb25lKChkYXRhKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC5yZXBsYWNlSFRNTCgnI2FtaV9tYWluX2NvbnRlbnQnLCBkYXRhWzFdKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0Y29uc3QgZWwgPSAkKCcjRjI1MTY5NkZfRDQyRV9GN0ZGXzg2RjdfMkU2QjRGMkU4Rjc0Jyk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdGNvbnN0IHNldHRpbmdzID0ge1xuXHRcdFx0XHRcdGZsb2F0OiB0cnVlLFxuXHRcdFx0XHRcdGNlbGxIZWlnaHQ6IDM2LFxuXHRcdFx0XHRcdHZlcnRpY2FsTWFyZ2luOiAxMixcblx0XHRcdFx0XHR3aWR0aDogMTIsXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dGhpcy5ncmlkc3RhY2sgPSBlbC5ncmlkc3RhY2soc2V0dGluZ3MpLmRhdGEoJ2dyaWRzdGFjaycpO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRlbC5vbignY2hhbmdlJywgKGUsIGl0ZW1zKSA9PiB7XG5cblx0XHRcdFx0XHRpZihpdGVtcyAmJiAhdGhpcy5sb2NrKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcblxuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZVdpZGdldChpdGVtKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdHRoaXMubG9jayA9IGZhbHNlO1xuXG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRyZXN1bHQucmVzb2x2ZSgpO1xuXHRcdFx0fSk7XG5cblx0XHR9KS5mYWlsKChkYXRhKSA9PiB7XG5cblx0XHRcdHJlc3VsdC5yZWplY3QoZGF0YSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRvbkxvZ2luOiBmdW5jdGlvbigpXG5cdHtcblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCQoJyNhbWlfdXNlcl9tZW51X2NvbnRlbnQnKS5odG1sKFxuXHRcdFx0JzxkaXYgY2xhc3M9XCJkcm9wZG93bi1kaXZpZGVyXCI+PC9kaXY+J1xuXHRcdFx0K1xuXHRcdFx0JzxhIGNsYXNzPVwiZHJvcGRvd24taXRlbVwiIGhyZWY9XCJqYXZhc2NyaXB0OnVzZXJEYXNoYm9hcmRBcHAucmVsb2FkMigpO1wiPlJlbG9hZCBEYXNoYm9hcmQ8L2E+J1xuXHRcdFx0K1xuXHRcdFx0JzxhIGNsYXNzPVwiZHJvcGRvd24taXRlbVwiIGhyZWY9XCJqYXZhc2NyaXB0OnVzZXJEYXNoYm9hcmRBcHAucmVmcmVzaDIoKTtcIj5SZWZyZXNoIERhc2hib2FyZDwvYT4nXG5cdFx0XHQrXG5cdFx0XHQnPGEgY2xhc3M9XCJkcm9wZG93bi1pdGVtXCIgaHJlZj1cIicgKyBhbWlXZWJBcHAud2ViQXBwVVJMICsgJz9zdWJhcHA9ZGFzaGJvYXJkQWRtaW5cIiB0YXJnZXQ9XCJfYmxhbmtcIj5FZGl0IERhc2hib2FyZDwvYT4nXG5cdFx0KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHRoaXMucmVsb2FkKCkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG5cblx0XHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cblx0XHRcdH0sIDEwMDAwKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRvbkxvZ291dDogZnVuY3Rpb24oKVxuXHR7XG5cdFx0JCgnI0YyNTE2OTZGX0Q0MkVfRjdGRl84NkY3XzJFNkI0RjJFOEY3NCcpLmVtcHR5KCk7XG5cblx0XHRjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuXG5cdFx0dGhpcy5jb250cm9scyA9IFtdO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRfcmVsb2FkOiBmdW5jdGlvbihyZXN1bHQsIHJvd3MsIGlkeClcblx0e1xuXHRcdGlmKGlkeCA9PT0gcm93cy5sZW5ndGgpXG5cdFx0e1xuXHRcdFx0cmV0dXJuIHJlc3VsdC5yZXNvbHZlKCk7XG5cdFx0fVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRjb25zdCByb3cgPSByb3dzW2lkeF07XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGlkID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5maWVsZHsuQG5hbWU9PT1cImlkXCJ9LiQnLCByb3cpWzBdIHx8ICcnO1xuXHRcdGNvbnN0IGNvbnRyb2wgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwiY29udHJvbFwifS4kJywgcm93KVswXSB8fCAnJztcblx0XHRjb25zdCBwYXJhbXMgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwicGFyYW1zXCJ9LiQnLCByb3cpWzBdIHx8ICdbXSc7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwic2V0dGluZ3NcIn0uJCcsIHJvdylbMF0gfHwgJ3t9Jztcblx0XHRjb25zdCB0cmFuc3BhcmVudCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJ0cmFuc3BhcmVudFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cdFx0Y29uc3QgYXV0b1JlZnJlc2ggPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwiYXV0b1JlZnJlc2hcIn0uJCcsIHJvdylbMF0gfHwgJzEnO1xuXHRcdGNvbnN0IHggPSBhbWlXZWJBcHAuanNwYXRoKCcuLmZpZWxkey5AbmFtZT09PVwieFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cdFx0Y29uc3QgeSA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJ5XCJ9LiQnLCByb3cpWzBdIHx8ICcwJztcblx0XHRjb25zdCB3aWR0aCA9IGFtaVdlYkFwcC5qc3BhdGgoJy4uZmllbGR7LkBuYW1lPT09XCJ3aWR0aFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cdFx0Y29uc3QgaGVpZ2h0ID0gYW1pV2ViQXBwLmpzcGF0aCgnLi5maWVsZHsuQG5hbWU9PT1cImhlaWdodFwifS4kJywgcm93KVswXSB8fCAnMCc7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdGNvbnN0IGl0ZW1fY29udGVudF9jbGF6eiA9IHBhcnNlSW50KHRyYW5zcGFyZW50KSA/ICdncmlkLXN0YWNrLWl0ZW0tY29udGVudCBncmlkLXN0YWNrLWl0ZW0tdHJhbnNwYXJlbnQtY29udGVudCdcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnZ3JpZC1zdGFjay1pdGVtLWNvbnRlbnQgZ3JpZC1zdGFjay1pdGVtLXRyYW5zbHVjZW50LWNvbnRlbnQnXG5cdFx0O1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLmdyaWRzdGFjay5hZGRXaWRnZXQoJChcblx0XHRcdCc8ZGl2IGRhdGEtZ3MtaWQ9XCInICsgaWQgKyAnXCI+JyArXG5cdFx0XHQnICA8ZGl2IGNsYXNzPVwiJyArICBpdGVtX2NvbnRlbnRfY2xhenogICsgJ1wiIGlkPVwiRUI0REY2NzFfMkMzMV9CRUQwXzZCRURfNDQ3OTA1MjVGMjhGXycgKyBpZHggKyAnXCI+PC9kaXY+JyArXG5cdFx0XHQnICA8ZGl2IGNsYXNzPVwiZ3JpZC1zdGFjay1pdGVtLWNsb3NlLWhhbmRsZVwiIGlkPVwiRDA4QjRGMzVfNDlEOF80ODQ0X0Q5RDJfRkI5NTE5NDhBRjE3XycgKyBpZHggKyAnXCI+PC9kaXY+JyArXG5cdFx0XHQnPC9kaXY+J1xuXHRcdCksIHgsIHksIHdpZHRoLCBoZWlnaHQpLnByb21pc2UoKS5kb25lKCgpID0+IHtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0JCgnI0QwOEI0RjM1XzQ5RDhfNDg0NF9EOUQyX0ZCOTUxOTQ4QUYxN18nICsgaWR4KS5jbGljaygoZSkgPT4ge1xuXG5cdFx0XHRcdGNvbnN0IGVsID0gJChlLmN1cnJlbnRUYXJnZXQpLnBhcmVudCgpO1xuXG5cdFx0XHRcdHRoaXMucmVtb3ZlV2lkZ2V0KGVsLmRhdGEoJ19ncmlkc3RhY2tfbm9kZScpKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHRcdGVsLnJlbW92ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0cnlcblx0XHRcdHtcblx0XHRcdFx0YW1pV2ViQXBwLmNyZWF0ZUNvbnRyb2wodGhpcywgdGhpcywgY29udHJvbCwgWycjRUI0REY2NzFfMkMzMV9CRUQwXzZCRURfNDQ3OTA1MjVGMjhGXycgKyBpZHhdLmNvbmNhdChKU09OLnBhcnNlKHBhcmFtcyksIEpTT04ucGFyc2Uoc2V0dGluZ3MpKSkuZG9uZSgoY29udHJvbCkgPT4ge1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHRjb250cm9sLmF1dG9SZWZyZXNoID0gcGFyc2VJbnQoYXV0b1JlZnJlc2gpO1xuXG5cdFx0XHRcdFx0dGhpcy5jb250cm9scy5wdXNoKGNvbnRyb2wpO1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHR0aGlzLl9yZWxvYWQocmVzdWx0LCByb3dzLCBpZHggKyAxKTtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdH0pLmZhaWwoKG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0YW1pV2ViQXBwLmVycm9yKCdGb3Igd2lkZ2V0IGAnICsgaWQgKyAnYDogJyArIG1lc3NhZ2UpO1xuXG5cdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHR0aGlzLl9yZWxvYWQocmVzdWx0LCByb3dzLCBpZHggKyAxKTtcblxuXHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGNhdGNoKGUpXG5cdFx0XHR7XG5cdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRhbWlXZWJBcHAuZXJyb3IoJ0ZvciB3aWRnZXQgYCcgKyBpZCArICdgOiAnICsgZS5tZXNzYWdlKTtcblxuXHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0dGhpcy5fcmVsb2FkKHJlc3VsdCwgcm93cywgaWR4ICsgMSk7XG5cblx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdFx0fVxuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZWxvYWQ6IGZ1bmN0aW9uKClcblx0e1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0YW1pQ29tbWFuZC5leGVjdXRlKCdHZXREYXNoYm9hcmRJbmZvJykuZG9uZSgoZGF0YSkgPT4ge1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0aGlzLmdyaWRzdGFjay5yZW1vdmVBbGwoKTtcblxuXHRcdFx0dGhpcy5jb250cm9scyA9IFtdO1xuXG5cdFx0XHR0aGlzLmxvY2sgPSB0cnVlO1xuXG5cdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHR0aGlzLl9yZWxvYWQoJC5EZWZlcnJlZCgpLCBhbWlXZWJBcHAuanNwYXRoKCcuLnJvdycsIGRhdGEpLCAwKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHR0aGlzLnJlZnJlc2goKS5kb25lKCgpID0+IHtcblxuXHRcdFx0XHRcdHRoaXMubG9jayA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0cmVzdWx0LnJlc29sdmUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdH0pLmZhaWwoKGRhdGEsIG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0cmVzdWx0LnJlamVjdChtZXNzYWdlKTtcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0cmVsb2FkMjogZnVuY3Rpb24oKVxuXHR7XG5cdFx0YW1pV2ViQXBwLmxvY2soKTtcblxuXHRcdHRoaXMucmVsb2FkKCkuZG9uZSgoKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC51bmxvY2soLyotLS0qLyk7XG5cblx0XHR9KS5mYWlsKChtZXNzYWdlKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC5lcnJvcihtZXNzYWdlKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0cmVmcmVzaDogZnVuY3Rpb24oKVxuXHR7XG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHR0aGlzLmNvbnRyb2xzLmZvckVhY2goKGNvbnRyb2wpID0+IHtcblxuXHRcdFx0aWYoY29udHJvbC5hdXRvUmVmcmVzaCAhPT0gMCAmJiBjb250cm9sLnJlZnJlc2gpXG5cdFx0XHR7XG5cdFx0XHRcdGNvbnRyb2wucmVmcmVzaCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRyZXR1cm4gJC5EZWZlcnJlZCgpLnJlc29sdmUoKTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZWZyZXNoMjogZnVuY3Rpb24oKVxuXHR7XG5cdFx0YW1pV2ViQXBwLmxvY2soKTtcblxuXHRcdHRoaXMucmVmcmVzaCgpLmRvbmUoKCkgPT4ge1xuXG5cdFx0XHRhbWlXZWJBcHAudW5sb2NrKC8qLS0tKi8pO1xuXG5cdFx0fSkuZmFpbCgobWVzc2FnZSkgPT4ge1xuXG5cdFx0XHRhbWlXZWJBcHAuZXJyb3IobWVzc2FnZSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdHVwZGF0ZVdpZGdldDogZnVuY3Rpb24oaXRlbSlcblx0e1xuXHRcdGFtaVdlYkFwcC5sb2NrKCk7XG5cblx0XHRyZXR1cm4gYW1pQ29tbWFuZC5leGVjdXRlKCdVcGRhdGVXaWRnZXQgLWlkPVwiJyArIGFtaVdlYkFwcC50ZXh0VG9TdHJpbmcoaXRlbS5pZCkgKyAnXCIgLXg9XCInICsgaXRlbS54ICsgJ1wiIC15PVwiJyArIGl0ZW0ueSArICdcIiAtd2lkdGg9XCInICsgaXRlbS53aWR0aCArICdcIiAtaGVpZ2h0PVwiJyArIGl0ZW0uaGVpZ2h0ICsgJ1wiJykuZG9uZSgoKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC51bmxvY2soKTtcblxuXHRcdH0pLmZhaWwoKGRhdGEsIG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0YW1pV2ViQXBwLmVycm9yKG1lc3NhZ2UpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRyZW1vdmVXaWRnZXQ6IGZ1bmN0aW9uKGl0ZW0pXG5cdHtcblx0XHRhbWlXZWJBcHAubG9jaygpO1xuXG5cdFx0cmV0dXJuIGFtaUNvbW1hbmQuZXhlY3V0ZSgnUmVtb3ZlV2lkZ2V0IC1pZD1cIicgKyBhbWlXZWJBcHAudGV4dFRvU3RyaW5nKGl0ZW0uaWQpICsgJ1wiJykuZG9uZSgoKSA9PiB7XG5cblx0XHRcdGFtaVdlYkFwcC51bmxvY2soKTtcblxuXHRcdH0pLmZhaWwoKGRhdGEsIG1lc3NhZ2UpID0+IHtcblxuXHRcdFx0YW1pV2ViQXBwLmVycm9yKG1lc3NhZ2UpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuLyogR0xPQkFMIElOU1RBTkNFICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbnZhciB1c2VyRGFzaGJvYXJkQXBwID0gbmV3IFVzZXJEYXNoYm9hcmRBcHAoKTtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiJdfQ==
