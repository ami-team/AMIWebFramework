<link rel="stylesheet" type="text/css" href="docs/api/css/AMI-template.css"></link>

<div class="row">

  <nav class="col-md-3">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">AMI Web framework API</h3>
      </div>
      <div class="panel-body jsdoc-menu">
        <h4><a href="index.html">Home</a></h4><h4>Classes</h4><ul><li><a href="?subapp=amiDocument&userdata=api/AMITwigExprCompiler.html">AMITwigExprCompiler</a></li></ul><h4>Events</h4><ul><li><a href="?subapp=amiDocument&userdata=api/amiWebApp.html#event:onStart">onStart</a></li><li><a href="?subapp=amiDocument&userdata=api/amiWebApp.html#event:onToolbarUpdateNeeded">onToolbarUpdateNeeded</a></li></ul><h4>Namespaces</h4><ul><li><a href="?subapp=amiDocument&userdata=api/amiCommand.html">amiCommand</a></li><li><a href="?subapp=amiDocument&userdata=api/amiLogin.html">amiLogin</a></li><li><a href="?subapp=amiDocument&userdata=api/amiTokenizer.html">amiTokenizer</a></li><li><a href="?subapp=amiDocument&userdata=api/amiTwigExprInterpreter.html">amiTwigExprInterpreter</a></li><li><a href="?subapp=amiDocument&userdata=api/amiWebApp.html">amiWebApp</a></li></ul><h4>Interfaces</h4><ul><li><a href="?subapp=amiDocument&userdata=api/AMISubApp.html">AMISubApp</a></li></ul><h4>Global</h4><ul><li><a href="?subapp=amiDocument&userdata=api/global.html#amiRegisterSubApp">amiRegisterSubApp</a></li></ul>
      </div>
    </div>
  </nav>

  <div class="col-md-9 jsdoc-content">
    <h1>Source: AMITokenizer.js</h1>
    



    
<section>
  <article>
    <pre class="ami-code"><code><i class="line-number"></i>/*!
<i class="line-number"></i> * AMI Web Framework
<i class="line-number"></i> *
<i class="line-number"></i> * Copyright (c) 2014-2015 The AMI Team
<i class="line-number"></i> * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
<i class="line-number"></i> *
<i class="line-number"></i> */
<i class="line-number"></i>
<i class="line-number"></i>/*-------------------------------------------------------------------------*/
<i class="line-number"></i>/* amiTokenizer                                                            */
<i class="line-number"></i>/*-------------------------------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>/**
<i class="line-number"></i> * The AMI tokenizer
<i class="line-number"></i> * @namespace amiTokenizer
<i class="line-number"></i> */
<i class="line-number"></i>
<i class="line-number"></i>$AMINamespace('amiTokenizer', /** @lends amiTokenizer# */ {
<i class="line-number"></i>	/*-----------------------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>	/**
<i class="line-number"></i>	  * Tokenize a string
<i class="line-number"></i>	  * @param {String} code the code
<i class="line-number"></i>	  * @param {Number} line the line
<i class="line-number"></i>	  * @param {Array} spaces the array of characters for spaces
<i class="line-number"></i>	  * @param {Array} kwords the array of kerwords
<i class="line-number"></i>	  * @param {Array} quotes the array of characters for string declaration
<i class="line-number"></i>	  * @param {String} [escape='\\'] the escape character
<i class="line-number"></i>	  * @returns {Array&lt;String>} The array of tokens
<i class="line-number"></i>	  * @throws {String} The error description
<i class="line-number"></i>	  */
<i class="line-number"></i>
<i class="line-number"></i>	tokenize: function(code, line, spaces, kwords, quotes, escape)
<i class="line-number"></i>	{
<i class="line-number"></i>		if(!spaces) spaces = [];
<i class="line-number"></i>		if(!kwords) kwords = [];
<i class="line-number"></i>		if(!quotes) quotes = [];
<i class="line-number"></i>		if(!escape) escape = '\\';
<i class="line-number"></i>
<i class="line-number"></i>		var result_tokens = [];
<i class="line-number"></i>		var result_lines = [];
<i class="line-number"></i>
<i class="line-number"></i>		var i = 0x000000000;
<i class="line-number"></i>		var l = code.length;
<i class="line-number"></i>
<i class="line-number"></i>		var word = '';
<i class="line-number"></i>		var found;
<i class="line-number"></i>
<i class="line-number"></i>		while(i &lt; l)
<i class="line-number"></i>		{
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>			/* COUNT LINES                                     */
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>			if(code[i] === '\n')
<i class="line-number"></i>			{
<i class="line-number"></i>				line++;
<i class="line-number"></i>			}
<i class="line-number"></i>
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>			/* EAT SPACES                                      */
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>			if(spaces.indexOf(code[i]) >= 0)
<i class="line-number"></i>			{
<i class="line-number"></i>				if(word)
<i class="line-number"></i>				{
<i class="line-number"></i>					result_tokens.push(word);
<i class="line-number"></i>					result_lines.push(line);
<i class="line-number"></i>					word = '';
<i class="line-number"></i>				}
<i class="line-number"></i>
<i class="line-number"></i>				i++;
<i class="line-number"></i>
<i class="line-number"></i>				continue;
<i class="line-number"></i>			}
<i class="line-number"></i>
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>			/* EAT KWORDS                                      */
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>			found = false;
<i class="line-number"></i>
<i class="line-number"></i>			for(var idx in kwords)
<i class="line-number"></i>			{
<i class="line-number"></i>				kword = kwords[idx];
<i class="line-number"></i>
<i class="line-number"></i>				if(code.substring(i).indexOf(kword) === 0)
<i class="line-number"></i>				{
<i class="line-number"></i>					if(word)
<i class="line-number"></i>					{
<i class="line-number"></i>						result_tokens.push(word);
<i class="line-number"></i>						result_lines.push(line);
<i class="line-number"></i>						word = '';
<i class="line-number"></i>					}
<i class="line-number"></i>
<i class="line-number"></i>					var j = i + kword.length;
<i class="line-number"></i>
<i class="line-number"></i>					result_tokens.push(code.substring(i, j));
<i class="line-number"></i>					result_lines.push(line);
<i class="line-number"></i>
<i class="line-number"></i>					i = j;
<i class="line-number"></i>
<i class="line-number"></i>					found = true;
<i class="line-number"></i>					break;
<i class="line-number"></i>				}
<i class="line-number"></i>			}
<i class="line-number"></i>
<i class="line-number"></i>			if(found)
<i class="line-number"></i>			{
<i class="line-number"></i>				continue;
<i class="line-number"></i>			}
<i class="line-number"></i>
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>			/* EAT STRINGS                                     */
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>			found = false;
<i class="line-number"></i>
<i class="line-number"></i>			for(var idx in quotes)
<i class="line-number"></i>			{
<i class="line-number"></i>				quote = quotes[idx];
<i class="line-number"></i>
<i class="line-number"></i>				if(code.substring(i).indexOf(quote) === 0)
<i class="line-number"></i>				{
<i class="line-number"></i>					if(word)
<i class="line-number"></i>					{
<i class="line-number"></i>						result_tokens.push(word);
<i class="line-number"></i>						result_lines.push(line);
<i class="line-number"></i>						word = '';
<i class="line-number"></i>					}
<i class="line-number"></i>
<i class="line-number"></i>					var j = i + this._shift(code.substring(i), quote, escape, line);
<i class="line-number"></i>
<i class="line-number"></i>					result_tokens.push(code.substring(i, j));
<i class="line-number"></i>					result_lines.push(line);
<i class="line-number"></i>
<i class="line-number"></i>					i = j;
<i class="line-number"></i>
<i class="line-number"></i>					found = true;
<i class="line-number"></i>					break;
<i class="line-number"></i>				}
<i class="line-number"></i>			}
<i class="line-number"></i>
<i class="line-number"></i>			if(found)
<i class="line-number"></i>			{
<i class="line-number"></i>				continue;
<i class="line-number"></i>			}
<i class="line-number"></i>
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>			/* EAT REMAINING CHARACTERES                       */
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>			word += code[i++];
<i class="line-number"></i>
<i class="line-number"></i>			/*-------------------------------------------------*/
<i class="line-number"></i>		}
<i class="line-number"></i>
<i class="line-number"></i>		if(word)
<i class="line-number"></i>		{
<i class="line-number"></i>			result_tokens.push(word);
<i class="line-number"></i>			result_lines.push(line);
<i class="line-number"></i>		}
<i class="line-number"></i>
<i class="line-number"></i>		return result_tokens;
<i class="line-number"></i>	},
<i class="line-number"></i>
<i class="line-number"></i>	/*-----------------------------------------------------------------*/
<i class="line-number"></i>
<i class="line-number"></i>	_shift: function(code, quote, escape, line)
<i class="line-number"></i>	{
<i class="line-number"></i>		var l = code.length;
<i class="line-number"></i>		var m = quote.length;
<i class="line-number"></i>		var n = escape.length;
<i class="line-number"></i>
<i class="line-number"></i>		var i = m;
<i class="line-number"></i>		var cnt = 0;
<i class="line-number"></i>
<i class="line-number"></i>		while(i &lt; l)
<i class="line-number"></i>		{
<i class="line-number"></i>			/**/ if(code.substring(i).indexOf(quote) === 0)
<i class="line-number"></i>			{
<i class="line-number"></i>				i += m;
<i class="line-number"></i>				if((cnt &amp; 1) == 0) return i;
<i class="line-number"></i>				cnt = 0;
<i class="line-number"></i>			}
<i class="line-number"></i>			else if(code.substring(i).indexOf(escape) === 0)
<i class="line-number"></i>			{
<i class="line-number"></i>				i += n;
<i class="line-number"></i>//				if(0x0000001 == 0) return i;
<i class="line-number"></i>				cnt += 1;
<i class="line-number"></i>			}
<i class="line-number"></i>			else
<i class="line-number"></i>			{
<i class="line-number"></i>				i += 1;
<i class="line-number"></i>//				if(0x0000001 == 0) return i;
<i class="line-number"></i>				cnt = 0;
<i class="line-number"></i>			}
<i class="line-number"></i>		}
<i class="line-number"></i>
<i class="line-number"></i>		throw 'syntax error, line `' + line + '`, missing token `' + quote + '`';
<i class="line-number"></i>	},
<i class="line-number"></i>
<i class="line-number"></i>	/*-----------------------------------------------------------------*/
<i class="line-number"></i>});
<i class="line-number"></i>
<i class="line-number"></i>/*-------------------------------------------------------------------------*/
<i class="line-number"></i></code></pre>
  </article>
</section>




  </div>

</div>