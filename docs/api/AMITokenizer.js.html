<link rel="stylesheet" type="text/css" href="docs/api/css/AMI-template.css"></link>

<div class="row">

  <nav class="col-md-3">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">AMI Web framework API</h3>
      </div>
      <div class="panel-body jsdoc-menu">
        <h4><a href="?subapp=amiDocument&userdata=api/index.html">Home</a></h2><h4>Events</h3><ul><li><a href="?subapp=amiDocument&userdata=api/amiWebApp.html#event:onStart">onStart</a></li><li><a href="?subapp=amiDocument&userdata=api/amiWebApp.html#event:onToolbarUpdateNeeded">onToolbarUpdateNeeded</a></li></ul><h4>Namespaces</h3><ul><li><a href="?subapp=amiDocument&userdata=api/amiCommand.html">amiCommand</a></li><li><a href="?subapp=amiDocument&userdata=api/amiLogin.html">amiLogin</a></li><li><a href="?subapp=amiDocument&userdata=api/amiTokenizer.html">amiTokenizer</a></li><li><a href="?subapp=amiDocument&userdata=api/amiWebApp.html">amiWebApp</a></li></ul><h4>Global</h3><ul><li><a href="?subapp=amiDocument&userdata=api/global.html#amiRegisterSubApp">amiRegisterSubApp</a></li></ul>
      </div>
    </div>
  </nav>

  <div class="col-md-9 jsdoc-content">
    <h1>Source: AMITokenizer.js</h1>
    



    
    <section>
        <article>
            <pre class="ami-code">/*!
 * amiTokenizer
 *
 * Copyright (c) 2014-2015 The AMI Team
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 *
 */

/*-------------------------------------------------------------------------*/
/* amiTokenizer                                                            */
/*-------------------------------------------------------------------------*/

/**
 * The AMI tokenizer
 * @namespace amiTokenizer
 */

var amiTokenizer = {
	/*-----------------------------------------------------------------*/

	/**
	  * Tokenize a string
	  * @param {string} s the string
	  * @param {int} line the line
	  * @param {array} spaces the list of characters for spaces
	  * @param {array} kwords the list of kerwords
	  * @param {array} quotes the list of characters for string declaration
	  * @param {string} [escape='\\'] the escape character
	  * @returns The list of tokens
	  */

	tokenize: function(s, line, spaces, kwords, quotes, escape)
	{
		if(!spaces) spaces = [];
		if(!kwords) kwords = [];
		if(!quotes) quotes = [];
		if(!escape) escape = '\\';

		var result_tokens = [];
		var result_lines = [];

		var i = 0x000000;
		var l = s.length;

		var word = '';
		var found;

		while(i &lt; l)
		{
			/*-------------------------------------------------*/
			/* COUNT LINES                                     */
			/*-------------------------------------------------*/

			if(s[i] === '\n')
			{
				line++;
			}

			/*-------------------------------------------------*/
			/* EAT SPACES                                      */
			/*-------------------------------------------------*/

			if(spaces.indexOf(s[i]) >= 0)
			{
				if(word)
				{
					result_tokens.push(word);
					result_lines.push(line);
					word = '';
				}

				i++;

				continue;
			}

			/*-------------------------------------------------*/
			/* EAT KWORDS                                      */
			/*-------------------------------------------------*/

			found = false;

			for(var idx in kwords)
			{
				kword = kwords[idx];

				if(s.substring(i).indexOf(kword) === 0)
				{
					if(word)
					{
						result_tokens.push(word);
						result_lines.push(line);
						word = '';
					}

					var j = i + kword.length;

					result_tokens.push(s.substring(i, j));
					result_lines.push(line);

					i = j;

					found = true;
					break;
				}
			}

			if(found)
			{
				continue;
			}

			/*-------------------------------------------------*/
			/* EAT STRINGS                                     */
			/*-------------------------------------------------*/

			found = false;

			for(var idx in quotes)
			{
				quote = quotes[idx];

				if(s.substring(i).indexOf(quote) === 0)
				{
					if(word)
					{
						result_tokens.push(word);
						result_lines.push(line);
						word = '';
					}

					var j = i + this._shift(s.substring(i), quote, escape, line);

					result_tokens.push(s.substring(i, j));
					result_lines.push(line);

					i = j;

					found = true;
					break;
				}
			}

			if(found)
			{
				continue;
			}

			/*-------------------------------------------------*/
			/* EAT REMAINING CHARACTERES                       */
			/*-------------------------------------------------*/

			word += s[i++];

			/*-------------------------------------------------*/
		}

		if(word)
		{
			result_tokens.push(word);
			result_lines.push(line);
		}

		return result_tokens;
	},

	/*-----------------------------------------------------------------*/

	_shift: function(s, quote, escape, line)
	{
		var l = s.length;
		var m = quote.length;
		var n = escape.length;

		var i = m;
		var cnt = 0;

		while(i &lt; l)
		{
			/**/ if(s.substring(i).indexOf(quote) === 0)
			{
				i += m;
				if((cnt &amp; 1) == 0) return i;
				cnt = 0;
			}
			else if(s.substring(i).indexOf(escape) === 0)
			{
				i += n;
//				if(0x0000001 == 0) return i;
				cnt += 1;
			}
			else
			{
				i += 1;
//				if(0x0000001 == 0) return i;
				cnt = 0;
			}
		}

		throw 'syntax error, line `' + line + '`, missing token `' + quote + '`';
	},

	/*-----------------------------------------------------------------*/
};

/*-------------------------------------------------------------------------*/
</pre>
        </article>
    </section>




  </div>

</div>