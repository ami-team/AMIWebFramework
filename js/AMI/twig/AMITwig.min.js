/*!
 * AMI Web Framework
 *
 * Copyright (c) 2014-2015 The AMI Team
 * http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html
 *
 */
;var amiTwig={STATEMENT_RE:/\{\%\s*([a-zA-Z_][a-zA-Z0-9_]*)(.*?)\%\}/m,VARIABLE_RE:/\%\%\s*([a-zA-Z_][a-zA-Z0-9_]*)(?:\.([a-zA-Z_][a-zA-Z0-9_]*))?\s*\%\%/g,STACK_IF_NO:0,STACK_IF_LOCK:1,STACK_IF_UNLOCK:2,STACK_FOR:3,STACK_FILTER:4,STACK_0:5,haveToBeShown:function(a,c){if(a[c]===this.STACK_IF_NO||a[c]===this.STACK_IF_LOCK){return false}for(var b=0;b<c;b++){if(a[b]===this.STACK_IF_NO){return false}}return true},error:function(a,b){throw"syntax error, line `"+a+"`, "+b},render:function(u,d){d=d||{};var r="";var f=[this.STACK_0];var C=[[null]];var e=[null];var t=1;for(;;u=u.substr(b)){var y=u.match(this.STATEMENT_RE);var B=f.length-1;if(y===null){for(var A=0;A<u.length;A++){if(u.charAt(A)==="\n"){t++}}if(this.haveToBeShown(f,B)){r+=u.replace(this.VARIABLE_RE,function(j,i,m){if(!m){return d[i]}else{return d[i][m]}})}var h=[];for(var A=1;A<f.length;A++){var q=f[A];if(q===this.STACK_IF_NO||q===this.STACK_IF_LOCK||q===this.STACK_IF_UNLOCK){h.push("missing `endif`")}else{if(q===this.STACK_FOR){h.push("missing `endfor`")}else{if(q===this.STACK_FILTER){h.push("missing `endfilter`")}}}}if(h.length>0){this.error(t,h.join(", "))}return r}var D=y[1];var c=y[2];var w=y.index;var b=y.index;b+=y[0].length;for(var A=0;A<b;A++){if(u.charAt(A)==="\n"){t++}}var v=amiTokenizer.tokenize(y[2],[" ","\t","\n"],["b-or","b-xor","b-and","===","==","!==","!=","=","<=",">=","<",">","+","-","**","*","//","/","..",".","|","(",")"],["'",'"'],"\\",t);if(this.haveToBeShown(f,B)){var k=e[e.length-1];var g=C[C.length-1];for(var A=0;A<g.length;A++){r+=u.substr(0,w).replace(this.VARIABLE_RE,function(j,i,m){if(!m){return(i===k)?g[A]:d[i]}else{return(i===k)?g[A][m]:d[i][m]}})}}if(D==="if"){amiTwigExprCompiler.parse(v,t);if(false){f.push(this.STACK_IF_NO);C.push([null]);e.push(null)}else{f.push(this.STACK_IF_UNLOCK);C.push([null]);e.push(null)}}else{if(D==="elseif"){if(f[B]===this.STACK_IF_NO){if(false){f[B]=this.STACK_IF_NO}else{f[B]=this.STACK_IF_UNLOCK}}else{if(f[B]===this.STACK_IF_UNLOCK){f[B]=this.STACK_IF_LOCK}}}else{if(D==="else"){if(f[B]===this.STACK_IF_NO){f[B]=this.STACK_IF_UNLOCK}else{if(f[B]===this.STACK_IF_UNLOCK){f[B]=this.STACK_IF_LOCK}}}else{if(D==="endif"){var p=f[B];if(p!==this.STACK_IF_NO&&p!==this.STACK_IF_LOCK&&p!==this.STACK_IF_UNLOCK){this.error(t,"missing `if`")}f.pop();C.pop();e.pop()}else{if(D==="for"){var n=[];var a=v[0];if(v.length===3&&v[1]==="in"&&_ami_internal_ami_internal_isSId(v[0])&&_ami_internal_isSId(v[2])){if(v[2] in d){n=d[v[2]]}}else{if(v.length===5&&v[1]==="in"&&_ami_internal_isSId(v[0])&&v[3]===".."){var o=parseInt(v[2]);var l=parseInt(v[4]);if(!isNaN(o)&&!isNaN(l)){for(var z=o;z<=l;z++){n.push(z)}}else{if(v[2].length===3&&v[2][0]==="'"&&v[2][2]==="'"&&v[4].length===3&&v[4][0]==="'"&&v[4][2]==="'"){for(var z=v[2].charCodeAt(1);z<=v[4].charCodeAt(1);z++){n.push(String.fromCharCode(z))}}else{this.error(t,"syntax error in `range`")}}}else{this.error(t,"syntax error in `for`")}}f.push(this.STACK_FOR);C.push(n);e.push(a)}else{if(D==="endfor"){var p=f[B];if(p!==this.STACK_FOR){this.error(t,"missing `for`")}f.pop();C.pop();e.pop()}else{if(D==="filter"){f.push(this.STACK_FILTER);C.push([null]);e.push(null)}else{if(D==="endfilter"){var p=f[B];if(p!==this.STACK_FILTER){this.error(t,"missing `filter`")}f.pop();C.pop();e.pop()}else{this.error(t,"unknown keyword `"+D+"`")}}}}}}}}}}};